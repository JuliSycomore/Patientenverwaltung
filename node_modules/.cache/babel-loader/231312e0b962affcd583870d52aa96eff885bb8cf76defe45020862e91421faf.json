{"ast":null,"code":"var _jsxFileName = \"/Users/julianrogowski/Desktop/patientenverwaltung-app/src/components/ICD11ECTBrowser.js\",\n  _s = $RefreshSig$();\n// src/components/ICD11ECTBrowser.js\nimport React, { useEffect, useRef, useState } from 'react';\n\n// Importieren Sie die ECT-Bibliothek und das CSS gemäß der Dokumentation\nimport * as ECT from '@whoicd/icd11ect';\nimport '@whoicd/icd11ect/style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ICD11ECTBrowser = () => {\n  _s();\n  // Ein ref, um sicherzustellen, dass die Initialisierung nur einmal ausgeführt wird.\n  const isInitialized = useRef(false);\n\n  // NEU: State, um den aktiven Kapitel-Filter zu speichern\n  const [activeFilter, setActiveFilter] = useState(null);\n  useEffect(() => {\n    // Verhindert eine erneute Ausführung im React Strict Mode (Entwicklungsmodus)\n    if (isInitialized.current) {\n      return;\n    }\n    isInitialized.current = true;\n\n    // Definition der Grundeinstellungen für den Embedded Browser\n    const mySettings = {\n      apiServerUrl: \"https://id.who.int\",\n      // Die offizielle, produktive API-URL\n      apiSecured: true,\n      // Wichtig: Aktiviert die OAUTH-Authentifizierung\n\n      // UI und Sprach-Einstellungen\n      language: \"de\",\n      // Sprache auf Deutsch setzen\n      browserHierarchyAvailable: true,\n      // Zeigt den Baum-Browser links an\n      browserAdvancedSearchAvailable: true,\n      // Aktiviert die erweiterte Suche\n      includeDiagnosticCriteria: true,\n      // Zeigt diagnostische Kriterien an, falls verfügbar\n      hierarchyResizable: true,\n      // Erlaubt das Ändern der Baum-Breite\n      height: \"75vh\" // Höhe leicht angepasst für die Filter-Buttons\n    };\n\n    // Definition der Callbacks\n    const myCallbacks = {\n      // Diese Funktion wird vom ECT aufgerufen, wenn es ein neues Token benötigt\n      getNewTokenFunction: async () => {\n        try {\n          const response = await fetch('http://localhost:3001/api/icd11-token');\n          if (!response.ok) {\n            console.error('Fehler beim Abrufen des Tokens vom Backend.');\n            throw new Error('Could not fetch token');\n          }\n          const result = await response.json();\n          return result.token;\n        } catch (e) {\n          console.error(\"Fehler bei der Token-Anfrage:\", e);\n          return null;\n        }\n      }\n    };\n    ECT.Handler.configure(mySettings, myCallbacks);\n  }, []);\n\n  // NEU: Ein zweiter useEffect, der auf Änderungen des Filters reagiert\n  useEffect(() => {\n    // Stellen Sie sicher, dass die Bibliothek konfiguriert ist, bevor Sie versuchen, sie zu überschreiben\n    if (isInitialized.current) {\n      ECT.Handler.overwriteConfiguration(\"1\", {\n        // \"1\" ist die ID unseres Browsers\n        chaptersFilter: activeFilter || \"\" // \"\" oder null setzt den Filter zurück\n      });\n    }\n  }, [activeFilter]); // Dieser Effekt wird jedes Mal ausgeführt, wenn sich der activeFilter ändert\n\n  // Filter-Buttons für eine einfache Navigation\n  const filterButtons = [{\n    label: \"Alle Kapitel\",\n    filter: null\n  }, {\n    label: \"Psychische Störungen (06)\",\n    filter: \"06\"\n  }, {\n    label: \"Neurolog. Störungen (08)\",\n    filter: \"08\"\n  }, {\n    label: \"Schlaf-Wach-Störungen (07)\",\n    filter: \"07\"\n  }];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-4 bg-white rounded-lg shadow-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-semibold text-gray-800 mb-4\",\n      children: \"ICD-11 Nachschlagewerk\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap gap-2 mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-sm font-semibold self-center text-gray-600\",\n        children: \"Schnellfilter:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this), filterButtons.map(({\n        label,\n        filter\n      }) => /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setActiveFilter(filter),\n        className: `px-3 py-1 text-sm rounded-full transition-colors ${activeFilter === filter ? 'bg-indigo-600 text-white shadow' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`,\n        children: label\n      }, label, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 22\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ctw-eb-window\",\n      \"data-ctw-ino\": \"1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 9\n  }, this);\n};\n_s(ICD11ECTBrowser, \"TkKd1/78zjT211SLFE+aHpQ4RnE=\");\n_c = ICD11ECTBrowser;\nexport default ICD11ECTBrowser;\nvar _c;\n$RefreshReg$(_c, \"ICD11ECTBrowser\");","map":{"version":3,"names":["React","useEffect","useRef","useState","ECT","jsxDEV","_jsxDEV","ICD11ECTBrowser","_s","isInitialized","activeFilter","setActiveFilter","current","mySettings","apiServerUrl","apiSecured","language","browserHierarchyAvailable","browserAdvancedSearchAvailable","includeDiagnosticCriteria","hierarchyResizable","height","myCallbacks","getNewTokenFunction","response","fetch","ok","console","error","Error","result","json","token","e","Handler","configure","overwriteConfiguration","chaptersFilter","filterButtons","label","filter","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","onClick","_c","$RefreshReg$"],"sources":["/Users/julianrogowski/Desktop/patientenverwaltung-app/src/components/ICD11ECTBrowser.js"],"sourcesContent":["// src/components/ICD11ECTBrowser.js\nimport React, { useEffect, useRef, useState } from 'react';\n\n// Importieren Sie die ECT-Bibliothek und das CSS gemäß der Dokumentation\nimport * as ECT from '@whoicd/icd11ect';\nimport '@whoicd/icd11ect/style.css';\n\nconst ICD11ECTBrowser = () => {\n    // Ein ref, um sicherzustellen, dass die Initialisierung nur einmal ausgeführt wird.\n    const isInitialized = useRef(false);\n    \n    // NEU: State, um den aktiven Kapitel-Filter zu speichern\n    const [activeFilter, setActiveFilter] = useState(null);\n\n    useEffect(() => {\n        // Verhindert eine erneute Ausführung im React Strict Mode (Entwicklungsmodus)\n        if (isInitialized.current) {\n            return;\n        }\n        isInitialized.current = true;\n\n        // Definition der Grundeinstellungen für den Embedded Browser\n        const mySettings = {\n            apiServerUrl: \"https://id.who.int\",  // Die offizielle, produktive API-URL\n            apiSecured: true,                   // Wichtig: Aktiviert die OAUTH-Authentifizierung\n            \n            // UI und Sprach-Einstellungen\n            language: \"de\",                     // Sprache auf Deutsch setzen\n            browserHierarchyAvailable: true,    // Zeigt den Baum-Browser links an\n            browserAdvancedSearchAvailable: true, // Aktiviert die erweiterte Suche\n            includeDiagnosticCriteria: true,    // Zeigt diagnostische Kriterien an, falls verfügbar\n            hierarchyResizable: true,           // Erlaubt das Ändern der Baum-Breite\n            height: \"75vh\"                      // Höhe leicht angepasst für die Filter-Buttons\n        };\n\n        // Definition der Callbacks\n        const myCallbacks = {\n            // Diese Funktion wird vom ECT aufgerufen, wenn es ein neues Token benötigt\n            getNewTokenFunction: async () => {\n                try {\n                    const response = await fetch('http://localhost:3001/api/icd11-token');\n                    if (!response.ok) {\n                        console.error('Fehler beim Abrufen des Tokens vom Backend.');\n                        throw new Error('Could not fetch token');\n                    }\n                    const result = await response.json();\n                    return result.token; \n                } catch (e) {\n                    console.error(\"Fehler bei der Token-Anfrage:\", e);\n                    return null;\n                }\n            }\n        };\n        \n        ECT.Handler.configure(mySettings, myCallbacks);\n        \n    }, []); \n\n    // NEU: Ein zweiter useEffect, der auf Änderungen des Filters reagiert\n    useEffect(() => {\n        // Stellen Sie sicher, dass die Bibliothek konfiguriert ist, bevor Sie versuchen, sie zu überschreiben\n        if (isInitialized.current) {\n            ECT.Handler.overwriteConfiguration(\"1\", { // \"1\" ist die ID unseres Browsers\n                chaptersFilter: activeFilter || \"\" // \"\" oder null setzt den Filter zurück\n            });\n        }\n    }, [activeFilter]); // Dieser Effekt wird jedes Mal ausgeführt, wenn sich der activeFilter ändert\n\n    // Filter-Buttons für eine einfache Navigation\n    const filterButtons = [\n        { label: \"Alle Kapitel\", filter: null },\n        { label: \"Psychische Störungen (06)\", filter: \"06\" },\n        { label: \"Neurolog. Störungen (08)\", filter: \"08\" },\n        { label: \"Schlaf-Wach-Störungen (07)\", filter: \"07\"},\n    ];\n\n    return (\n        <div className=\"p-4 bg-white rounded-lg shadow-lg\">\n             <h2 className=\"text-2xl font-semibold text-gray-800 mb-4\">ICD-11 Nachschlagewerk</h2>\n            {/* NEU: Filter-Buttons */}\n            <div className=\"flex flex-wrap gap-2 mb-4\">\n                <span className=\"text-sm font-semibold self-center text-gray-600\">Schnellfilter:</span>\n                {filterButtons.map(({label, filter}) => (\n                     <button \n                        key={label}\n                        onClick={() => setActiveFilter(filter)}\n                        className={`px-3 py-1 text-sm rounded-full transition-colors ${\n                            activeFilter === filter \n                            ? 'bg-indigo-600 text-white shadow' \n                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'\n                        }`}\n                     >\n                        {label}\n                     </button>\n                ))}\n            </div>\n\n            {/* Dieser div-Container ist der Ankerpunkt für die Bibliothek */}\n            <div className=\"ctw-eb-window\" data-ctw-ino=\"1\"></div>\n        </div>\n    );\n};\n\nexport default ICD11ECTBrowser;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}