{"ast":null,"code":"import _objectSpread from\"/Users/julianrogowski/Documents/Visual Code/patientenverwaltung-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useRef,useMemo}from'react';import{initializeApp}from'firebase/app';import{getAuth,onAuthStateChanged,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut}from'firebase/auth';import{getFirestore,collection,doc,addDoc,getDocs,setDoc,deleteDoc,onSnapshot,query,writeBatch,updateDoc}from'firebase/firestore';import{getStorage,ref,uploadBytes,getDownloadURL}from\"firebase/storage\";import{motion,AnimatePresence}from'framer-motion';import{DotLottieReact}from'@lottiefiles/dotlottie-react';// Components\nimport SCL90RComponent from'./psychodiagnostic/SCL90R.js';import FEP2Component from'./psychodiagnostic/FEP2.js';import BDI2Component from'./psychodiagnostic/BDI2.js';import HSCL11Component from'./psychodiagnostic/HSCL11.js';import GAD7Component from'./psychodiagnostic/GAD7.js';import CoreOmComponent from'./psychodiagnostic/CoreOm.js';import IIPCComponent from'./psychodiagnostic/IIP-C.js';import ICD11ECTBrowser from'./components/ICD11ECTBrowser.js';import EBMBrowser from'./components/EBMBrowser.js';import BillingModal from'./components/SitzungsAbrechnung.js';import AbrechnungsUebersicht from'./components/PatientenTabs/Abrechnung.js';import DiagnostikZuordnung from'./components/DiagnostikZuordnung.js';import ManualBillingSetupModal from'./components/ManualBillingSetupModal.js';import AddBillingPeriodModal from'./components/AddBillingPeriodModal.js';import Profile from'./components/Profile.js';import Billing from'./components/Billing.js';import PtvFormGenerator from'./formulare/PtvFormGenerator.js';import Behandlungsmethoden from'./components/Behandlungsmethoden.js';import EbmTemplates from'./components/EbmTemplates.js';import DiagnostikHauptseite from'./components/DiagnostikHauptseite.js';import ZentraleTestErfassungModal from'./components/ZentraleTestErfassungModal.js';import AddTestTemplateModal from'./components/AddTestTemplateModal.js';import AddOrEditTemplateModal from'./components/AddOrEditTemplateModal.js';// --- ICONS ---\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserPlus=_ref=>{let{className=\"w-5 h-5\"}=_ref;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"9\",cy:\"7\",r:\"4\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"19\",x2:\"19\",y1:\"8\",y2:\"14\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"22\",x2:\"16\",y1:\"11\",y2:\"11\"})]});};const Edit3=_ref2=>{let{className=\"w-5 h-5\"}=_ref2;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12 20h9\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z\"})]});};const Trash2=_ref3=>{let{className=\"w-5 h-5\"}=_ref3;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]});};const PlusCircleIcon=_ref4=>{let{className=\"w-5 h-5\"}=_ref4;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"8\",x2:\"12\",y2:\"16\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"12\",x2:\"16\",y2:\"12\"})]});};const XCircle=_ref5=>{let{className=\"w-6 h-6\"}=_ref5;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"15\",y1:\"9\",x2:\"9\",y2:\"15\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"9\",y1:\"9\",x2:\"15\",y2:\"15\"})]});};const Save=_ref6=>{let{className=\"w-5 h-5\"}=_ref6;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"17 21 17 13 7 13 7 21\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"7 3 7 8 15 8\"})]});};const AlertTriangle=_ref7=>{let{className=\"w-12 h-12\"}=_ref7;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"9\",x2:\"12\",y2:\"13\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"17\",x2:\"12.01\",y2:\"17\"})]});};const FileJson2=_ref8=>{let{className=\"w-5 h-5\"}=_ref8;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M14 2v6h6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M4 12h1.6a2 2 0 0 0 1.9-3.4L6 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M4 18h1.6a2 2 0 0 1 1.9 3.4L6 24\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 12h1.6a2 2 0 0 1 1.9-3.4L14 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 18h1.6a2 2 0 0 0 1.9 3.4L14 24\"})]});};const WandSparkles=_ref9=>{let{className=\"w-5 h-5\"}=_ref9;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"m9.5 2.55 1.294 1.294a1 1 0 0 0 1.414 0L13.5 2.55\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M4.94 4.94 6.22 6.22a1 1 0 0 0 1.41 0l1.29-1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M2.55 9.51 3.84 10.8a1 1 0 0 0 1.41 0l1.3-1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"m19.07 4.93-1.29 1.29a1 1 0 0 1-1.41 0l-1.29-1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M21.45 9.51l-1.29 1.29a1 1 0 0 1-1.41 0l-1.3-1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M14.5 12.94a1 1 0 0 0 0 1.41l1.29 1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M10.8 17.78a1 1 0 0 0 0 1.41l1.29 1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M17.78 10.8a1 1 0 0 0 0 1.41l1.29 1.29\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 10.5V4.5\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 10.5C7 11 4 15 4 20\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 10.5c5 .5 8 4.5 8 9.5\"})]});};const LogOut=_ref0=>{let{className=\"w-5 h-5\"}=_ref0;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"16 17 21 12 16 7\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"21\",y1:\"12\",x2:\"9\",y2:\"12\"})]});};const BookOpen=_ref1=>{let{className=\"w-5 h-5\"}=_ref1;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z\"})]});};const Users=_ref10=>{let{className=\"w-5 h-5\"}=_ref10;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"9\",cy:\"7\",r:\"4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M22 21v-2a4 4 0 0 0-3-3.87\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\"})]});};const FileText=_ref11=>{let{className=\"w-5 h-5\"}=_ref11;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"14 2 14 8 20 8\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"13\",x2:\"8\",y2:\"13\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"17\",x2:\"8\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"9\",x2:\"8\",y2:\"9\"})]});};const List=_ref12=>{let{className=\"w-5 h-5\"}=_ref12;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"line\",{x1:\"8\",x2:\"21\",y1:\"6\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",x2:\"21\",y1:\"12\",y2:\"12\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",x2:\"21\",y1:\"18\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",x2:\"3.01\",y1:\"6\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",x2:\"3.01\",y1:\"12\",y2:\"12\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",x2:\"3.01\",y1:\"18\",y2:\"18\"})]});};const CalendarIcon=_ref13=>{let{className=\"w-5 h-5\"}=_ref13;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"4\",width:\"18\",height:\"18\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"2\",x2:\"16\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"2\",x2:\"8\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"10\",x2:\"21\",y2:\"10\"})]});};const PaperclipIcon=_ref14=>{let{className=\"w-5 h-5\"}=_ref14;return/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:/*#__PURE__*/_jsx(\"path\",{d:\"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.59a2 2 0 0 1-2.83-2.83l8.49-8.48\"})});};const SettingsIcon=_ref15=>{let{className=\"w-5 h-5\"}=_ref15;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"3\"})]});};const DollarSignIcon=_ref16=>{let{className=\"w-5 h-5\"}=_ref16;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"1\",x2:\"12\",y2:\"23\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"})]});};const LayoutGridIcon=_ref17=>{let{className=\"w-5 h-5\"}=_ref17;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"3\",width:\"7\",height:\"7\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"14\",y:\"3\",width:\"7\",height:\"7\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"14\",y:\"14\",width:\"7\",height:\"7\"}),/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"14\",width:\"7\",height:\"7\"})]});};const LayersIcon=_ref18=>{let{className=\"w-5 h-5\"}=_ref18;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"polygon\",{points:\"12 2 2 7 12 12 22 7 12 2\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"2 17 12 22 22 17\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"2 12 12 17 22 12\"})]});};const ClipboardListIcon=_ref19=>{let{className=\"w-5 h-5\"}=_ref19;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"rect\",{x:\"8\",y:\"2\",width:\"8\",height:\"4\",rx:\"1\",ry:\"1\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 11h4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 16h4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M8 11h.01\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M8 16h.01\"})]});};const BeakerIcon=_ref20=>{let{className=\"w-5 h-5\"}=_ref20;return/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",className:className,children:[/*#__PURE__*/_jsx(\"path\",{d:\"M4.5 3h15\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M6 14h12\"})]});};// Firebase Config\nconst firebaseConfig={apiKey:\"AIzaSyDZ_qqqKW7WDCZ9botek2VBwXNMQO3JYwU\",authDomain:\"psychotherapie0512.firebaseapp.com\",projectId:\"psychotherapie0512\",storageBucket:\"psychotherapie0512.appspot.com\",messagingSenderId:\"131279046361\",appId:\"1:131279046361:web:e5dd2d18b206fb820b60c8\"};// Initialize Firebase\nconst app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);const storage=getStorage(app);const firestoreAppId='default-patient-app-v5';// --- KONSTANTEN ---\nconst homeworkFailureReasons={\"Motivational\":[\"Geringe Motivation\",\"Zweifel am Nutzen der Hausaufgabe\",\"Keine Einsicht in die Relevanz\"],\"Emotional\":[\"Angst vor Versagen\",\"Scham oder Schuldgefühle\",\"Vermeidung unangenehmer Gefühle\"],\"Kognitive\":[\"Negative automatische Gedanken\",\"Perfektionismus\"],\"Organisatorisch/Praktisch\":[\"Zeitmangel\",\"Vergessen\",\"Keine klaren Anweisungen oder Verständnisprobleme\"],\"Interaktion mit Therapeut\":[\"Widerstand gegen den Therapeuten\",\"Beziehungskonflikte\",\"Mangel an Vertrauen\"],\"Psychopathologisch\":[\"Konzentrationsprobleme\",\"Antriebslosigkeit\",\"Überwältigende Symptome\"]};const availableTests=[{id:'scl90r',name:'SCL-90-R - Symptom-Checklist-90-R',ebm:'35601',recommendation:10},{id:'fep2',name:'FEP-2 - Fragebogen zur Erfassung von Persönlichkeitsstörungen',ebm:'35601',recommendation:12},{id:'bdi2',name:'BDI-II - Beck-Depressions-Inventar II',ebm:'35600',recommendation:2},{id:'hscl11',name:'HSCL-11 - Hopkins Symptom Checklist-11',ebm:'35600',recommendation:1},{id:'gad7',name:'GAD-7 - Generalisierte Angststörung Skala',ebm:'35600',recommendation:1},{id:'coreOm',name:'CORE-OM - Clinical Outcomes in Routine Evaluation',ebm:'35601',recommendation:8},{id:'iipc',name:'IIP-C - Inventar Interpersonaler Probleme',ebm:'35601',recommendation:15}];const testCategories=[{name:'Allgemeine Psychopathologie',tests:['scl90r','hscl11','coreOm']},{name:'Depressionsdiagnostik',tests:['bdi2']},{name:'Angstdiagnostik',tests:['gad7']},{name:'Persönlichkeitsdiagnostik',tests:['fep2']},{name:'Interpersonelle Probleme',tests:['iipc']}];const availableTherapeuticMethods=[\"Kognitive Verhaltenstherapie (KVT)\",\"Schematherapie\",\"Acceptance and Commitment Therapy (ACT)\",\"Dialektisch-Behaviorale Therapie (DBT)\",\"Eye Movement Desensitization and Reprocessing (EMDR)\",\"Tiefenpsychologisch fundierte Psychotherapie\",\"Systemische Therapie\"];const initialPatientsData=[{name:\"Mustermann\",geburtsdatum:\"1998-04-04\",chiffre:\"M040498\",therapeuticMethods:[\"Kognitive Verhaltenstherapie (KVT)\"],approvedHours:60,krankenkasse:\"TK\",versichertennummer:\"A123456789\",diagnoses:[\"[G] F00.0*: Demenz bei Alzheimer-Krankheit, mit frühem Beginn (Typ 2)\",\"[V] F01.1: Multiinfarkt-Demenz\",\"[A] F20.0: Paranoide Schizophrenie\",\"[ZN] F32.1: Mittelgradige depressive Episode\",\"F40.0: Agoraphobie\"],sessions:[{id:\"sess_\".concat(Date.now()),date:\"2025-05-20\",structuredNotes:{sitzungsnummer:1,thema:\"Erste Sitzung\",patientenbericht:\"Exploration der Hauptbeschwerden.\"}}],hscl11Results:[],bdi2Results:[],fep2Results:[],scl90rResults:[],gad7Results:[],coreOmResults:[],iipcResults:[],billingPeriods:[],krankheitsanamnese:\"Patient berichtet über seit ca. 2 Jahren zunehmende Vergesslichkeit und Orientierungsprobleme.\",lebensgeschichte:\"Geboren 1955, verheiratet, 2 Kinder, früher als Buchhalter tätig.\",problemanalyseMakro:\"Kognitive Defizite im Vordergrund, affektive Belastung durch erlebten Kontrollverlust.\",therapieplan:\"Supportive Gespräche, kognitives Training, Psychoedukation für Angehörige.\"}];const DIAGNOSTIK_PUNKTE={'35600':34,'35601':39,'35602':56};// --- HILFSFUNKTIONEN & HOOKS ---\nconst getQuarter=date=>{if(!date)return null;const d=new Date(date);const month=d.getMonth();const year=d.getFullYear();const quarter=Math.floor(month/3)+1;return\"\".concat(year,\"-Q\").concat(quarter);};const useQuarterlyDiagnostikAnalysis=(patient,availableTests)=>{return useMemo(()=>{if(!patient)return{};const testsByQuarter={};availableTests.forEach(testDef=>{const results=patient[\"\".concat(testDef.id,\"Results\")]||[];results.forEach(result=>{if(result.status==='completed'){const quarterKey=getQuarter(result.date);if(!quarterKey)return;if(!testsByQuarter[quarterKey]){testsByQuarter[quarterKey]=[];}testsByQuarter[quarterKey].push(_objectSpread(_objectSpread({},testDef),result));}});});const analysis={};const age=calculateAge(patient.geburtsdatum);const pointsLimit=age<22?1636:1092;for(const quarterKey in testsByQuarter){const testsInQuarter=testsByQuarter[quarterKey];const pointsUsed=testsInQuarter.reduce((sum,test)=>sum+(DIAGNOSTIK_PUNKTE[test.ebm]||0),0);analysis[quarterKey]={pointsUsed,pointsLimit,tests:testsInQuarter};}return analysis;},[patient,availableTests]);};const Modal=_ref21=>{let{isOpen,onClose,title,children,size=\"lg\"}=_ref21;if(!isOpen)return null;const sizeClasses={sm:'max-w-sm',md:'max-w-md',lg:'max-w-lg',xl:'max-w-xl','2xl':'max-w-2xl','3xl':'max-w-3xl','4xl':'max-w-4xl','5xl':'max-w-5xl'};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-full \".concat(sizeClasses[size],\" max-h-[90vh] overflow-y-auto\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-800\",children:title}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(XCircle,{className:\"w-7 h-7\"})})]}),children]})});};const ConfirmationModal=_ref22=>{let{isOpen,onClose,onConfirm,title,message}=_ref22;if(!isOpen)return null;return/*#__PURE__*/_jsx(Modal,{isOpen:isOpen,onClose:onClose,title:title,size:\"md\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"mx-auto mb-4 w-12 h-12 text-red-500\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-6\",children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none\",children:\"Abbrechen\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onConfirm,className:\"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none\",children:\"Best\\xE4tigen\"})]})]})});};const PatientForm=_ref23=>{let{patient,onSave,onCancel}=_ref23;const[formData,setFormData]=useState(patient||{name:'',vorname:'',chiffre:'',geburtsdatum:'',adresse:'',email:'',telefon:'',krankenkasse:'',versichertennummer:'',therapeuticMethods:[],approvedHours:0,diagnoses:[],sessions:[],hscl11Results:[],bdi2Results:[],fep2Results:[],scl90rResults:[],gad7Results:[],coreOmResults:[],iipcResults:[],billingPeriods:[],krankheitsanamnese:\"\",lebensgeschichte:\"\",problemanalyseMakro:\"\",therapieplan:\"\"});const[newMethod,setNewMethod]=useState(\"\");useEffect(()=>{if(patient){setFormData(_objectSpread(_objectSpread({},patient),{},{geburtsdatum:patient.geburtsdatum||'',krankenkasse:patient.krankenkasse||'',versichertennummer:patient.versichertennummer||'',therapeuticMethods:patient.therapeuticMethods||[],hscl11Results:patient.hscl11Results||[],bdi2Results:patient.bdi2Results||[],fep2Results:patient.fep2Results||[],scl90rResults:patient.scl90rResults||[],gad7Results:patient.gad7Results||[],coreOmResults:patient.coreOmResults||[],iipcResults:patient.iipcResults||[],billingPeriods:patient.billingPeriods||[],krankheitsanamnese:patient.krankheitsanamnese||\"\",lebensgeschichte:patient.lebensgeschichte||\"\",problemanalyseMakro:patient.problemanalyseMakro||\"\",therapieplan:patient.therapieplan||\"\"}));}else{setFormData({name:'',vorname:'',chiffre:'',geburtsdatum:'',adresse:'',email:'',telefon:'',krankenkasse:'',versichertennummer:'',therapeuticMethods:[],approvedHours:0,diagnoses:[],sessions:[],hscl11Results:[],bdi2Results:[],fep2Results:[],scl90rResults:[],gad7Results:[],coreOmResults:[],iipcResults:[],billingPeriods:[],krankheitsanamnese:\"\",lebensgeschichte:\"\",problemanalyseMakro:\"\",therapieplan:\"\"});}},[patient]);useEffect(()=>{const{name,geburtsdatum}=formData;if(name&&geburtsdatum){try{const firstLetter=name.charAt(0).toUpperCase();const[year,month,day]=geburtsdatum.split('-');if(year&&month&&day){const yy=year.slice(-2);const newChiffre=\"\".concat(firstLetter).concat(day).concat(month).concat(yy);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{chiffre:newChiffre}));}}catch(e){console.error(\"Fehler bei der Chiffre-Generierung\",e);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{chiffre:''}));}}else{if(formData.chiffre!==''){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{chiffre:''}));}}},[formData]);const handleChange=e=>{const{name,value,type}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:type==='number'?parseInt(value,10)||0:value}));};const handleAddMethod=()=>{if(newMethod&&!formData.therapeuticMethods.includes(newMethod)){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{therapeuticMethods:[...prev.therapeuticMethods,newMethod]}));setNewMethod(\"\");}};const handleRemoveMethod=methodToRemove=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{therapeuticMethods:prev.therapeuticMethods.filter(m=>m!==methodToRemove)}));};const handleSubmit=e=>{e.preventDefault();onSave(formData);};const inputStd=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\";const btnPrimary=\"px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 flex items-center\";return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"vorname\",className:\"block text-sm font-medium text-gray-700\",children:\"Vorname\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"vorname\",id:\"vorname\",value:formData.vorname,onChange:handleChange,required:true,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",className:\"block text-sm font-medium text-gray-700\",children:\"Nachname\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",id:\"name\",value:formData.name,onChange:handleChange,required:true,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"geburtsdatum\",className:\"block text-sm font-medium text-gray-700\",children:\"Geburtsdatum\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"geburtsdatum\",id:\"geburtsdatum\",value:formData.geburtsdatum,onChange:handleChange,required:true,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"chiffre\",className:\"block text-sm font-medium text-gray-700\",children:\"Chiffre\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"chiffre\",id:\"chiffre\",value:formData.chiffre,readOnly:true,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 sm:text-sm\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"adresse\",className:\"block text-sm font-medium text-gray-700\",children:\"Adresse\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"adresse\",id:\"adresse\",value:formData.adresse,onChange:handleChange,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"block text-sm font-medium text-gray-700\",children:\"E-Mail\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",id:\"email\",value:formData.email,onChange:handleChange,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"telefon\",className:\"block text-sm font-medium text-gray-700\",children:\"Telefon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"telefon\",id:\"telefon\",value:formData.telefon,onChange:handleChange,className:inputStd})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"krankenkasse\",className:\"block text-sm font-medium text-gray-700\",children:\"Krankenkasse\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"krankenkasse\",id:\"krankenkasse\",value:formData.krankenkasse,onChange:handleChange,className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"versichertennummer\",className:\"block text-sm font-medium text-gray-700\",children:\"Versichertennummer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"versichertennummer\",id:\"versichertennummer\",value:formData.versichertennummer,onChange:handleChange,className:inputStd})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Therapieverfahren\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 flex flex-wrap gap-2\",children:(formData.therapeuticMethods||[]).map(method=>/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center bg-teal-100 text-teal-800 text-xs font-medium px-2.5 py-0.5 rounded-full\",children:[method,/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleRemoveMethod(method),className:\"ml-1.5 text-teal-500 hover:text-teal-700\",children:/*#__PURE__*/_jsx(XCircle,{className:\"h-3 w-3\"})})]},method))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{value:newMethod,onChange:e=>setNewMethod(e.target.value),className:inputStd,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Verfahren ausw\\xE4hlen...\"}),availableTherapeuticMethods.filter(m=>!(formData.therapeuticMethods||[]).includes(m)).map(m=>/*#__PURE__*/_jsx(\"option\",{value:m,children:m},m))]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleAddMethod,className:\"bg-gray-200 p-2 rounded-md hover:bg-gray-300\",children:/*#__PURE__*/_jsx(PlusCircleIcon,{className:\"h-5 w-5 text-gray-600\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"approvedHours\",className:\"block text-sm font-medium text-gray-700\",children:\"Genehmigte Stunden\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"approvedHours\",id:\"approvedHours\",value:formData.approvedHours,onChange:handleChange,min:\"0\",className:inputStd})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onCancel,className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500\",children:\"Abbrechen\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:btnPrimary,children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 mr-2\"}),\" Speichern\"]})]})]});};async function generateGeminiText(prompt){let chatHistory=[{role:\"user\",parts:[{text:prompt}]}];const payload={contents:chatHistory};const GEMINI_API_KEY=\"AIzaSyCWQFze_8cKDZ6W2DTqfqIcvhcsKWfuZLw\";const apiUrl=\"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=\".concat(GEMINI_API_KEY);try{const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!response.ok){var _errorData$error;const errorData=await response.json();console.error(\"Gemini API error details:\",errorData);const errorMessage=((_errorData$error=errorData.error)===null||_errorData$error===void 0?void 0:_errorData$error.message)||\"API request failed with status \".concat(response.status);throw new Error(errorMessage);}const result=await response.json();if(result.candidates&&result.candidates.length>0&&result.candidates[0].content&&result.candidates[0].content.parts&&result.candidates[0].content.parts.length>0){return result.candidates[0].content.parts[0].text;}else if(result.candidates&&result.candidates.length>0&&result.candidates[0].finishReason===\"SAFETY\"){console.warn(\"Gemini API response blocked due to safety reasons.\");return\"Die Antwort wurde aufgrund von Sicherheitsrichtlinien blockiert.\";}else{console.error(\"Unexpected Gemini API response structure:\",result);throw new Error(\"Unerwartete Antwortstruktur von der API.\");}}catch(error){console.error(\"Error calling Gemini API:\",error);throw error;}}const calculateAge=birthdate=>{if(!birthdate)return 0;const birthDate=new Date(birthdate);const today=new Date();let age=today.getFullYear()-birthDate.getFullYear();const m=today.getMonth()-birthDate.getMonth();if(m<0||m===0&&today.getDate()<birthDate.getDate()){age--;}return age;};const PatientOverviewTab=_ref24=>{let{patient,nextAppointment,onUpdateHomeworkStatus,onUpdateQuickNote}=_ref24;// *** KORREKTUR: Hook an den Anfang verschoben ***\nconst openHomeworkSession=useMemo(()=>{// Optional Chaining `?.` stellt sicher, dass kein Fehler auftritt, wenn `patient` null ist\nif(!(patient!==null&&patient!==void 0&&patient.sessions))return null;// Die Sitzungen sind bereits absteigend sortiert\nreturn patient.sessions.find(s=>s.homeworkStatus&&s.homeworkStatus.some(task=>!task.done));},[patient===null||patient===void 0?void 0:patient.sessions]);// *** KORREKTUR: Bedingter Return NACH allen Hooks ***\nif(!patient)return null;const reasonCategoryColors={Motivational:\"bg-orange-100 text-orange-800\",Emotional:\"bg-blue-100 text-blue-800\",Kognitive:\"bg-purple-100 text-purple-800\",\"Organisatorisch/Praktisch\":\"bg-gray-200 text-gray-800\",\"Interaktion mit Therapeut\":\"bg-pink-100 text-pink-800\",Psychopathologisch:\"bg-red-100 text-red-800\"};const getCategoryForReason=reason=>{for(const category in homeworkFailureReasons){if(homeworkFailureReasons[category].includes(reason)){return category;}}return null;};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-1 md:col-span-2 p-3 bg-teal-50 border border-teal-200 rounded-lg\",children:[nextAppointment.isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-teal-700\",children:\"Lade n\\xE4chsten Termin...\"}),nextAppointment.error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-red-600\",children:nextAppointment.error}),nextAppointment.text&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-teal-800\",children:nextAppointment.text})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"quick-note\",className:\"text-sm font-semibold text-gray-700\",children:\"Kurznotiz\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"quick-note\",rows:\"3\",className:\"mt-1 block w-full text-sm p-2 rounded-md border-red-200 bg-red-50/50 focus:ring-red-500 focus:border-red-500 placeholder-red-400/70\",placeholder:\"Wichtige Gedanken, n\\xE4chste Schritte, etc...\",defaultValue:patient.quickNote||'',onBlur:e=>onUpdateQuickNote(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold text-gray-700 mb-3 border-b pb-2\",children:\"Stammdaten\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-3 gap-4 mt-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Nachname\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Vorname\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.vorname})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Geburtsdatum\"}),/*#__PURE__*/_jsx(\"p\",{children:new Date(patient.geburtsdatum).toLocaleDateString('de-DE')})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Alter\"}),/*#__PURE__*/_jsx(\"p\",{children:calculateAge(patient.geburtsdatum)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"E-Mail\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.email||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Telefon\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.telefon||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2 md:col-span-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-500\",children:\"Adresse\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.adresse||'-'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold text-gray-700 mb-3 border-b pb-2\",children:\"Offene Hausaufgaben\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-3 bg-gray-50 rounded-lg text-sm space-y-3\",children:openHomeworkSession?openHomeworkSession.homeworkStatus.map((task,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"h-5 w-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500 mt-0.5\",checked:task.done,onChange:e=>onUpdateHomeworkStatus(openHomeworkSession.id,index,{done:e.target.checked})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsx(\"span\",{className:\" \".concat(task.done?'text-gray-500 line-through':'text-gray-800'),children:task.text}),!task.done&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"text-xs border-gray-300 rounded-md shadow-sm focus:border-teal-300 focus:ring focus:ring-teal-200 focus:ring-opacity-50\",value:task.reason||'',onChange:e=>onUpdateHomeworkStatus(openHomeworkSession.id,index,{reason:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Grund w\\xE4hlen...\"}),Object.entries(homeworkFailureReasons).map(_ref25=>{let[category,reasons]=_ref25;return/*#__PURE__*/_jsx(\"optgroup\",{label:category,children:reasons.map(reason=>/*#__PURE__*/_jsx(\"option\",{value:reason,children:reason},reason))},category);})]}),task.reason&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-medium px-2 py-0.5 rounded-full \".concat(reasonCategoryColors[getCategoryForReason(task.reason)]||'bg-gray-200'),children:getCategoryForReason(task.reason)})]})]})]},index)):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Alle Hausaufgaben sind erledigt. Sehr gut!\"})})]})]});};function App(){var _diagnosisInfo$inkl,_diagnosisInfo$exkl,_diagnosisInfo$inclus,_diagnosisInfo$exclus;// --- States ---\nconst[mainView,setMainView]=useState('patients');const[patients,setPatients]=useState([]);const[selectedPatient,setSelectedPatient]=useState(null);const[isLoading,setIsLoading]=useState(true);const[isInitialLoading,setIsInitialLoading]=useState(true);const[authError,setAuthError]=useState(null);const[appError,setAppError]=useState(null);const[userId,setUserId]=useState(null);const[isAuthReady,setIsAuthReady]=useState(false);const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[isLoginView,setIsLoginView]=useState(true);const[isAuthLoading,setIsAuthLoading]=useState(false);const[isPatientModalOpen,setIsPatientModalOpen]=useState(false);const[editingPatient,setEditingPatient]=useState(null);const[newDiagnosis,setNewDiagnosis]=useState('');const[newDiagnosisCode,setNewDiagnosisCode]=useState('');const[newDiagnosisSicherheit,setNewDiagnosisSicherheit]=useState('G');const[lookedUpDiagnosisName,setLookedUpDiagnosisName]=useState('');const[activeDetailTab,setActiveDetailTab]=useState('übersicht');const[activeDiagnostikSubTab,setActiveDiagnostikSubTab]=useState('overview');const[diagnosisInfo,setDiagnosisInfo]=useState({code:'',name:'',beschreibung:'',inkl:[],exkl:[],hinweise:[],zusatz_info_code:'',sicherheit:'',isLoading:false,error:null,isOpen:false,source:''});const[localIcd10Data,setLocalIcd10Data]=useState({});const[editableKrankheitsanamnese,setEditableKrankheitsanamnese]=useState(\"\");const[editableLebensgeschichte,setEditableLebensgeschichte]=useState(\"\");const[editableProblemanalyseMakro,setEditableProblemanalyseMakro]=useState(\"\");const[editableTherapieplan,setEditableTherapieplan]=useState(\"\");const[therapeutischeAssistenzOutput,setTherapeutischeAssistenzOutput]=useState(\"\");const[isLoadingTherapeutischeAssistenz,setIsLoadingTherapeutischeAssistenz]=useState(false);const[assistenzError,setAssistenzError]=useState(null);const detailViewRef=useRef(null);const[improvementState,setImprovementState]=useState({isOpen:false,isLoading:false,originalText:'',improvedText:'',sessionIndex:null,error:null});const[sortConfig]=useState({key:'name',direction:'ascending'});const[nextAppointment,setNextAppointment]=useState({isLoading:false,text:null,error:null});const[unbilledAppointments,setUnbilledAppointments]=useState([]);const[isLoadingAppointments,setIsLoadingAppointments]=useState(false);const[billingModalState,setBillingModalState]=useState({isOpen:false,event:null,isEditing:false});const[ebmData,setEbmData]=useState([]);const[isManualBillingSetupOpen,setIsManualBillingSetupOpen]=useState(false);const[confirmDeleteState,setConfirmDeleteState]=useState({isOpen:false,onConfirm:null,message:'',title:''});const[profile,setProfile]=useState({});const[isUploading,setIsUploading]=useState(false);const[selectedId,setSelectedId]=useState(null);const[isCalendarLoading,setIsCalendarLoading]=useState(false);const[viewMode,setViewMode]=useState('stack');const[isAddBillingPeriodModalOpen,setIsAddBillingPeriodModalOpen]=useState(false);const[ebmTemplates,setEbmTemplates]=useState([]);const[isZentraleTestModalOpen,setIsZentraleTestModalOpen]=useState(false);const[currentTestToErfassen,setCurrentTestToErfassen]=useState(null);const[testToUpdate,setTestToUpdate]=useState(null);const[diagnostikTemplates,setDiagnostikTemplates]=useState([]);const[isAddTemplateModalOpen,setIsAddTemplateModalOpen]=useState(false);const[currentTemplate,setCurrentTemplate]=useState(null);const[editingTemplate,setEditingTemplate]=useState(null);const[isTemplateEditModalOpen,setTemplateEditModalOpen]=useState(false);const quarterlyDiagnostikAnalysis=useQuarterlyDiagnostikAnalysis(selectedPatient,availableTests);const sortedPatients=useMemo(()=>{let sortablePatients=[...patients];if(sortConfig!==null){sortablePatients.sort((a,b)=>{const valA=a[sortConfig.key]||'';const valB=b[sortConfig.key]||'';if(valA<valB){return sortConfig.direction==='ascending'?-1:1;}if(valA>valB){return sortConfig.direction==='ascending'?1:-1;}return 0;});}return sortablePatients;},[patients,sortConfig]);const handlePatientSelectPreview=patient=>{if(selectedId===patient.id){setSelectedId(null);setSelectedPatient(null);}else{setSelectedPatient(patient);setSelectedId(patient.id);}};const getHighestSessionNumber=sessions=>{if(!sessions)return 0;const sessionNumbers=sessions.map(s=>{var _s$structuredNotes;return(_s$structuredNotes=s.structuredNotes)===null||_s$structuredNotes===void 0?void 0:_s$structuredNotes.sitzungsnummer;}).filter(n=>typeof n==='number'&&!isNaN(n));return sessionNumbers.length>0?Math.max(...sessionNumbers):0;};const handleStartManualBilling=(patientId,date,sessionNumber)=>{const patient=patients.find(p=>p.id===patientId);if(!patient){setAppError(\"Patient für manuelle Abrechnung nicht gefunden.\");return;}let finalSessionNumber;const manualNumber=Number(sessionNumber);if(sessionNumber&&!isNaN(manualNumber)&&manualNumber>0){finalSessionNumber=manualNumber;}else{finalSessionNumber=getHighestSessionNumber(patient.sessions)+1;}const syntheticEvent={id:\"manual_\".concat(Date.now()),summary:\"Manuelle Sitzung (\".concat(patient.chiffre,\")\"),start:{dateTime:new Date(date).toISOString()},sitzungsnummer:finalSessionNumber,isManual:true};handleStartBilling(syntheticEvent);};const fetchNextAppointment=useCallback(async chiffre=>{if(!chiffre)return;setNextAppointment({isLoading:true,text:null,error:null});try{const response=await fetch(\"http://localhost:3001/api/calendar/nextevent?chiffre=\".concat(chiffre));if(response.status===404){setNextAppointment({isLoading:false,text:'Kein zukünftiger Termin gefunden.',error:null});return;}if(!response.ok){throw new Error('Kalender-API-Anfrage fehlgeschlagen.');}const event=await response.json();const startDate=new Date(event.start);const endDate=new Date(event.end);const dateOptions={day:'2-digit',month:'2-digit',year:'numeric'};const timeOptions={hour:'2-digit',minute:'2-digit'};const formattedDate=startDate.toLocaleDateString('de-DE',dateOptions);const formattedStartTime=startDate.toLocaleTimeString('de-DE',timeOptions);const formattedEndTime=endDate.toLocaleTimeString('de-DE',timeOptions);setNextAppointment({isLoading:false,text:\"N\\xE4chster Termin: \".concat(formattedDate,\" um \").concat(formattedStartTime,\" bis \").concat(formattedEndTime,\" Uhr\"),error:null});}catch(error){console.error('Fehler beim Abrufen des Termins:',error);setNextAppointment({isLoading:false,text:null,error:'Termin konnte nicht geladen werden.'});}},[]);const getPatientsCollectionPath=useCallback(()=>{if(!userId)return null;return\"/artifacts/\".concat(firestoreAppId,\"/users/\").concat(userId,\"/patients\");},[userId]);const getProfileDocPath=useCallback(()=>{if(!userId)return null;return\"/artifacts/\".concat(firestoreAppId,\"/users/\").concat(userId,\"/profile/main\");},[userId]);const getEbmTemplatesCollectionPath=useCallback(()=>{if(!userId)return null;return\"/artifacts/\".concat(firestoreAppId,\"/users/\").concat(userId,\"/ebm_templates\");},[userId]);const getDiagnostikTemplatesCollectionPath=useCallback(()=>{if(!userId)return null;return\"/artifacts/\".concat(firestoreAppId,\"/users/\").concat(userId,\"/diagnostik_templates\");},[userId]);const findIcd10CodeLocal=useCallback(codeToFind=>{const upperCodeToFind=codeToFind.toUpperCase();let found=localIcd10Data[upperCodeToFind];if(found)return found;const baseCode=upperCodeToFind.replace(/(\\.-[*]|\\.\\*|[*]|-)$/,'');found=localIcd10Data[\"\".concat(baseCode,\".-*\")]||localIcd10Data[\"\".concat(baseCode,\".*\")]||localIcd10Data[baseCode];if(found)return found;const possibleCategoryCode=Object.keys(localIcd10Data).find(key=>key.startsWith(upperCodeToFind)&&(localIcd10Data[key].code_kategorie||localIcd10Data[key].code));if(possibleCategoryCode)return localIcd10Data[possibleCategoryCode];return null;},[localIcd10Data]);const handleStartBilling=event=>{var _event$summary;const chiffreMatch=(_event$summary=event.summary)===null||_event$summary===void 0?void 0:_event$summary.match(/[A-Z][0-9]{6}/);const chiffre=chiffreMatch?chiffreMatch[0]:null;const targetPatient=patients.find(p=>p.chiffre===chiffre);let nextSessionNumber;if(event.sitzungsnummer){nextSessionNumber=event.sitzungsnummer;}else{nextSessionNumber=1;if(targetPatient){const highestSession=getHighestSessionNumber(targetPatient.sessions);nextSessionNumber=highestSession+1;}}const eventWithSessionNumber=_objectSpread(_objectSpread({},event),{},{sitzungsnummer:nextSessionNumber});setBillingModalState({isOpen:true,event:eventWithSessionNumber,isEditing:false});};const handleEditSession=session=>{var _session$structuredNo,_session$structuredNo2;const event={id:session.id,summary:\"\".concat(((_session$structuredNo=session.structuredNotes)===null||_session$structuredNo===void 0?void 0:_session$structuredNo.thema)||'Sitzung',\" (\").concat(selectedPatient.chiffre,\")\"),start:{dateTime:session.date},sitzungsnummer:(_session$structuredNo2=session.structuredNotes)===null||_session$structuredNo2===void 0?void 0:_session$structuredNo2.sitzungsnummer,initialNotes:session.structuredNotes,initialEbm:session.ebmEntries};setBillingModalState({isOpen:true,event,isEditing:true});};const handleDeleteSession=async sessionId=>{if(!selectedPatient)return;const performDelete=async()=>{const updatedSessions=selectedPatient.sessions.filter(s=>s.id!==sessionId);const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);try{await setDoc(patientRef,{sessions:updatedSessions},{merge:true});setConfirmDeleteState({isOpen:false});}catch(error){console.error(\"Error deleting session: \",error);setAppError(\"Fehler beim Löschen der Sitzung.\");}};setConfirmDeleteState({isOpen:true,title:\"Sitzung löschen?\",message:\"Möchten Sie diese Sitzung und alle zugehörigen Abrechnungsdaten wirklich löschen?\",onConfirm:performDelete});};const handleSaveBilling=async(billingData,isEditing)=>{const{chiffre,eventId,eventStart,notes,ebmEntries,sessionId}=billingData;const targetPatient=patients.find(p=>p.chiffre===chiffre);if(!targetPatient){setAppError(\"Patient mit Chiffre \".concat(chiffre,\" nicht gefunden.\"));return;}const patientRef=doc(db,getPatientsCollectionPath(),targetPatient.id);let updatedSessions;if(isEditing){updatedSessions=targetPatient.sessions.map(session=>{if(session.id===sessionId){return _objectSpread(_objectSpread({},session),{},{structuredNotes:notes,ebmEntries:ebmEntries});}return session;});}else{const newSession={id:\"sess_\".concat(Date.now()),date:new Date(eventStart).toISOString(),structuredNotes:notes,ebmEntries:ebmEntries,eventId:eventId,homeworkStatus:(notes.hausaufgaben||[]).filter(task=>task.trim()!=='').map(taskText=>({text:taskText,done:false,reason:''}))};updatedSessions=[...(targetPatient.sessions||[]),newSession];}updatedSessions.sort((a,b)=>new Date(b.date)-new Date(a.date));try{await setDoc(patientRef,{sessions:updatedSessions},{merge:true});setBillingModalState({isOpen:false,event:null,isEditing:false});if(!isEditing){setActiveDetailTab('abrechnung');}}catch(err){setAppError(\"Fehler beim Speichern der Abrechnung.\");console.error(\"Error saving billing:\",err);}};const handleSaveBillingPeriod=async periodData=>{if(!selectedPatient)return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const newPeriod=_objectSpread({id:\"bp_\".concat(Date.now())},periodData);const updatedPatientData={billingPeriods:[...(selectedPatient.billingPeriods||[]),newPeriod]};const newPeriodDateStr=new Date(newPeriod.date).toISOString().split('T')[0];availableTests.forEach(testDef=>{const resultKey=\"\".concat(testDef.id,\"Results\");const testResults=selectedPatient[resultKey]||[];if(testResults.length>0){const updatedResults=testResults.map(res=>{const testDateStr=new Date(res.date).toISOString().split('T')[0];if(testDateStr===newPeriodDateStr&&!res.billingPeriodId){return _objectSpread(_objectSpread({},res),{},{billingPeriodId:newPeriod.id});}return res;});updatedPatientData[resultKey]=updatedResults;}});try{await setDoc(patientRef,updatedPatientData,{merge:true});setIsAddBillingPeriodModalOpen(false);}catch(err){setAppError(\"Fehler beim Speichern des Abrechnungszeitraums: \".concat(err.message));}};const handleDeleteBillingPeriod=async periodId=>{if(!selectedPatient||!periodId)return;if(!window.confirm(\"M\\xF6chten Sie diesen Abrechnungszeitraum wirklich l\\xF6schen? Alle zugeordneten Tests werden wieder als \\\"nicht zugeordnet\\\" markiert.\")){return;}const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const updatedTestResults={};availableTests.forEach(testDef=>{const resultKey=\"\".concat(testDef.id,\"Results\");if(selectedPatient[resultKey]){updatedTestResults[resultKey]=selectedPatient[resultKey].map(res=>{if(res.billingPeriodId===periodId){return _objectSpread(_objectSpread({},res),{},{billingPeriodId:null});}return res;});}});const updatedPeriods=selectedPatient.billingPeriods.filter(p=>p.id!==periodId);const updatedPatient=_objectSpread(_objectSpread({},selectedPatient),{},{billingPeriods:updatedPeriods},updatedTestResults);setSelectedPatient(updatedPatient);try{await setDoc(patientRef,_objectSpread({billingPeriods:updatedPeriods},updatedTestResults),{merge:true});}catch(err){setAppError(\"Fehler beim Löschen des Abrechnungszeitraums.\");console.error(err);}};const handleAddPendingTest=async test=>{if(!selectedPatient||!test)return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const resultKey=\"\".concat(test.id,\"Results\");const newTestResult={date:new Date().toISOString(),status:'pending',results:{},testInstanceId:\"test_\".concat(test.id,\"_\").concat(Date.now()),testGrund:'Einzeltestung',billingPeriodId:null};const updatedTestList=[...(selectedPatient[resultKey]||[]),newTestResult];try{await updateDoc(patientRef,{[resultKey]:updatedTestList});alert(\"Test \\\"\".concat(test.name,\"\\\" wurde zur Liste der ausstehenden Tests hinzugef\\xFCgt.\"));}catch(err){setAppError(\"Fehler beim Hinzuf\\xFCgen des Tests: \".concat(err.message));}};const handleSaveCompletedTest=async(patientId,testData)=>{const{testId,results,date}=testData;if(!patientId||!testId)return;const patientRef=doc(db,getPatientsCollectionPath(),patientId);const targetPatient=patients.find(p=>p.id===patientId);if(!targetPatient)return;const resultKey=\"\".concat(testId,\"Results\");const newTestResult={date:date,results:results,status:'completed',testGrund:'Einzeltestung (Global)',testInstanceId:\"test_\".concat(testId,\"_\").concat(Date.now()),billingPeriodId:null};const updatedTestResultsList=[...(targetPatient[resultKey]||[]),newTestResult];try{await updateDoc(patientRef,{[resultKey]:updatedTestResultsList});setIsZentraleTestModalOpen(false);}catch(err){setAppError(\"Fehler beim Speichern des Tests: \".concat(err.message));}};const handleCompletePendingTest=testToComplete=>{if(!testToComplete)return;setTestToUpdate(testToComplete);const testInfo=availableTests.find(t=>t.id===testToComplete.testType);setCurrentTestToErfassen(testInfo);setIsZentraleTestModalOpen(true);};const handleUpdateTest=async(testInstanceId,testType,newResults,newDate)=>{if(!selectedPatient)return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const resultKey=\"\".concat(testType,\"Results\");const updatedTestList=selectedPatient[resultKey].map(test=>{if(test.testInstanceId===testInstanceId){return _objectSpread(_objectSpread({},test),{},{results:newResults,date:newDate,status:'completed'});}return test;});try{await updateDoc(patientRef,{[resultKey]:updatedTestList});setIsZentraleTestModalOpen(false);setTestToUpdate(null);}catch(err){setAppError(\"Fehler beim Aktualisieren des Tests: \".concat(err.message));}};const handleSaveTestTemplate=async(patientId,template)=>{const{name,tests:testIds}=template;if(!patientId||!testIds||testIds.length===0)return;const patientRef=doc(db,getPatientsCollectionPath(),patientId);const targetPatient=patients.find(p=>p.id===patientId);if(!targetPatient)return;const updates={};const timestamp=Date.now();const dateISO=new Date().toISOString();testIds.forEach((testId,index)=>{const resultKey=\"\".concat(testId,\"Results\");const testInstanceId=\"test_\".concat(testId,\"_\").concat(timestamp+index);const newTestResult={date:dateISO,status:'pending',results:{},testInstanceId,testGrund:name,billingPeriodId:null};if(!updates[resultKey])updates[resultKey]=[...(targetPatient[resultKey]||[])];updates[resultKey].push(newTestResult);});try{await updateDoc(patientRef,updates);alert(\"Testvorlage \\\"\".concat(name,\"\\\" f\\xFCr Patient*in \").concat(targetPatient.chiffre,\" hinzugef\\xFCgt.\"));}catch(err){setAppError(\"Fehler beim Speichern der Testvorlage: \".concat(err.message));}};const handleUpdateTestGrund=async(testInstanceId,testType,newGrund)=>{if(!selectedPatient)return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const resultKey=\"\".concat(testType,\"Results\");const updatedTestList=selectedPatient[resultKey].map(test=>{if(test.testInstanceId===testInstanceId){return _objectSpread(_objectSpread({},test),{},{testGrund:newGrund});}return test;});try{await updateDoc(patientRef,{[resultKey]:updatedTestList});}catch(err){setAppError(\"Fehler beim Aktualisieren des Testgrunds: \".concat(err.message));}};const handleDeleteTest=async(testInstanceId,testType)=>{if(!selectedPatient||!testInstanceId||!testType){return;}if(!window.confirm(\"Möchten Sie diesen Testeintrag wirklich endgültig löschen?\"))return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);const resultKey=\"\".concat(testType,\"Results\");const updatedTestResultsList=(selectedPatient[resultKey]||[]).filter(r=>r.testInstanceId!==testInstanceId);const updatedPatient=_objectSpread(_objectSpread({},selectedPatient),{},{[resultKey]:updatedTestResultsList});setSelectedPatient(updatedPatient);try{await updateDoc(patientRef,{[resultKey]:updatedTestResultsList});}catch(err){setAppError(\"Fehler beim Löschen des Testergebnisses.\");const originalPatient=patients.find(p=>p.id===selectedPatient.id);if(originalPatient)setSelectedPatient(originalPatient);}};const handleSaveDiagnostikTemplate=async templateData=>{const collectionPath=getDiagnostikTemplatesCollectionPath();if(!collectionPath)return;try{const dataToSave={name:templateData.name,tests:templateData.tests};if(templateData.id){await setDoc(doc(db,collectionPath,templateData.id),dataToSave);}else{await addDoc(collection(db,collectionPath),dataToSave);}}catch(err){console.error(\"Error saving diagnostik template:\",err);setAppError(\"Fehler beim Speichern der Diagnostik-Vorlage: \".concat(err.message));}};const handleDeleteDiagnostikTemplate=async templateId=>{const collectionPath=getDiagnostikTemplatesCollectionPath();if(!collectionPath)return;if(window.confirm(\"Möchten Sie diese Diagnostik-Vorlage wirklich löschen?\")){try{await deleteDoc(doc(db,collectionPath,templateId));}catch(err){setAppError(\"Fehler beim L\\xF6schen der Diagnostik-Vorlage: \".concat(err.message));}}};const handleUpdateHomeworkStatus=async(sessionId,homeworkIndex,newStatus)=>{if(!selectedPatient||!userId)return;const collectionPath=getPatientsCollectionPath();const patientRef=doc(db,collectionPath,selectedPatient.id);const updatedSessions=JSON.parse(JSON.stringify(selectedPatient.sessions));const sessionToUpdate=updatedSessions.find(s=>s.id===sessionId);if(sessionToUpdate&&sessionToUpdate.homeworkStatus&&sessionToUpdate.homeworkStatus[homeworkIndex]){Object.assign(sessionToUpdate.homeworkStatus[homeworkIndex],newStatus);}try{await setDoc(patientRef,{sessions:updatedSessions},{merge:true});}catch(err){console.error(\"Error updating homework status:\",err);setAppError(\"Fehler beim Aktualisieren des Hausaufgabenstatus.\");}};const handleUpdateQuickNote=async note=>{if(!selectedPatient||!userId)return;const patientRef=doc(db,getPatientsCollectionPath(),selectedPatient.id);try{await updateDoc(patientRef,{quickNote:note});}catch(err){console.error(\"Error saving quick note:\",err);setAppError(\"Fehler beim Speichern der Notiz.\");}};const handleSaveEbmTemplate=async templateData=>{if(!userId){setAppError(\"Benutzer nicht authentifiziert.\");return;}const collectionPath=getEbmTemplatesCollectionPath();if(!collectionPath)return;try{await addDoc(collection(db,collectionPath),templateData);}catch(err){console.error(\"Error saving EBM template:\",err);setAppError(\"Fehler beim Speichern der EBM-Vorlage.\");}};const handleDeleteEbmTemplate=async templateId=>{if(!userId){setAppError(\"Benutzer nicht authentifiziert.\");return;}const collectionPath=getEbmTemplatesCollectionPath();if(!collectionPath)return;if(!window.confirm(\"Möchten Sie diese Vorlage wirklich löschen?\"))return;try{await deleteDoc(doc(db,collectionPath,templateId));}catch(err){console.error(\"Error deleting EBM template:\",err);setAppError(\"Fehler beim Löschen der EBM-Vorlage.\");}};const handleOpenZentraleTestModal=test=>{setCurrentTestToErfassen(test);setTestToUpdate(null);setIsZentraleTestModalOpen(true);};const handleOpenTemplateModal=template=>{setCurrentTemplate(template);setIsAddTemplateModalOpen(true);};// --- useEffects ---\nuseEffect(()=>{const timer=setTimeout(()=>{setIsInitialLoading(false);},1500);return()=>clearTimeout(timer);},[]);useEffect(()=>{if(mainView==='kalender'){setIsCalendarLoading(true);const timer=setTimeout(()=>{setIsCalendarLoading(false);},1500);return()=>clearTimeout(timer);}},[mainView]);useEffect(()=>{if(ebmData.length===0){fetch('/ebm_data_full.json').then(res=>res.json()).then(setEbmData).catch(err=>console.error(\"Failed to load EBM data\",err));}},[ebmData.length]);useEffect(()=>{if(mainView==='abrechnung'){setIsLoadingAppointments(true);fetch('http://localhost:3001/api/calendar/past-events').then(res=>{if(!res.ok){return res.json().then(errorData=>{throw new Error(errorData.message||\"Serverfehler: \".concat(res.status));});}return res.json();}).then(calendarEvents=>{if(!Array.isArray(calendarEvents)){throw new Error(\"Unerwartetes Datenformat vom Server erhalten.\");};const billedEventIds=new Set();patients.forEach(p=>{(p.sessions||[]).forEach(s=>{if(s.eventId)billedEventIds.add(s.eventId);});});const unbilled=calendarEvents.filter(event=>{var _event$summary2;return!billedEventIds.has(event.id)&&((_event$summary2=event.summary)===null||_event$summary2===void 0?void 0:_event$summary2.match(/[A-Z][0-9]{6}/));});setUnbilledAppointments(unbilled);}).catch(err=>{if(err.message&&err.message.includes('Nicht bei Google authentifiziert')){setAppError(\"Kalender-Fehler: Sie m\\xFCssen sich erneut bei Google authentifizieren. Rufen Sie dazu im Browser auf: http://localhost:3001/auth/google\");}else{setAppError(\"Offene Abrechnungen konnten nicht geladen werden: \".concat(err.message));}}).finally(()=>setIsLoadingAppointments(false));}},[mainView,patients]);useEffect(()=>{if(selectedPatient){fetchNextAppointment(selectedPatient.chiffre);}else{setNextAppointment({isLoading:false,text:null,error:null});}},[selectedPatient,fetchNextAppointment]);useEffect(()=>{fetch('/icd10f_data.json').then(response=>{if(!response.ok)throw new Error(\"HTTP error! status: \".concat(response.status));return response.json();}).then(data=>{const indexedData={};data.forEach(item=>{if(item.code){indexedData[item.code.toUpperCase()]=item;}});setLocalIcd10Data(indexedData);}).catch(error=>{console.error(\"Fehler beim Laden der lokalen ICD-10 Daten:\",error);setAppError(\"Lokale ICD-10 Daten konnten nicht geladen werden. \"+error.message);});},[]);useEffect(()=>{if(selectedPatient&&!selectedId){setEditableKrankheitsanamnese(selectedPatient.krankheitsanamnese||\"\");setEditableLebensgeschichte(selectedPatient.lebensgeschichte||\"\");setEditableProblemanalyseMakro(selectedPatient.problemanalyseMakro||\"\");setEditableTherapieplan(selectedPatient.therapieplan||\"\");if(detailViewRef.current){setTimeout(()=>{detailViewRef.current.scrollIntoView({behavior:'smooth',block:'start'});},100);}}else{setEditableKrankheitsanamnese(\"\");setEditableLebensgeschichte(\"\");setEditableProblemanalyseMakro(\"\");setEditableTherapieplan(\"\");}},[selectedPatient,selectedId]);useEffect(()=>{if(newDiagnosisCode.trim()!==''){const found=findIcd10CodeLocal(newDiagnosisCode.trim().toUpperCase());if(found&&found.name){setLookedUpDiagnosisName(found.name);}else{setLookedUpDiagnosisName('');}}else{setLookedUpDiagnosisName('');}},[newDiagnosisCode,findIcd10CodeLocal]);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,user=>{if(user){setUserId(user.uid);}else{setUserId(null);}setIsAuthReady(true);setIsLoading(false);});return()=>unsubscribe();},[]);const seedInitialData=useCallback(async collectionPath=>{if(!userId||!collectionPath)return;try{const patientsCollection=collection(db,collectionPath);const querySnapshot=await getDocs(patientsCollection);if(querySnapshot.empty){const batch=writeBatch(db);initialPatientsData.forEach(patientData=>{const newPatientRef=doc(patientsCollection);batch.set(newPatientRef,_objectSpread(_objectSpread({},patientData),{},{hscl11Results:patientData.hscl11Results||[],bdi2Results:patientData.bdi2Results||[],fep2Results:patientData.fep2Results||[],scl90rResults:patientData.scl90rResults||[],gad7Results:patientData.gad7Results||[],coreOmResults:patientData.coreOmResults||[],iipcResults:patientData.iipcResults||[],diagnoses_icd11:patientData.diagnoses_icd11||[],billingPeriods:patientData.billingPeriods||[],krankheitsanamnese:patientData.krankheitsanamnese||\"\",lebensgeschichte:patientData.lebensgeschichte||\"\",problemanalyseMakro:patientData.problemanalyseMakro||\"\",therapieplan:patientData.therapieplan||\"\"}));});await batch.commit();}}catch(err){console.error(\"Error seeding initial data:\",err);setAppError(\"Fehler beim Laden der initialen Daten.\");}},[userId]);useEffect(()=>{if(!isAuthReady||!userId){setPatients([]);setProfile({});setEbmTemplates([]);setDiagnostikTemplates([]);return;}const unsubscribes=[];setIsLoading(true);const paths=[{path:getPatientsCollectionPath(),setter:setPatients,process:docs=>docs.map(d=>_objectSpread({id:d.id},d.data())).sort((a,b)=>(a.name||\"\").localeCompare(b.name||\"\"))},{path:getProfileDocPath(),setter:setProfile,isDoc:true},{path:getEbmTemplatesCollectionPath(),setter:setEbmTemplates,process:docs=>docs.map(d=>_objectSpread({id:d.id},d.data()))},{path:getDiagnostikTemplatesCollectionPath(),setter:setDiagnostikTemplates,process:docs=>docs.map(d=>_objectSpread({id:d.id},d.data()))}];seedInitialData(getPatientsCollectionPath());paths.forEach(_ref26=>{let{path,setter,process,isDoc}=_ref26;if(path){if(isDoc){unsubscribes.push(onSnapshot(doc(db,path),docSnap=>{setter(docSnap.exists()?docSnap.data():{});}));}else{unsubscribes.push(onSnapshot(query(collection(db,path)),snapshot=>{const data=process?process(snapshot.docs):snapshot.docs.map(d=>_objectSpread({id:d.id},d.data()));setter(data);}));}}});setIsLoading(false);return()=>unsubscribes.forEach(unsub=>unsub());},[isAuthReady,userId,getDiagnostikTemplatesCollectionPath,getEbmTemplatesCollectionPath,getPatientsCollectionPath,getProfileDocPath,seedInitialData]);useEffect(()=>{if(selectedPatient){const currentPatientDataFromList=patients.find(p=>p.id===selectedPatient.id);if(currentPatientDataFromList){if(JSON.stringify(currentPatientDataFromList)!==JSON.stringify(selectedPatient)){setSelectedPatient(currentPatientDataFromList);}}else{setSelectedPatient(null);setSelectedId(null);}}},[patients,selectedPatient]);useEffect(()=>{const loadIcd10Data=async()=>{try{const response=await fetch('/icd10f_data.json');if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();const indexedData={};data.forEach(item=>{if(item.code){indexedData[item.code.toUpperCase()]=item;const baseCode=item.code.replace(/[*†]/,'').toUpperCase();if(baseCode!==item.code.toUpperCase()){indexedData[baseCode]=item;}}});setLocalIcd10Data(indexedData);}catch(error){console.error(\"Fehler beim Laden der lokalen ICD-10 Daten:\",error);setAppError(\"Lokale ICD-10 Daten konnten nicht geladen werden. \"+error.message);}};loadIcd10Data();},[]);const bdiCutoffs=[{y1:0,y2:8,label:\"Keine Depression\",color:\"rgba(75, 192, 192, 0.2)\"},{y1:9,y2:13,label:\"Minimale Depression\",color:\"rgba(54, 162, 235, 0.2)\"},{y1:14,y2:19,label:\"Leichte Depression\",color:\"rgba(255, 206, 86, 0.2)\"},{y1:20,y2:28,label:\"Mittelschwere Depression\",color:\"rgba(255, 159, 64, 0.2)\"},{y1:29,y2:63,label:\"Schwere Depression\",color:\"rgba(255, 99, 132, 0.2)\"}];const bdiAxisTicks=[0,8,13,19,28,63];const handleAuthAction=async isRegistering=>{setIsAuthLoading(true);setAuthError(null);try{if(isRegistering){await createUserWithEmailAndPassword(auth,email,password);}else{await signInWithEmailAndPassword(auth,email,password);}setEmail(\"\");setPassword(\"\");}catch(error){console.error(\"Authentication error:\",error);setAuthError(error.message);}finally{setIsAuthLoading(false);}};const handleLogout=async()=>{try{await signOut(auth);setSelectedPatient(null);setPatients([]);}catch(error){console.error(\"Error signing out: \",error);setAppError(\"Fehler beim Abmelden.\");}};const handleSavePatient=async patientData=>{if(!userId){setAppError(\"Benutzer nicht authentifiziert.\");return;}const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const dataToSave={name:patientData.name||'',vorname:patientData.vorname||'',chiffre:patientData.chiffre||'',geburtsdatum:patientData.geburtsdatum||'',adresse:patientData.adresse||'',email:patientData.email||'',telefon:patientData.telefon||'',krankenkasse:patientData.krankenkasse||'',versichertennummer:patientData.versichertennummer||'',approvedHours:patientData.approvedHours||0,therapeuticMethods:patientData.therapeuticMethods||[],diagnoses:patientData.diagnoses||[],diagnoses_icd11:patientData.diagnoses_icd11||[],sessions:patientData.sessions||[],hscl11Results:patientData.hscl11Results||[],bdi2Results:patientData.bdi2Results||[],fep2Results:patientData.fep2Results||[],scl90rResults:patientData.scl90rResults||[],gad7Results:patientData.gad7Results||[],coreOmResults:patientData.coreOmResults||[],iipcResults:patientData.iipcResults||[],billingPeriods:patientData.billingPeriods||[],krankheitsanamnese:patientData.krankheitsanamnese||\"\",lebensgeschichte:patientData.lebensgeschichte||\"\",problemanalyseMakro:patientData.problemanalyseMakro||\"\",therapieplan:patientData.therapieplan||\"\"};try{if(editingPatient&&editingPatient.id){const patientRef=doc(db,collectionPath,editingPatient.id);await setDoc(patientRef,dataToSave,{merge:true});}else{await addDoc(collection(db,collectionPath),dataToSave);}setIsPatientModalOpen(false);setEditingPatient(null);}catch(err){console.error(\"Error saving patient:\",err);setAppError(\"Fehler beim Speichern des Patienten: \".concat(err.message));}};const handleAddDiagnosis=async()=>{const codeToAdd=newDiagnosisCode.trim().toUpperCase();if(!selectedPatient||!codeToAdd||!userId){setAppError(\"Bitte füllen Sie alle erforderlichen Felder aus.\");return;}const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const sicherheitPrefix=newDiagnosisSicherheit?\"[\".concat(newDiagnosisSicherheit,\"] \"):\"\";const beschreibung=newDiagnosis.trim()?\": \".concat(newDiagnosis.trim()):lookedUpDiagnosisName?\": \".concat(lookedUpDiagnosisName):\"\";const diagnosisString=\"\".concat(sicherheitPrefix).concat(codeToAdd).concat(beschreibung);const updatedDiagnoses=[...(selectedPatient.diagnoses||[]),diagnosisString];const patientRef=doc(db,collectionPath,selectedPatient.id);try{await setDoc(patientRef,{diagnoses:updatedDiagnoses},{merge:true});setNewDiagnosisCode('');setNewDiagnosis('');setLookedUpDiagnosisName('');setNewDiagnosisSicherheit('G');}catch(err){console.error(\"Error adding diagnosis:\",err);setAppError(\"Fehler beim Hinzufügen der Diagnose.\");}};const handleRemoveDiagnosis=async diagnosisStringToRemove=>{if(!selectedPatient||!userId)return;const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const updatedDiagnoses=selectedPatient.diagnoses.filter(d=>d!==diagnosisStringToRemove);const patientRef=doc(db,collectionPath,selectedPatient.id);try{await setDoc(patientRef,{diagnoses:updatedDiagnoses},{merge:true});}catch(err){console.error(\"Error removing diagnosis:\",err);setAppError(\"Fehler beim Entfernen der Diagnose.\");}};const handleKrankheitsmodellChange=async(fieldName,value)=>{if(!selectedPatient||!userId)return;const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const patientRef=doc(db,collectionPath,selectedPatient.id);try{await setDoc(patientRef,{[fieldName]:value},{merge:true});}catch(err){console.error(\"Error updating \".concat(fieldName,\":\"),err);setAppError(\"Fehler beim Speichern von \".concat(fieldName,\".\"));}};const handleTherapeutischeAssistenzAnfordern=async()=>{if(!selectedPatient){setAssistenzError(\"Bitte wählen Sie zuerst einen Patienten aus.\");return;}setIsLoadingTherapeutischeAssistenz(true);setTherapeutischeAssistenzOutput(\"\");setAssistenzError(null);const conductedHours=getHighestSessionNumber(selectedPatient.sessions);const patientenDatenText=\"Hier sind die relevanten Patientendaten:\\n**Krankheitsanamnese:**\\n\".concat(selectedPatient.krankheitsanamnese||\"Keine Angaben.\",\"\\n**Lebensgeschichte/Biografie:**\\n\").concat(selectedPatient.lebensgeschichte||\"Keine Angaben.\",\"\\n**Problemanalyse auf Makroebene:**\\n\").concat(selectedPatient.problemanalyseMakro||\"Keine Angaben.\",\"\\n**Therapieplanung (bisherig):**\\n\").concat(selectedPatient.therapieplan||\"Keine Angaben.\",\"\\n**Verlaufsdokumentation (Sitzungsnotizen):**\\n\").concat((selectedPatient.sessions||[]).map((s,i)=>{var _s$structuredNotes2,_s$structuredNotes3;return\"Sitzung \".concat(((_s$structuredNotes2=s.structuredNotes)===null||_s$structuredNotes2===void 0?void 0:_s$structuredNotes2.sitzungsnummer)||i+1,\" (\").concat(new Date(s.date).toLocaleDateString('de-DE'),\"): \").concat(((_s$structuredNotes3=s.structuredNotes)===null||_s$structuredNotes3===void 0?void 0:_s$structuredNotes3.patientenbericht)||s.notes);}).join(\"\\n\\n\")||\"Keine Sitzungsnotizen vorhanden.\",\"\\n**Diagnosen:**\\n\").concat((selectedPatient.diagnoses||[]).join(\", \")||\"Keine Diagnosen erfasst.\",\"\\n**Genehmigte Stunden:** \").concat(selectedPatient.approvedHours,\"\\n**Durchgef\\xFChrte Stunden:** \").concat(conductedHours);const systemPrompt=\"Du bist ein interdisziplin\\xE4res Expertenteam, bestehend aus erfahrenen Verhaltenstherapeuten wie J\\xFCrgen Margraf, Dr. Stavemann, Aaron T. Beck, Judith Beck und Jonathan S. Abramowitz sowie aus leitenden Chef\\xE4rzten und Psychiatern wie Prof. Dr. Mathias Berger. Das Team verf\\xFCgt \\xFCber exzellente Fachkompetenz in der evidenzbasierten psychotherapeutischen Praxis und legt besonderen Wert auf pr\\xE4zise medizinische Dokumentation sowie therapeutische Qualit\\xE4t. Dar\\xFCber hinaus geh\\xF6ren auch international anerkannte Experten wie David H. Barlow, Stefan G. Hofmann und Steven Hayes zum Team. Du verf\\xFCgst \\xFCber tiefgehendes Wissen in Ans\\xE4tzen der sogenannten \\u201Edritten Welle\\u201C der Verhaltenstherapie, insbesondere in ACT, Schematherapie und DBT.\\nDeine Aufgabe ist es, auf Grundlage folgender Elemente, welche du aus den bereitgestellten Patientendaten entnimmst:\\n- Krankheitsanamnese, Lebensgeschichte/Biografie, Problemanalyse auf Makroebene, Therapieplanung (bisherig), Verlaufsdokumentation (Sitzungsnotizen)\\neine strukturierte R\\xFCckmeldung zu geben mit dem Ziel:\\n1. Wesentliche Schwerpunkte in der weiteren Therapieplanung zu identifizieren.\\n2. Konkrete Interventionsideen zu formulieren, orientiert an den zugelassenen Stunden.\\n3. Hinweise zu geben, worauf in der Strukturierung der Sitzungen geachtet werden sollte (z.B. Themenfokus, Symptomschwere, Therapiezielorientierung).\\nBer\\xFCcksichtige dabei:\\n\\u2022 Die begrenzte Anzahl genehmigter Stunden. \\u2022 Dass Themen nicht zu h\\xE4ufig gewechselt werden sollen. \\u2022 Die Konsistenz und Nachvollziehbarkeit im Verlauf.\\nBitte plane deine Analyse gr\\xFCndlich und reflektiert. Handle in Etappen:\\n1. Diagnostische Schwerpunkte benennen, 2. Therapieziele definieren, 3. Interventionsvorschl\\xE4ge machen, 4. Hinweise zur Dokumentation geben\\nAtme einmal tief ein und aus und nehme dir Zeit f\\xFCr die Aufgabe. Mache bitte weiter, bis das Problem vollst\\xE4ndig gel\\xF6st ist. Planen bitte ausf\\xFChrlich vor jeder Aktion.\\nHier sind die Daten des aktuellen Falls:\\n\".concat(patientenDatenText,\"\\nBitte gib deine strukturierte R\\xFCckmeldung.\");try{const assistenz=await generateGeminiText(systemPrompt);setTherapeutischeAssistenzOutput(assistenz);}catch(e){setAssistenzError(\"Fehler bei der Anforderung der therapeutischen Assistenz: \".concat(e.message));}finally{setIsLoadingTherapeutischeAssistenz(false);}};const showDiagnosisInfo=diagnosisString=>{const sicherheitMatch=diagnosisString.match(/^\\[([AVGZN]+)\\]\\s*/i);const sicherheit=sicherheitMatch?sicherheitMatch[1].toUpperCase():'';const codeAndName=sicherheitMatch?diagnosisString.substring(sicherheitMatch[0].length):diagnosisString;const codeMatch=codeAndName.match(/^([A-Z][0-9]{1,2}(\\.[0-9A-Z]{1,2})?[*†]?)/i);const code=codeMatch?codeMatch[0].toUpperCase():codeAndName.split(':')[0].trim().toUpperCase();const localData=findIcd10CodeLocal(code);if(localData){setDiagnosisInfo({code:localData.code||code,name:localData.name||'',beschreibung:localData.beschreibung||localData.beschreibung_kategorie||'',inkl:localData.inkl||[],exkl:localData.exkl||[],hinweise:localData.hinweise||[],zusatz_info_code:localData.zusatz_info_code||'',sicherheit:sicherheit,isLoading:false,error:null,isOpen:true,source:'local'});}else{setDiagnosisInfo({code:code,name:\"Unbekannter ICD-10 Code\",isLoading:false,error:\"F\\xFCr den ICD-10 Code \\\"\".concat(code,\"\\\" wurden keine Informationen in der lokalen Datenbank gefunden.\"),isOpen:true,source:'error'});}};const fetchIcd11Details=async diagnosis=>{if(!diagnosis||!diagnosis.uri){setAppError(\"Keine gültige URI für die ICD-11 Diagnose vorhanden.\");return;}const{code,title,uri}=diagnosis;setDiagnosisInfo({code:code,name:title,isLoading:true,error:null,isOpen:true,source:'api'});try{var _fullData$title,_fullData$definition;const response=await fetch(\"http://localhost:3001/api/icd11-info?uri=\".concat(encodeURIComponent(uri)));if(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'API-Anfrage fehlgeschlagen');}const fullData=await response.json();setDiagnosisInfo({code:fullData.code||code,name:((_fullData$title=fullData.title)===null||_fullData$title===void 0?void 0:_fullData$title['@value'])||title,beschreibung:((_fullData$definition=fullData.definition)===null||_fullData$definition===void 0?void 0:_fullData$definition['@value'])||'',diagnosticCriteria:fullData.diagnosticCriteria,inclusions:fullData.inclusion,exclusions:fullData.exclusion,isLoading:false,error:null,isOpen:true,source:'api_detail'});}catch(error){console.error('Fehler beim Abrufen der ICD-11 Details:',error);setDiagnosisInfo({code:code,isLoading:false,error:\"Konnte Informationen f\\xFCr \".concat(code,\" nicht laden: \").concat(error.message),isOpen:true,source:'api'});}};const handleAssignIcd11Diagnosis=async(patientId,icd11Entity)=>{if(!patientId||!icd11Entity||!userId)return;const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const patientRef=doc(db,collectionPath,patientId);const targetPatient=patients.find(p=>p.id===patientId);if(!targetPatient){setAppError(\"Ziel-Patient konnte nicht gefunden werden.\");return;}const newDiagnosis={code:icd11Entity.code,title:icd11Entity.selectedText,uri:icd11Entity.linearizationUri||icd11Entity.foundationUri,date:new Date().toISOString()};const updatedDiagnoses=[...(targetPatient.diagnoses_icd11||[]),newDiagnosis];try{await setDoc(patientRef,{diagnoses_icd11:updatedDiagnoses},{merge:true});}catch(err){console.error(\"Error assigning ICD-11 diagnosis:\",err);setAppError(\"Fehler beim Zuweisen der ICD-11 Diagnose.\");}};const handleRemoveIcd11Diagnosis=async diagnosisToRemove=>{if(!selectedPatient||!userId)return;const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const updatedDiagnoses=selectedPatient.diagnoses_icd11.filter(d=>d.date!==diagnosisToRemove.date);const patientRef=doc(db,collectionPath,selectedPatient.id);try{await setDoc(patientRef,{diagnoses_icd11:updatedDiagnoses},{merge:true});}catch(err){console.error(\"Error removing ICD-11 diagnosis:\",err);setAppError(\"Fehler beim Entfernen der ICD-11 Diagnose.\");}};const handleAcceptImprovement=async()=>{if(improvementState.sessionIndex===null||!selectedPatient||!userId)return;const collectionPath=getPatientsCollectionPath();if(!collectionPath)return;const updatedSessions=JSON.parse(JSON.stringify(selectedPatient.sessions));updatedSessions[improvementState.sessionIndex].notes=improvementState.improvedText;const patientRef=doc(db,collectionPath,selectedPatient.id);try{await setDoc(patientRef,{sessions:updatedSessions},{merge:true});setImprovementState({isOpen:false,isLoading:false,originalText:'',improvedText:'',sessionIndex:null,error:null});}catch(err){console.error(\"Error updating session note:\",err);setAppError(\"Fehler beim Aktualisieren der Sitzungsnotiz.\");}};const handleSaveProfile=async profileData=>{if(!userId){setAppError(\"Benutzer nicht authentifiziert.\");return;}const profileDocRef=doc(db,getProfileDocPath());try{await setDoc(profileDocRef,profileData,{merge:true});alert(\"Profil erfolgreich gespeichert!\");}catch(err){console.error(\"Error saving profile:\",err);setAppError(\"Fehler beim Speichern des Profils: \".concat(err.message));}};const handleUploadFile=async(file,path)=>{if(!userId)throw new Error(\"Benutzer nicht authentifiziert.\");setIsUploading(true);const storageRef=ref(storage,\"users/\".concat(userId,\"/\").concat(path,\"/\").concat(file.name));try{const snapshot=await uploadBytes(storageRef,file);const downloadURL=await getDownloadURL(snapshot.ref);return downloadURL;}catch(error){console.error(\"Upload failed\",error);throw error;}finally{setIsUploading(false);}};const inputStd=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500 sm:text-sm\";const btnPrimary=\"bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-md shadow-sm flex items-center justify-center transition-colors\";const btnDanger=\"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-3 rounded-md flex items-center transition-colors\";const btnInfo=\"bg-sky-500 hover:bg-sky-600 text-white font-semibold py-1 px-2 text-xs rounded-md flex items-center transition-colors\";const textareaStd=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500 sm:text-sm min-h-[150px]\";const selectedIndex=useMemo(()=>selectedId?sortedPatients.findIndex(p=>p.id===selectedId):-1,[selectedId,sortedPatients]);const compactHeight=160;const expandedHeight=620;const overlap=120;const visibleHeight=compactHeight-overlap;const totalHeight=sortedPatients.length*visibleHeight+overlap+(selectedIndex!==-1?expandedHeight-compactHeight:0);const Sidebar=_ref27=>{let{currentView,setView}=_ref27;const navItems=[{id:'profile',label:'Profil',icon:/*#__PURE__*/_jsx(SettingsIcon,{}),type:'item'},{id:'kalender',label:'Kalender',icon:/*#__PURE__*/_jsx(CalendarIcon,{}),type:'item'},{type:'heading',label:'Patienten'},{id:'patients',label:'Patientenübersicht',icon:/*#__PURE__*/_jsx(Users,{}),type:'item'},{id:'patientenakte',label:'Patientenakte',icon:/*#__PURE__*/_jsx(FileText,{}),type:'item'},{type:'heading',label:'Verwaltung'},{id:'abrechnung',label:'Abrechnung',icon:/*#__PURE__*/_jsx(DollarSignIcon,{}),type:'item'},{id:'diagnostik',label:'Diagnostik',icon:/*#__PURE__*/_jsx(BeakerIcon,{}),type:'item'},{id:'formulare',label:'Formulare',icon:/*#__PURE__*/_jsx(PaperclipIcon,{}),type:'item'},{type:'heading',label:'Nachschlagewerke'},{id:'ebm',label:'EBM',icon:/*#__PURE__*/_jsx(List,{}),type:'item'},{id:'ebm_templates',label:'EBM Vorlagen',icon:/*#__PURE__*/_jsx(ClipboardListIcon,{}),type:'item'},{id:'icd11',label:'ICD-11',icon:/*#__PURE__*/_jsx(BookOpen,{}),type:'item'},{id:'methoden',label:'Behandlungsmethoden',icon:/*#__PURE__*/_jsx(LayersIcon,{}),type:'item'}];return/*#__PURE__*/_jsxs(\"aside\",{className:\"w-64 bg-slate-100 border-r border-slate-200 flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-b border-slate-200\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-teal-700 tracking-tight\",children:\"Therapie-Dashboard\"})}),/*#__PURE__*/_jsx(\"nav\",{className:\"flex-1 p-4 space-y-1\",children:navItems.map((item,index)=>item.type==='heading'?/*#__PURE__*/_jsx(\"h3\",{className:\"px-3 pt-4 pb-1 text-xs font-semibold text-gray-500 uppercase tracking-wider\",children:item.label},\"heading-\".concat(index)):/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setView(item.id);setSelectedPatient(null);setSelectedId(null);},className:\"w-full flex items-center space-x-3 px-3 py-2 rounded-md text-sm font-medium transition-colors \".concat(currentView===item.id?'bg-teal-100 text-teal-800':'text-slate-700 hover:bg-slate-200'),children:[item.icon,/*#__PURE__*/_jsx(\"span\",{children:item.label})]},item.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 border-t border-slate-200\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-slate-500\",children:[\"UserID: \",userId]})})]});};const PatientDetailHeader=_ref28=>{let{patient,onDeselect,onEdit}=_ref28;const therapyStartDate=useMemo(()=>{if(!patient||!patient.sessions)return\"-\";const firstSession=patient.sessions.filter(s=>{var _s$structuredNotes4;return((_s$structuredNotes4=s.structuredNotes)===null||_s$structuredNotes4===void 0?void 0:_s$structuredNotes4.sitzungsnummer)===1;}).sort((a,b)=>new Date(a.date)-new Date(b.date))[0];return firstSession?new Date(firstSession.date).toLocaleDateString('de-DE'):'-';},[patient]);const conductedHours=useMemo(()=>getHighestSessionNumber(patient===null||patient===void 0?void 0:patient.sessions),[patient]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-1\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-2xl font-semibold text-gray-800\",children:[patient.vorname,\" \",patient.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onEdit,className:\"text-gray-500 hover:text-teal-600 p-1 rounded-full hover:bg-gray-100 transition-colors\",title:\"Stammdaten bearbeiten\",children:/*#__PURE__*/_jsx(Edit3,{})}),/*#__PURE__*/_jsx(\"button\",{onClick:onDeselect,className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(XCircle,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 text-sm text-gray-500 grid grid-cols-2 md:grid-cols-4 gap-x-4 gap-y-1\",children:[\" \",/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold\",children:\"Kasse:\"}),\" \",patient.krankenkasse||'-']}),\" \",/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold\",children:\"Vers.-Nr.:\"}),\" \",patient.versichertennummer||'-']}),\" \",/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold\",children:\"Therapiebeginn:\"}),\" \",therapyStartDate]}),\" \",/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-semibold\",children:\"Stunden:\"}),\" \",conductedHours,\" / \",patient.approvedHours]}),\" \"]})]});};if(isInitialLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen bg-slate-100\",children:/*#__PURE__*/_jsx(DotLottieReact,{src:\"https://lottie.host/db9305b2-bb1c-47b1-9c19-d2d744a378b1/yrWh6LccRW.json\",loop:true,autoplay:true})});}if(!isAuthReady)return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen text-xl font-semibold text-gray-600 bg-slate-100\",children:\"Authentifizierung wird initialisiert...\"});if(!userId){return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-slate-100 flex flex-col justify-center items-center p-4\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-lg shadow-md w-full max-w-md border border-gray-200\",children:[\" \",/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-center text-gray-800 mb-8\",children:isLoginView?\"Login Patientenverwaltung\":\"Registrierung\"}),\" \",authError&&/*#__PURE__*/_jsx(\"p\",{className:\"bg-red-100 text-red-700 p-3 rounded-md mb-4 text-sm\",children:authError}),\" \",/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();handleAuthAction(!isLoginView);},className:\"space-y-6\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"block text-sm font-medium text-gray-700\",children:\"E-Mail Adresse\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",id:\"email\",required:true,value:email,onChange:e=>setEmail(e.target.value),className:inputStd})]}),\" \",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"block text-sm font-medium text-gray-700\",children:\"Passwort\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",id:\"password\",required:true,value:password,onChange:e=>setPassword(e.target.value),className:inputStd})]}),\" \",/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:isAuthLoading,className:\"\".concat(btnPrimary,\" w-full py-2.5 text-base \").concat(isAuthLoading?'opacity-50 cursor-not-allowed':''),children:isAuthLoading?isLoginView?\"Anmelden...\":\"Registrieren...\":isLoginView?\"Anmelden\":\"Registrieren\"}),\" \"]}),\" \",/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setIsLoginView(!isLoginView);setAuthError(null);},className:\"mt-6 text-sm text-teal-600 hover:text-teal-500 text-center w-full\",children:isLoginView?\"Noch kein Konto? Jetzt registrieren.\":\"Bereits registriert? Zum Login.\"}),\" \"]}),\" \"]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"h-screen w-full bg-slate-50 font-sans flex overflow-hidden\",children:[/*#__PURE__*/_jsx(Sidebar,{currentView:mainView,setView:setMainView}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-white border-b border-slate-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mx-auto px-6 py-3 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-800 capitalize\",children:mainView.replace(/_/g,' ').replace('patientenakte','Patientenakte')}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleLogout,className:\"text-gray-500 hover:text-red-600 hover:bg-red-50 p-2 rounded-md text-sm flex items-center transition-colors\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"mr-2 h-4 w-4\"}),\" Logout\"]})]})}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-1 overflow-y-auto p-6 relative\",children:[/*#__PURE__*/_jsx(ConfirmationModal,{isOpen:confirmDeleteState.isOpen,onClose:()=>setConfirmDeleteState({isOpen:false}),onConfirm:confirmDeleteState.onConfirm,title:confirmDeleteState.title,message:confirmDeleteState.message}),/*#__PURE__*/_jsx(Modal,{isOpen:isPatientModalOpen,onClose:()=>setIsPatientModalOpen(false),title:editingPatient?\"Patient bearbeiten\":\"Neuen Patienten anlegen\",children:/*#__PURE__*/_jsx(PatientForm,{patient:editingPatient,onSave:handleSavePatient,onCancel:()=>setIsPatientModalOpen(false)})}),mainView==='profile'&&/*#__PURE__*/_jsx(Profile,{initialProfile:profile,onSave:handleSaveProfile,onUploadFile:handleUploadFile,isUploading:isUploading}),mainView==='abrechnung'&&/*#__PURE__*/_jsx(Billing,{unbilledAppointments:unbilledAppointments,isLoading:isLoadingAppointments,onStartBilling:handleStartBilling,onStartManualBilling:()=>setIsManualBillingSetupOpen(true)}),mainView==='patients'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-semibold text-gray-800\",children:\"Patienten\\xFCbersicht\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 bg-gray-200 p-1 rounded-lg\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('grid'),className:\"p-1.5 rounded-md \".concat(viewMode==='grid'?'bg-white shadow':'text-gray-500 hover:bg-white/50'),title:\"Rasteransicht\",children:/*#__PURE__*/_jsx(LayoutGridIcon,{})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('stack'),className:\"p-1.5 rounded-md \".concat(viewMode==='stack'?'bg-white shadow':'text-gray-500 hover:bg-white/50'),title:\"Stapelansicht\",children:/*#__PURE__*/_jsx(LayersIcon,{})})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setEditingPatient(null);setIsPatientModalOpen(true);},className:btnPrimary,children:[/*#__PURE__*/_jsx(UserPlus,{className:\"w-5 h-5 mr-2\"}),\" Patient hinzuf\\xFCgen\"]})]})]}),viewMode==='grid'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\",children:[isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"col-span-full text-center py-10 text-gray-500\",children:\"Lade Patienten...\"}),!isLoading&&sortedPatients.map(patient=>{var _patient$diagnoses$;return/*#__PURE__*/_jsxs(motion.div,{layoutId:patient.id,onClick:()=>handlePatientSelectPreview(patient),className:\"bg-white rounded-lg shadow-md cursor-pointer hover:shadow-xl transition-shadow duration-300\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b-4 border-teal-500\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-bold text-gray-800 truncate\",children:[patient.name,\", \",patient.vorname]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 font-mono\",children:patient.chiffre})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 text-xs text-gray-600\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Diagnose:\"}),\" \",patient.diagnoses&&((_patient$diagnoses$=patient.diagnoses[0])===null||_patient$diagnoses$===void 0?void 0:_patient$diagnoses$.split(':')[0])||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Stunden:\"}),\" \",getHighestSessionNumber(patient.sessions),\" / \",patient.approvedHours||'N/A']})]})]},patient.id);})]}),viewMode==='stack'&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-5xl mx-auto flex flex-col items-center pt-8 pb-8\",children:[isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-center py-10 text-gray-500\",children:\"Lade Patienten...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full relative\",style:{height:\"\".concat(totalHeight,\"px\"),transition:'height 0.4s ease-in-out'},children:/*#__PURE__*/_jsx(AnimatePresence,{children:sortedPatients.map((patient,index)=>{var _patient$sessions;const isSelected=selectedId===patient.id;const tabColors=[\"bg-blue-100 text-blue-800 border-blue-200\",\"bg-orange-100 text-orange-800 border-orange-200\",\"bg-teal-100 text-teal-800 border-teal-200\",\"bg-purple-100 text-purple-800 border-purple-200\",\"bg-yellow-100 text-yellow-800 border-yellow-200\"];const tabColor=tabColors[index%tabColors.length];let bottomPos=index*visibleHeight;if(selectedIndex!==-1&&index>selectedIndex){bottomPos+=expandedHeight-compactHeight;}return/*#__PURE__*/_jsx(motion.div,{layoutId:patient.id,className:\"absolute w-full cursor-pointer\",style:{height:isSelected?expandedHeight:compactHeight},animate:{bottom:bottomPos,zIndex:isSelected?20:sortedPatients.length-index},transition:{type:'spring',stiffness:400,damping:35},onClick:()=>handlePatientSelectPreview(patient),whileHover:!isSelected?{y:-10,scale:1.02}:{},children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full h-full rounded-lg transition-shadow duration-300 \".concat(isSelected?'shadow-2xl':'shadow-md hover:shadow-xl'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute h-10 px-4 flex items-center font-medium rounded-t-lg border-t border-x transition-colors \".concat(isSelected?'bg-white':tabColor),style:{left:\"\".concat(5+index%6*12,\"%\"),top:'-1px'},children:patient.name}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-b-lg rounded-tr-lg border w-full h-full pt-10 overflow-hidden\",children:isSelected&&selectedPatient?/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 overflow-y-auto h-full\",children:[/*#__PURE__*/_jsx(PatientDetailHeader,{patient:selectedPatient,onDeselect:()=>handlePatientSelectPreview(patient),onEdit:()=>{setEditingPatient(selectedPatient);setIsPatientModalOpen(true);}}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-4 mt-4\",children:/*#__PURE__*/_jsx(PatientOverviewTab,{patient:selectedPatient,nextAppointment:nextAppointment,onUpdateHomeworkStatus:handleUpdateHomeworkStatus,onUpdateQuickNote:handleUpdateQuickNote})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setMainView('patientenakte');},className:\"bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-lg shadow-sm\",children:\"Vollst\\xE4ndige Akte bearbeiten\"})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 h-full\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-semibold text-lg text-gray-900 pt-2\",children:[patient.vorname,\" \",patient.name]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 font-mono\",children:patient.chiffre}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-xs text-gray-600\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Sitzungen: \",((_patient$sessions=patient.sessions)===null||_patient$sessions===void 0?void 0:_patient$sessions.length)||0]})})]})})]})},patient.id);})})})]})]}),mainView==='patientenakte'&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full\",children:!selectedPatient?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-20\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Bitte w\\xE4hlen Sie einen Patienten aus der \\xDCbersicht aus.\"})}):/*#__PURE__*/_jsxs(\"div\",{ref:detailViewRef,className:\"bg-white border border-gray-200 shadow-sm rounded-lg p-6 h-full flex flex-col\",children:[/*#__PURE__*/_jsx(PatientDetailHeader,{patient:selectedPatient,onDeselect:()=>{setMainView('patients');setSelectedPatient(null);},onEdit:()=>{setEditingPatient(selectedPatient);setIsPatientModalOpen(true);}}),/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200 mb-6\",children:/*#__PURE__*/_jsx(\"nav\",{className:\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto\",\"aria-label\":\"Tabs\",children:['Übersicht','Diagnosen','Abrechnung','Krankheitsmodell','Diagnostik','Assistenz'].map(tab=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveDetailTab(tab.toLowerCase()),className:\"capitalize whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm \".concat(activeDetailTab===tab.toLowerCase()?'border-teal-500 text-teal-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:tab},tab))})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow overflow-y-auto pr-4 -mr-4\",children:[activeDetailTab==='übersicht'&&/*#__PURE__*/_jsx(PatientOverviewTab,{patient:selectedPatient,nextAppointment:nextAppointment,onUpdateHomeworkStatus:handleUpdateHomeworkStatus,onUpdateQuickNote:handleUpdateQuickNote}),activeDetailTab==='diagnosen'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-semibold text-gray-700 mb-3\",children:\"ICD-10 F-Diagnosen\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-4 bg-gray-50 rounded-md border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newDiagnosisCode\",className:\"block text-xs font-medium text-gray-700\",children:\"Code (z.B. F32.2)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newDiagnosisCode\",value:newDiagnosisCode,onChange:e=>setNewDiagnosisCode(e.target.value.toUpperCase()),placeholder:\"F-Code\",className:\"\".concat(inputStd,\" mt-1\")})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newDiagnosisSicherheit\",className:\"block text-xs font-medium text-gray-700\",children:\"Sicherheit\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"newDiagnosisSicherheit\",value:newDiagnosisSicherheit,onChange:e=>setNewDiagnosisSicherheit(e.target.value),className:\"\".concat(inputStd,\" mt-1\"),children:[/*#__PURE__*/_jsx(\"option\",{value:\"G\",children:\"G (Gesichert)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"V\",children:\"V (Verdacht auf)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"A\",children:\"A (Ausschluss)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ZN\",children:\"ZN (Zustand nach)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newDiagnosisName\",className:\"block text-xs font-medium text-gray-700\",children:\"Manuelle Beschreibung (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newDiagnosisName\",value:newDiagnosis,onChange:e=>setNewDiagnosis(e.target.value),placeholder:\"Eigene Beschreibung\",className:\"\".concat(inputStd,\" mt-1\")})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleAddDiagnosis,className:\"\".concat(btnPrimary,\" bg-green-500 hover:bg-green-600 py-2 px-3 h-10 md:self-end\"),children:[/*#__PURE__*/_jsx(PlusCircleIcon,{className:\"w-5 h-5 mr-1\"}),\" Hinzuf\\xFCgen\"]})]}),lookedUpDiagnosisName&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-teal-600 mt-1\",children:[\"Gefunden: \",lookedUpDiagnosisName]})]}),/*#__PURE__*/_jsxs(\"ul\",{className:\"space-y-1 mb-3\",children:[(selectedPatient.diagnoses||[]).map((diagString,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-2 rounded-md\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:diagString}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>showDiagnosisInfo(diagString),className:\"\".concat(btnInfo,\" p-1\"),title:\"Info zu dieser Diagnose abrufen\",children:[/*#__PURE__*/_jsx(FileJson2,{className:\"w-4 h-4 mr-1\"}),\" Info\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRemoveDiagnosis(diagString),className:\"\".concat(btnDanger,\" p-1 text-xs\"),children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})]},index)),(selectedPatient.diagnoses||[]).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Keine Diagnosen erfasst.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-semibold text-gray-700 mb-3\",children:\"ICD-11 Diagnosen\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"space-y-1\",children:[(selectedPatient.diagnoses_icd11||[]).map((diag,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-purple-50 p-2 rounded-md hover:bg-purple-100 cursor-pointer\",onClick:()=>fetchIcd11Details(diag),children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-purple-800\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-mono\",children:diag.code}),\" - \",diag.title]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleRemoveIcd11Diagnosis(diag);},className:\"text-red-500 hover:text-red-700 p-1 text-xs\",title:\"ICD-11 Diagnose entfernen\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]},index)),(selectedPatient.diagnoses_icd11||[]).length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Keine ICD-11 Diagnosen erfasst.\"})]})]})]}),activeDetailTab==='abrechnung'&&/*#__PURE__*/_jsx(AbrechnungsUebersicht,{patient:selectedPatient,availableTests:availableTests,quarterlyAnalysis:quarterlyDiagnostikAnalysis,onEditSession:handleEditSession,onDeleteSession:handleDeleteSession,onAddBillingPeriod:()=>setIsAddBillingPeriodModalOpen(true),onDeleteBillingPeriod:handleDeleteBillingPeriod}),activeDetailTab==='krankheitsmodell'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"krankheitsanamnese\",className:\"block text-lg font-semibold text-gray-700 mb-1\",children:\"Krankheitsanamnese\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"krankheitsanamnese\",name:\"krankheitsanamnese\",rows:\"6\",className:textareaStd,value:editableKrankheitsanamnese,onChange:e=>setEditableKrankheitsanamnese(e.target.value),onBlur:e=>handleKrankheitsmodellChange('krankheitsanamnese',e.target.value),placeholder:\"Hier die Krankheitsanamnese eintragen...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"lebensgeschichte\",className:\"block text-lg font-semibold text-gray-700 mb-1\",children:\"Lebensgeschichte / Biographie\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"lebensgeschichte\",name:\"lebensgeschichte\",rows:\"6\",className:textareaStd,value:editableLebensgeschichte,onChange:e=>setEditableLebensgeschichte(e.target.value),onBlur:e=>handleKrankheitsmodellChange('lebensgeschichte',e.target.value),placeholder:\"Wichtige Aspekte der Lebensgeschichte...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"problemanalyseMakro\",className:\"block text-lg font-semibold text-gray-700 mb-1\",children:\"Problemanalyse auf Makroebene\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"problemanalyseMakro\",name:\"problemanalyseMakro\",rows:\"6\",className:textareaStd,value:editableProblemanalyseMakro,onChange:e=>setEditableProblemanalyseMakro(e.target.value),onBlur:e=>handleKrankheitsmodellChange('problemanalyseMakro',e.target.value),placeholder:\"Analyse der \\xFCbergeordneten Problembereiche...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"therapieplan\",className:\"block text-lg font-semibold text-gray-700 mb-1\",children:\"Therapieplan\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"therapieplan\",name:\"therapieplan\",rows:\"6\",className:textareaStd,value:editableTherapieplan,onChange:e=>setEditableTherapieplan(e.target.value),onBlur:e=>handleKrankheitsmodellChange('therapieplan',e.target.value),placeholder:\"Therapieziele und -ma\\xDFnahmen...\"})]})]}),activeDetailTab==='diagnostik'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200 mb-4\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-6\",\"aria-label\":\"Diagnostik Sub-Tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveDiagnostikSubTab('overview'),className:\"whitespace-nowrap pb-2 px-1 border-b-2 font-medium text-sm \".concat(activeDiagnostikSubTab==='overview'?'border-purple-500 text-purple-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:\"\\xDCbersicht\"}),availableTests.map(test=>{var _selectedPatient;return((_selectedPatient=selectedPatient[\"\".concat(test.id,\"Results\")])===null||_selectedPatient===void 0?void 0:_selectedPatient.filter(t=>t.status!=='pending').length)>0&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveDiagnostikSubTab(test.id),className:\"whitespace-nowrap pb-2 px-1 border-b-2 font-medium text-sm \".concat(activeDiagnostikSubTab===test.id?'border-purple-500 text-purple-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:test.id.toUpperCase()},test.id);})]})}),activeDiagnostikSubTab==='overview'&&/*#__PURE__*/_jsx(DiagnostikZuordnung,{patient:selectedPatient,availableTests:availableTests,testCategories:testCategories,diagnostikTemplates:diagnostikTemplates,onCompleteTest:handleCompletePendingTest,onDeleteTest:handleDeleteTest,onUpdateTestGrund:handleUpdateTestGrund,onAddNewTest:handleAddPendingTest}),activeDiagnostikSubTab==='scl90r'&&/*#__PURE__*/_jsx(SCL90RComponent,{patient:selectedPatient,onDeleteTest:handleDeleteTest}),activeDiagnostikSubTab==='fep2'&&/*#__PURE__*/_jsx(FEP2Component,{patient:selectedPatient,onDeleteTest:handleDeleteTest}),activeDiagnostikSubTab==='bdi2'&&/*#__PURE__*/_jsx(BDI2Component,{patient:selectedPatient,onDeleteTest:handleDeleteTest,bdiCutoffs:bdiCutoffs,bdiAxisTicks:bdiAxisTicks}),activeDiagnostikSubTab==='hscl11'&&/*#__PURE__*/_jsx(HSCL11Component,{patient:selectedPatient,onDeleteTest:handleDeleteTest}),activeDiagnostikSubTab==='gad7'&&/*#__PURE__*/_jsx(GAD7Component,{patient:selectedPatient,onDeleteTest:handleDeleteTest}),activeDiagnostikSubTab==='coreOm'&&/*#__PURE__*/_jsx(CoreOmComponent,{patient:selectedPatient,onDeleteTest:handleDeleteTest}),activeDiagnostikSubTab==='iipc'&&/*#__PURE__*/_jsx(IIPCComponent,{patient:selectedPatient,onDeleteTest:handleDeleteTest})]}),\"                                        \",activeDetailTab==='assistenz'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-4\",children:\"Therapeutische Assistenz\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleTherapeutischeAssistenzAnfordern,disabled:isLoadingTherapeutischeAssistenz,className:\"\".concat(btnPrimary,\" bg-purple-600 hover:bg-purple-700 mb-4 flex items-center\"),children:[/*#__PURE__*/_jsx(WandSparkles,{className:\"mr-2 h-5 w-5\"}),isLoadingTherapeutischeAssistenz?\"Analysiere Daten...\":\"Expertenfeedback anfordern\"]}),isLoadingTherapeutischeAssistenz&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-700 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 text-gray-600\",children:\"Bitte warten, die KI analysiert die Patientendaten...\"})]}),assistenzError&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold\",children:\"Fehler bei der Assistenz\"}),/*#__PURE__*/_jsx(\"p\",{children:assistenzError})]}),therapeutischeAssistenzOutput&&!isLoadingTherapeutischeAssistenz&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 bg-gray-50 rounded-md border\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-semibold text-gray-800 mb-2\",children:\"Vorschl\\xE4ge des Expertenteams:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"whitespace-pre-wrap text-sm text-gray-700 leading-relaxed\",children:therapeutischeAssistenzOutput})]})]})]})]})}),mainView==='kalender'&&/*#__PURE__*/_jsxs(\"div\",{children:[\" \",/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-semibold text-gray-800 mb-4\",children:\"Terminkalender\"}),\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 relative min-h-[600px]\",children:[\" \",isCalendarLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 flex flex-col items-center justify-center bg-slate-50 z-10\",children:[\" \",/*#__PURE__*/_jsx(DotLottieReact,{src:\"https://lottie.host/5a99e4b7-42e6-47ae-9706-1e931f930492/HSS5faWD7S.lottie\",loop:true,autoplay:true,style:{width:300,height:300}}),\" \",/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 -mt-8\",children:\"Kalender wird geladen...\"}),\" \"]}),\" \",/*#__PURE__*/_jsx(\"iframe\",{title:\"Google Calendar\",src:\"https://calendar.google.com/calendar/embed?src=julisycomorepsy%40gmail.com&ctz=Europe%2FBerlin\",style:{border:0},width:\"100%\",height:\"600\",frameBorder:\"0\",scrolling:\"no\",className:\"transition-opacity duration-500 \".concat(isCalendarLoading?'opacity-0':'opacity-100')}),\" \"]}),\" \"]}),mainView==='formulare'&&/*#__PURE__*/_jsx(PtvFormGenerator,{patients:sortedPatients,therapistProfile:profile}),mainView==='ebm'&&/*#__PURE__*/_jsx(EBMBrowser,{}),mainView==='ebm_templates'&&/*#__PURE__*/_jsx(EbmTemplates,{templates:ebmTemplates,ebmData:ebmData,onSave:handleSaveEbmTemplate,onDelete:handleDeleteEbmTemplate}),mainView==='diagnostik'&&/*#__PURE__*/_jsx(DiagnostikHauptseite,{availableTests:availableTests,testCategories:testCategories,diagnostikTemplates:diagnostikTemplates,onAddTest:handleOpenZentraleTestModal,onAddTemplate:handleOpenTemplateModal,onAddTemplateDefinition:()=>{setEditingTemplate(null);setTemplateEditModalOpen(true);},onEditTemplateDefinition:template=>{setEditingTemplate(template);setTemplateEditModalOpen(true);},onDeleteTemplateDefinition:handleDeleteDiagnostikTemplate}),mainView==='icd11'&&/*#__PURE__*/_jsx(ICD11ECTBrowser,{patients:patients,selectedPatient:selectedPatient,onAssignDiagnosis:handleAssignIcd11Diagnosis}),mainView==='methoden'&&/*#__PURE__*/_jsx(Behandlungsmethoden,{})]})]}),/*#__PURE__*/_jsxs(Modal,{isOpen:diagnosisInfo.isOpen,onClose:()=>setDiagnosisInfo(prev=>_objectSpread(_objectSpread({},prev),{},{isOpen:false})),title:\"Diagnose-Info: \".concat(diagnosisInfo.code||''),size:\"3xl\",children:[diagnosisInfo.isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-center py-4\",children:\"Informationen werden geladen...\"}),diagnosisInfo.error&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-red-600 bg-red-100 p-3 rounded-md\",children:[\"Fehler: \",diagnosisInfo.error]}),!diagnosisInfo.isLoading&&diagnosisInfo.source==='local'&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-700 leading-relaxed p-2 space-y-3\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-teal-700\",children:[diagnosisInfo.name,/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500 text-base ml-2\",children:[\"(\",diagnosisInfo.code,\")\"]})]}),diagnosisInfo.beschreibung&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Beschreibung:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap\",children:diagnosisInfo.beschreibung})]}),((_diagnosisInfo$inkl=diagnosisInfo.inkl)===null||_diagnosisInfo$inkl===void 0?void 0:_diagnosisInfo$inkl.length)>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Inklusive:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside\",children:diagnosisInfo.inkl.map((item,idx)=>/*#__PURE__*/_jsx(\"li\",{children:item},idx))})]}),((_diagnosisInfo$exkl=diagnosisInfo.exkl)===null||_diagnosisInfo$exkl===void 0?void 0:_diagnosisInfo$exkl.length)>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Exklusive:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside\",children:diagnosisInfo.exkl.map((item,idx)=>/*#__PURE__*/_jsx(\"li\",{children:item},idx))})]})]}),!diagnosisInfo.isLoading&&diagnosisInfo.source==='api_detail'&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-700 leading-relaxed p-2 space-y-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-purple-700\",children:[diagnosisInfo.name,/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500 text-base ml-2 font-mono\",children:[\"(\",diagnosisInfo.code,\")\"]})]}),diagnosisInfo.beschreibung&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Beschreibung (Definition):\"}),/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap bg-gray-50 p-2 rounded-md\",children:diagnosisInfo.beschreibung})]}),((_diagnosisInfo$inclus=diagnosisInfo.inclusions)===null||_diagnosisInfo$inclus===void 0?void 0:_diagnosisInfo$inclus.length)>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Inklusive:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside pl-2 space-y-1\",children:diagnosisInfo.inclusions.map((item,idx)=>/*#__PURE__*/_jsx(\"li\",{children:item.label['@value']},idx))})]}),((_diagnosisInfo$exclus=diagnosisInfo.exclusions)===null||_diagnosisInfo$exclus===void 0?void 0:_diagnosisInfo$exclus.length)>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-medium text-gray-800 block mb-1\",children:\"Exklusive:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside pl-2 space-y-1\",children:diagnosisInfo.exclusions.map((item,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[item.label['@value'],item.foundationReference&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-400 ml-2\",children:[\"(\",item.foundationReference.split('/').pop(),\")\"]})]},idx))})]})]})]}),/*#__PURE__*/_jsxs(Modal,{isOpen:improvementState.isOpen,onClose:()=>setImprovementState(_objectSpread(_objectSpread({},improvementState),{},{isOpen:false})),title:\"Sitzungsdokumentation verbessern\",size:\"5xl\",children:[improvementState.error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 bg-red-100 p-3 rounded-md mb-4\",children:improvementState.error}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-lg text-gray-700 mb-2\",children:\"Original\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"text-sm bg-gray-100 p-3 rounded-md whitespace-pre-wrap font-sans h-96 overflow-y-auto border\",children:improvementState.originalText})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-lg text-gray-700 mb-2\",children:\"Vorschlag\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"text-sm bg-gray-800 text-green-300 font-mono p-3 rounded-md whitespace-pre-wrap h-96 overflow-y-auto\",children:improvementState.improvedText})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-4 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setImprovementState(_objectSpread(_objectSpread({},improvementState),{},{isOpen:false})),className:\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300\",children:\"Abbrechen\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleAcceptImprovement,className:\"\".concat(btnPrimary,\" flex items-center\"),children:[/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 mr-2\"}),\" Original ersetzen\"]})]})]}),appError&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed bottom-4 right-4 p-4 max-w-sm text-sm text-red-700 bg-red-100 border border-red-400 rounded-md shadow-lg z-[100]\",children:[appError,/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAppError(null),className:\"ml-4 mt-2 sm:mt-0 sm:ml-2 px-2 py-1 text-red-900 underline rounded-md hover:bg-red-200 text-xs\",children:\"Ok\"})]}),/*#__PURE__*/_jsx(ManualBillingSetupModal,{isOpen:isManualBillingSetupOpen,onClose:()=>setIsManualBillingSetupOpen(false),patients:sortedPatients,onStart:handleStartManualBilling}),/*#__PURE__*/_jsx(AddBillingPeriodModal,{isOpen:isAddBillingPeriodModalOpen,onClose:()=>setIsAddBillingPeriodModalOpen(false),onSave:handleSaveBillingPeriod,patient:selectedPatient}),/*#__PURE__*/_jsx(AddTestTemplateModal,{isOpen:isAddTemplateModalOpen,onClose:()=>setIsAddTemplateModalOpen(false),onSave:handleSaveTestTemplate,template:currentTemplate,patients:sortedPatients,availableTests:availableTests}),/*#__PURE__*/_jsx(AddOrEditTemplateModal,{isOpen:isTemplateEditModalOpen,onClose:()=>setTemplateEditModalOpen(false),onSave:handleSaveDiagnostikTemplate,availableTests:availableTests,editingTemplate:editingTemplate}),billingModalState.isOpen&&/*#__PURE__*/_jsx(Modal,{isOpen:billingModalState.isOpen,onClose:()=>setBillingModalState({isOpen:false,event:null,isEditing:false}),title:billingModalState.isEditing?\"Sitzung bearbeiten\":\"Termin abrechnen: \".concat(billingModalState.event.summary),size:\"4xl\",children:/*#__PURE__*/_jsx(BillingModal,{event:billingModalState.event,ebmData:ebmData,onSave:data=>handleSaveBilling(data,billingModalState.isEditing),onClose:()=>setBillingModalState({isOpen:false,event:null,isEditing:false}),generateGeminiText:generateGeminiText,isEditing:billingModalState.isEditing,ebmTemplates:ebmTemplates})}),/*#__PURE__*/_jsx(ZentraleTestErfassungModal,{isOpen:isZentraleTestModalOpen,onClose:()=>{setIsZentraleTestModalOpen(false);setTestToUpdate(null);},onSave:handleSaveCompletedTest,onUpdate:handleUpdateTest,testInfo:currentTestToErfassen,testToUpdate:testToUpdate,patients:sortedPatients,activePatient:selectedPatient})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useMemo","initializeApp","getAuth","onAuthStateChanged","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","getFirestore","collection","doc","addDoc","getDocs","setDoc","deleteDoc","onSnapshot","query","writeBatch","updateDoc","getStorage","ref","uploadBytes","getDownloadURL","motion","AnimatePresence","DotLottieReact","SCL90RComponent","FEP2Component","BDI2Component","HSCL11Component","GAD7Component","CoreOmComponent","IIPCComponent","ICD11ECTBrowser","EBMBrowser","BillingModal","AbrechnungsUebersicht","DiagnostikZuordnung","ManualBillingSetupModal","AddBillingPeriodModal","Profile","Billing","PtvFormGenerator","Behandlungsmethoden","EbmTemplates","DiagnostikHauptseite","ZentraleTestErfassungModal","AddTestTemplateModal","AddOrEditTemplateModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserPlus","_ref","className","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","children","d","cx","cy","r","x1","x2","y1","y2","Edit3","_ref2","Trash2","_ref3","points","PlusCircleIcon","_ref4","XCircle","_ref5","Save","_ref6","AlertTriangle","_ref7","FileJson2","_ref8","WandSparkles","_ref9","LogOut","_ref0","BookOpen","_ref1","Users","_ref10","FileText","_ref11","List","_ref12","CalendarIcon","_ref13","x","y","width","height","rx","ry","PaperclipIcon","_ref14","SettingsIcon","_ref15","DollarSignIcon","_ref16","LayoutGridIcon","_ref17","LayersIcon","_ref18","ClipboardListIcon","_ref19","BeakerIcon","_ref20","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","app","auth","db","storage","firestoreAppId","homeworkFailureReasons","availableTests","id","name","ebm","recommendation","testCategories","tests","availableTherapeuticMethods","initialPatientsData","geburtsdatum","chiffre","therapeuticMethods","approvedHours","krankenkasse","versichertennummer","diagnoses","sessions","concat","Date","now","date","structuredNotes","sitzungsnummer","thema","patientenbericht","hscl11Results","bdi2Results","fep2Results","scl90rResults","gad7Results","coreOmResults","iipcResults","billingPeriods","krankheitsanamnese","lebensgeschichte","problemanalyseMakro","therapieplan","DIAGNOSTIK_PUNKTE","getQuarter","month","getMonth","year","getFullYear","quarter","Math","floor","useQuarterlyDiagnostikAnalysis","patient","testsByQuarter","forEach","testDef","results","result","status","quarterKey","push","_objectSpread","analysis","age","calculateAge","pointsLimit","testsInQuarter","pointsUsed","reduce","sum","test","Modal","_ref21","isOpen","onClose","title","size","sizeClasses","sm","md","lg","xl","onClick","ConfirmationModal","_ref22","onConfirm","message","PatientForm","_ref23","onSave","onCancel","formData","setFormData","vorname","adresse","email","telefon","newMethod","setNewMethod","firstLetter","charAt","toUpperCase","day","split","yy","slice","newChiffre","prev","e","console","error","handleChange","value","type","target","parseInt","handleAddMethod","includes","handleRemoveMethod","methodToRemove","filter","m","handleSubmit","preventDefault","inputStd","btnPrimary","onSubmit","htmlFor","onChange","required","readOnly","map","method","min","generateGeminiText","prompt","chatHistory","role","parts","text","payload","contents","GEMINI_API_KEY","apiUrl","response","fetch","headers","body","JSON","stringify","ok","_errorData$error","errorData","json","errorMessage","Error","candidates","length","content","finishReason","warn","birthdate","birthDate","today","getDate","PatientOverviewTab","_ref24","nextAppointment","onUpdateHomeworkStatus","onUpdateQuickNote","openHomeworkSession","find","s","homeworkStatus","some","task","done","reasonCategoryColors","Motivational","Emotional","Kognitive","Psychopathologisch","getCategoryForReason","reason","category","isLoading","rows","placeholder","defaultValue","quickNote","onBlur","toLocaleDateString","index","checked","Object","entries","_ref25","reasons","label","App","_diagnosisInfo$inkl","_diagnosisInfo$exkl","_diagnosisInfo$inclus","_diagnosisInfo$exclus","mainView","setMainView","patients","setPatients","selectedPatient","setSelectedPatient","setIsLoading","isInitialLoading","setIsInitialLoading","authError","setAuthError","appError","setAppError","userId","setUserId","isAuthReady","setIsAuthReady","setEmail","password","setPassword","isLoginView","setIsLoginView","isAuthLoading","setIsAuthLoading","isPatientModalOpen","setIsPatientModalOpen","editingPatient","setEditingPatient","newDiagnosis","setNewDiagnosis","newDiagnosisCode","setNewDiagnosisCode","newDiagnosisSicherheit","setNewDiagnosisSicherheit","lookedUpDiagnosisName","setLookedUpDiagnosisName","activeDetailTab","setActiveDetailTab","activeDiagnostikSubTab","setActiveDiagnostikSubTab","diagnosisInfo","setDiagnosisInfo","code","beschreibung","inkl","exkl","hinweise","zusatz_info_code","sicherheit","source","localIcd10Data","setLocalIcd10Data","editableKrankheitsanamnese","setEditableKrankheitsanamnese","editableLebensgeschichte","setEditableLebensgeschichte","editableProblemanalyseMakro","setEditableProblemanalyseMakro","editableTherapieplan","setEditableTherapieplan","therapeutischeAssistenzOutput","setTherapeutischeAssistenzOutput","isLoadingTherapeutischeAssistenz","setIsLoadingTherapeutischeAssistenz","assistenzError","setAssistenzError","detailViewRef","improvementState","setImprovementState","originalText","improvedText","sessionIndex","sortConfig","key","direction","setNextAppointment","unbilledAppointments","setUnbilledAppointments","isLoadingAppointments","setIsLoadingAppointments","billingModalState","setBillingModalState","event","isEditing","ebmData","setEbmData","isManualBillingSetupOpen","setIsManualBillingSetupOpen","confirmDeleteState","setConfirmDeleteState","profile","setProfile","isUploading","setIsUploading","selectedId","setSelectedId","isCalendarLoading","setIsCalendarLoading","viewMode","setViewMode","isAddBillingPeriodModalOpen","setIsAddBillingPeriodModalOpen","ebmTemplates","setEbmTemplates","isZentraleTestModalOpen","setIsZentraleTestModalOpen","currentTestToErfassen","setCurrentTestToErfassen","testToUpdate","setTestToUpdate","diagnostikTemplates","setDiagnostikTemplates","isAddTemplateModalOpen","setIsAddTemplateModalOpen","currentTemplate","setCurrentTemplate","editingTemplate","setEditingTemplate","isTemplateEditModalOpen","setTemplateEditModalOpen","quarterlyDiagnostikAnalysis","sortedPatients","sortablePatients","sort","a","b","valA","valB","handlePatientSelectPreview","getHighestSessionNumber","sessionNumbers","_s$structuredNotes","n","isNaN","max","handleStartManualBilling","patientId","sessionNumber","p","finalSessionNumber","manualNumber","Number","syntheticEvent","summary","start","dateTime","toISOString","isManual","handleStartBilling","fetchNextAppointment","startDate","endDate","end","dateOptions","timeOptions","hour","minute","formattedDate","formattedStartTime","toLocaleTimeString","formattedEndTime","getPatientsCollectionPath","getProfileDocPath","getEbmTemplatesCollectionPath","getDiagnostikTemplatesCollectionPath","findIcd10CodeLocal","codeToFind","upperCodeToFind","found","baseCode","replace","possibleCategoryCode","keys","startsWith","code_kategorie","_event$summary","chiffreMatch","match","targetPatient","nextSessionNumber","highestSession","eventWithSessionNumber","handleEditSession","session","_session$structuredNo","_session$structuredNo2","initialNotes","initialEbm","ebmEntries","handleDeleteSession","sessionId","performDelete","updatedSessions","patientRef","merge","handleSaveBilling","billingData","eventId","eventStart","notes","newSession","hausaufgaben","trim","taskText","err","handleSaveBillingPeriod","periodData","newPeriod","updatedPatientData","newPeriodDateStr","resultKey","testResults","updatedResults","res","testDateStr","billingPeriodId","handleDeleteBillingPeriod","periodId","window","confirm","updatedTestResults","updatedPeriods","updatedPatient","handleAddPendingTest","newTestResult","testInstanceId","testGrund","updatedTestList","alert","handleSaveCompletedTest","testData","testId","updatedTestResultsList","handleCompletePendingTest","testToComplete","testInfo","t","testType","handleUpdateTest","newResults","newDate","handleSaveTestTemplate","template","testIds","updates","timestamp","dateISO","handleUpdateTestGrund","newGrund","handleDeleteTest","originalPatient","handleSaveDiagnostikTemplate","templateData","collectionPath","dataToSave","handleDeleteDiagnostikTemplate","templateId","handleUpdateHomeworkStatus","homeworkIndex","newStatus","parse","sessionToUpdate","assign","handleUpdateQuickNote","note","handleSaveEbmTemplate","handleDeleteEbmTemplate","handleOpenZentraleTestModal","handleOpenTemplateModal","timer","setTimeout","clearTimeout","then","catch","calendarEvents","Array","isArray","billedEventIds","Set","add","unbilled","_event$summary2","has","finally","data","indexedData","item","current","scrollIntoView","behavior","block","unsubscribe","user","uid","seedInitialData","patientsCollection","querySnapshot","empty","batch","patientData","newPatientRef","set","diagnoses_icd11","commit","unsubscribes","paths","path","setter","process","docs","localeCompare","isDoc","_ref26","docSnap","exists","snapshot","unsub","currentPatientDataFromList","loadIcd10Data","bdiCutoffs","color","bdiAxisTicks","handleAuthAction","isRegistering","handleLogout","handleSavePatient","handleAddDiagnosis","codeToAdd","sicherheitPrefix","diagnosisString","updatedDiagnoses","handleRemoveDiagnosis","diagnosisStringToRemove","handleKrankheitsmodellChange","fieldName","handleTherapeutischeAssistenzAnfordern","conductedHours","patientenDatenText","i","_s$structuredNotes2","_s$structuredNotes3","join","systemPrompt","assistenz","showDiagnosisInfo","sicherheitMatch","codeAndName","substring","codeMatch","localData","beschreibung_kategorie","fetchIcd11Details","diagnosis","uri","_fullData$title","_fullData$definition","encodeURIComponent","fullData","definition","diagnosticCriteria","inclusions","inclusion","exclusions","exclusion","handleAssignIcd11Diagnosis","icd11Entity","selectedText","linearizationUri","foundationUri","handleRemoveIcd11Diagnosis","diagnosisToRemove","handleAcceptImprovement","handleSaveProfile","profileData","profileDocRef","handleUploadFile","file","storageRef","downloadURL","btnDanger","btnInfo","textareaStd","selectedIndex","findIndex","compactHeight","expandedHeight","overlap","visibleHeight","totalHeight","Sidebar","_ref27","currentView","setView","navItems","icon","PatientDetailHeader","_ref28","onDeselect","onEdit","therapyStartDate","firstSession","_s$structuredNotes4","src","loop","autoplay","disabled","initialProfile","onUploadFile","onStartBilling","onStartManualBilling","_patient$diagnoses$","div","layoutId","style","transition","_patient$sessions","isSelected","tabColors","tabColor","bottomPos","animate","bottom","zIndex","stiffness","damping","whileHover","scale","left","top","stopPropagation","tab","toLowerCase","diagString","diag","quarterlyAnalysis","onEditSession","onDeleteSession","onAddBillingPeriod","onDeleteBillingPeriod","_selectedPatient","onCompleteTest","onDeleteTest","onUpdateTestGrund","onAddNewTest","border","frameBorder","scrolling","therapistProfile","templates","onDelete","onAddTest","onAddTemplate","onAddTemplateDefinition","onEditTemplateDefinition","onDeleteTemplateDefinition","onAssignDiagnosis","idx","foundationReference","pop","onStart","onUpdate","activePatient"],"sources":["/Users/julianrogowski/Documents/Visual Code/patientenverwaltung-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport {\n    getAuth,\n    onAuthStateChanged,\n    createUserWithEmailAndPassword,\n    signInWithEmailAndPassword,\n    signOut\n} from 'firebase/auth';\nimport { getFirestore, collection, doc, addDoc, getDocs, setDoc, deleteDoc, onSnapshot, query, writeBatch, updateDoc } from 'firebase/firestore';\nimport { getStorage, ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { DotLottieReact } from '@lottiefiles/dotlottie-react';\n\n// Components\nimport SCL90RComponent from './psychodiagnostic/SCL90R.js';\nimport FEP2Component from './psychodiagnostic/FEP2.js';\nimport BDI2Component from './psychodiagnostic/BDI2.js';\nimport HSCL11Component from './psychodiagnostic/HSCL11.js';\nimport GAD7Component from './psychodiagnostic/GAD7.js';\nimport CoreOmComponent from './psychodiagnostic/CoreOm.js';\nimport IIPCComponent from './psychodiagnostic/IIP-C.js';\nimport ICD11ECTBrowser from './components/ICD11ECTBrowser.js';\nimport EBMBrowser from './components/EBMBrowser.js';\nimport BillingModal from './components/SitzungsAbrechnung.js';\nimport AbrechnungsUebersicht from './components/PatientenTabs/Abrechnung.js';\nimport DiagnostikZuordnung from './components/DiagnostikZuordnung.js';\nimport ManualBillingSetupModal from './components/ManualBillingSetupModal.js';\nimport AddBillingPeriodModal from './components/AddBillingPeriodModal.js';\nimport Profile from './components/Profile.js';\nimport Billing from './components/Billing.js';\nimport PtvFormGenerator from './formulare/PtvFormGenerator.js';\nimport Behandlungsmethoden from './components/Behandlungsmethoden.js';\nimport EbmTemplates from './components/EbmTemplates.js';\nimport DiagnostikHauptseite from './components/DiagnostikHauptseite.js';\nimport ZentraleTestErfassungModal from './components/ZentraleTestErfassungModal.js';\nimport AddTestTemplateModal from './components/AddTestTemplateModal.js';\nimport AddOrEditTemplateModal from './components/AddOrEditTemplateModal.js';\n\n\n// --- ICONS ---\nconst UserPlus = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" /><circle cx=\"9\" cy=\"7\" r=\"4\" /><line x1=\"19\" x2=\"19\" y1=\"8\" y2=\"14\" /><line x1=\"22\" x2=\"16\" y1=\"11\" y2=\"11\" /></svg>);\nconst Edit3 = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M12 20h9\" /><path d=\"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z\" /></svg>);\nconst Trash2 = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><polyline points=\"3 6 5 6 21 6\" /><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" /><line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" /><line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" /></svg>);\nconst PlusCircleIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><circle cx=\"12\" cy=\"12\" r=\"10\" /><line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\" /><line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\" /></svg>);\nconst XCircle = ({ className = \"w-6 h-6\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><circle cx=\"12\" cy=\"12\" r=\"10\" /><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\" /><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\" /></svg>);\nconst Save = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\" /><polyline points=\"17 21 17 13 7 13 7 21\" /><polyline points=\"7 3 7 8 15 8\" /></svg>);\nconst AlertTriangle = ({ className = \"w-12 h-12\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>);\nconst FileJson2 = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4\" /><path d=\"M14 2v6h6\" /><path d=\"M4 12h1.6a2 2 0 0 0 1.9-3.4L6 6\" /><path d=\"M4 18h1.6a2 2 0 0 1 1.9 3.4L6 24\" /><path d=\"M12 12h1.6a2 2 0 0 1 1.9-3.4L14 6\" /><path d=\"M12 18h1.6a2 2 0 0 0 1.9 3.4L14 24\" /></svg>);\nconst WandSparkles = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"m9.5 2.55 1.294 1.294a1 1 0 0 0 1.414 0L13.5 2.55\" /><path d=\"M4.94 4.94 6.22 6.22a1 1 0 0 0 1.41 0l1.29-1.29\" /><path d=\"M2.55 9.51 3.84 10.8a1 1 0 0 0 1.41 0l1.3-1.29\" /><path d=\"m19.07 4.93-1.29 1.29a1 1 0 0 1-1.41 0l-1.29-1.29\" /><path d=\"M21.45 9.51l-1.29 1.29a1 1 0 0 1-1.41 0l-1.3-1.29\" /><path d=\"M14.5 12.94a1 1 0 0 0 0 1.41l1.29 1.29\" /><path d=\"M10.8 17.78a1 1 0 0 0 0 1.41l1.29 1.29\" /><path d=\"M17.78 10.8a1 1 0 0 0 0 1.41l1.29 1.29\" /><path d=\"M12 10.5V4.5\" /><path d=\"M12 10.5C7 11 4 15 4 20\" /><path d=\"M12 10.5c5 .5 8 4.5 8 9.5\" /></svg>);\nconst LogOut = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" /><polyline points=\"16 17 21 12 16 7\" /><line x1=\"21\" y1=\"12\" x2=\"9\" y2=\"12\" /></svg>);\nconst BookOpen = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z\" /><path d=\"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z\" /></svg>);\nconst Users = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" /><circle cx=\"9\" cy=\"7\" r=\"4\" /><path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" /><path d=\"M16 3.13a4 4 0 0 1 0 7.75\" /></svg>);\nconst FileText = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\" /><polyline points=\"14 2 14 8 20 8\" /><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\" /><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\" /><line x1=\"10\" y1=\"9\" x2=\"8\" y2=\"9\" /></svg>);\nconst List = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><line x1=\"8\" x2=\"21\" y1=\"6\" y2=\"6\" /><line x1=\"8\" x2=\"21\" y1=\"12\" y2=\"12\" /><line x1=\"8\" x2=\"21\" y1=\"18\" y2=\"18\" /><line x1=\"3\" x2=\"3.01\" y1=\"6\" y2=\"6\" /><line x1=\"3\" x2=\"3.01\" y1=\"12\" y2=\"12\" /><line x1=\"3\" x2=\"3.01\" y1=\"18\" y2=\"18\" /></svg>);\nconst CalendarIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"></line><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"></line><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"></line></svg>);\nconst PaperclipIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.59a2 2 0 0 1-2.83-2.83l8.49-8.48\" /></svg>);\nconst SettingsIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\" /><circle cx=\"12\" cy=\"12\" r=\"3\" /></svg>);\nconst DollarSignIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\"></line><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"></path></svg>);\nconst LayoutGridIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"></rect><rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"></rect><rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"></rect><rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"></rect></svg>);\nconst LayersIcon = ({ className = \"w-5 h-5\" }) => (<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><polygon points=\"12 2 2 7 12 12 22 7 12 2\"></polygon><polyline points=\"2 17 12 22 22 17\"></polyline><polyline points=\"2 12 12 17 22 12\"></polyline></svg>);\nconst ClipboardListIcon = ({ className = \"w-5 h-5\" }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\" /><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\" /><path d=\"M12 11h4\" /><path d=\"M12 16h4\" /><path d=\"M8 11h.01\" /><path d=\"M8 16h.01\" /></svg>\nconst BeakerIcon = ({ className = \"w-5 h-5\" }) => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className={className}><path d=\"M4.5 3h15\"/><path d=\"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3\"/><path d=\"M6 14h12\"/></svg>;\n\n// Firebase Config\nconst firebaseConfig = {\n    apiKey: \"AIzaSyDZ_qqqKW7WDCZ9botek2VBwXNMQO3JYwU\",\n    authDomain: \"psychotherapie0512.firebaseapp.com\",\n    projectId: \"psychotherapie0512\",\n    storageBucket: \"psychotherapie0512.appspot.com\",\n    messagingSenderId: \"131279046361\",\n    appId: \"1:131279046361:web:e5dd2d18b206fb820b60c8\"\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nconst storage = getStorage(app);\nconst firestoreAppId = 'default-patient-app-v5';\n\n// --- KONSTANTEN ---\nconst homeworkFailureReasons = { \"Motivational\": [\"Geringe Motivation\", \"Zweifel am Nutzen der Hausaufgabe\", \"Keine Einsicht in die Relevanz\"], \"Emotional\": [\"Angst vor Versagen\", \"Scham oder Schuldgefühle\", \"Vermeidung unangenehmer Gefühle\"], \"Kognitive\": [\"Negative automatische Gedanken\", \"Perfektionismus\"], \"Organisatorisch/Praktisch\": [\"Zeitmangel\", \"Vergessen\", \"Keine klaren Anweisungen oder Verständnisprobleme\"], \"Interaktion mit Therapeut\": [\"Widerstand gegen den Therapeuten\", \"Beziehungskonflikte\", \"Mangel an Vertrauen\"], \"Psychopathologisch\": [\"Konzentrationsprobleme\", \"Antriebslosigkeit\", \"Überwältigende Symptome\"] };\nconst availableTests = [\n    { id: 'scl90r', name: 'SCL-90-R - Symptom-Checklist-90-R', ebm: '35601', recommendation: 10 },\n    { id: 'fep2', name: 'FEP-2 - Fragebogen zur Erfassung von Persönlichkeitsstörungen', ebm: '35601', recommendation: 12 },\n    { id: 'bdi2', name: 'BDI-II - Beck-Depressions-Inventar II', ebm: '35600', recommendation: 2 },\n    { id: 'hscl11', name: 'HSCL-11 - Hopkins Symptom Checklist-11', ebm: '35600', recommendation: 1 },\n    { id: 'gad7', name: 'GAD-7 - Generalisierte Angststörung Skala', ebm: '35600', recommendation: 1 },\n    { id: 'coreOm', name: 'CORE-OM - Clinical Outcomes in Routine Evaluation', ebm: '35601', recommendation: 8 },\n    { id: 'iipc', name: 'IIP-C - Inventar Interpersonaler Probleme', ebm: '35601', recommendation: 15 },\n];\n\nconst testCategories = [\n  { name: 'Allgemeine Psychopathologie', tests: ['scl90r', 'hscl11', 'coreOm'] },\n  { name: 'Depressionsdiagnostik', tests: ['bdi2'] },\n  { name: 'Angstdiagnostik', tests: ['gad7'] },\n  { name: 'Persönlichkeitsdiagnostik', tests: ['fep2'] },\n  { name: 'Interpersonelle Probleme', tests: ['iipc'] }\n];\n\nconst availableTherapeuticMethods = [\"Kognitive Verhaltenstherapie (KVT)\", \"Schematherapie\", \"Acceptance and Commitment Therapy (ACT)\", \"Dialektisch-Behaviorale Therapie (DBT)\", \"Eye Movement Desensitization and Reprocessing (EMDR)\", \"Tiefenpsychologisch fundierte Psychotherapie\", \"Systemische Therapie\"];\nconst initialPatientsData = [{ name: \"Mustermann\", geburtsdatum: \"1998-04-04\", chiffre: \"M040498\", therapeuticMethods: [\"Kognitive Verhaltenstherapie (KVT)\"], approvedHours: 60, krankenkasse: \"TK\", versichertennummer: \"A123456789\", diagnoses: [\"[G] F00.0*: Demenz bei Alzheimer-Krankheit, mit frühem Beginn (Typ 2)\", \"[V] F01.1: Multiinfarkt-Demenz\", \"[A] F20.0: Paranoide Schizophrenie\", \"[ZN] F32.1: Mittelgradige depressive Episode\", \"F40.0: Agoraphobie\"], sessions: [{ id: `sess_${Date.now()}`, date: \"2025-05-20\", structuredNotes: { sitzungsnummer: 1, thema: \"Erste Sitzung\", patientenbericht: \"Exploration der Hauptbeschwerden.\" } }], hscl11Results: [], bdi2Results: [], fep2Results: [], scl90rResults: [], gad7Results: [], coreOmResults: [], iipcResults: [], billingPeriods: [], krankheitsanamnese: \"Patient berichtet über seit ca. 2 Jahren zunehmende Vergesslichkeit und Orientierungsprobleme.\", lebensgeschichte: \"Geboren 1955, verheiratet, 2 Kinder, früher als Buchhalter tätig.\", problemanalyseMakro: \"Kognitive Defizite im Vordergrund, affektive Belastung durch erlebten Kontrollverlust.\", therapieplan: \"Supportive Gespräche, kognitives Training, Psychoedukation für Angehörige.\" },];\nconst DIAGNOSTIK_PUNKTE = { '35600': 34, '35601': 39, '35602': 56, };\n\n// --- HILFSFUNKTIONEN & HOOKS ---\n\nconst getQuarter = (date) => {\n    if (!date) return null;\n    const d = new Date(date);\n    const month = d.getMonth();\n    const year = d.getFullYear();\n    const quarter = Math.floor(month / 3) + 1;\n    return `${year}-Q${quarter}`;\n};\n\nconst useQuarterlyDiagnostikAnalysis = (patient, availableTests) => {\n    return useMemo(() => {\n        if (!patient) return {};\n\n        const testsByQuarter = {};\n\n        availableTests.forEach(testDef => {\n            const results = patient[`${testDef.id}Results`] || [];\n            results.forEach(result => {\n                if (result.status === 'completed') {\n                    const quarterKey = getQuarter(result.date);\n                    if (!quarterKey) return;\n\n                    if (!testsByQuarter[quarterKey]) {\n                        testsByQuarter[quarterKey] = [];\n                    }\n                    testsByQuarter[quarterKey].push({\n                        ...testDef,\n                        ...result\n                    });\n                }\n            });\n        });\n\n        const analysis = {};\n        const age = calculateAge(patient.geburtsdatum);\n        const pointsLimit = age < 22 ? 1636 : 1092;\n\n        for (const quarterKey in testsByQuarter) {\n            const testsInQuarter = testsByQuarter[quarterKey];\n            const pointsUsed = testsInQuarter.reduce((sum, test) => sum + (DIAGNOSTIK_PUNKTE[test.ebm] || 0), 0);\n            \n            analysis[quarterKey] = {\n                pointsUsed,\n                pointsLimit,\n                tests: testsInQuarter,\n            };\n        }\n\n        return analysis;\n    }, [patient, availableTests]);\n};\n\nconst Modal = ({ isOpen, onClose, title, children, size = \"lg\" }) => { if (!isOpen) return null; const sizeClasses = { sm: 'max-w-sm', md: 'max-w-md', lg: 'max-w-lg', xl: 'max-w-xl', '2xl': 'max-w-2xl', '3xl': 'max-w-3xl', '4xl': 'max-w-4xl', '5xl': 'max-w-5xl' }; return (<div className=\"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50 p-4\"><div className={`bg-white p-6 rounded-lg shadow-xl w-full ${sizeClasses[size]} max-h-[90vh] overflow-y-auto`}><div className=\"flex justify-between items-center mb-4\"><h2 className=\"text-xl font-semibold text-gray-800\">{title}</h2><button onClick={onClose} className=\"text-gray-400 hover:text-gray-600\"><XCircle className=\"w-7 h-7\" /></button></div>{children}</div></div>); };\nconst ConfirmationModal = ({ isOpen, onClose, onConfirm, title, message }) => { if (!isOpen) return null; return (<Modal isOpen={isOpen} onClose={onClose} title={title} size=\"md\"><div className=\"text-center\"><AlertTriangle className=\"mx-auto mb-4 w-12 h-12 text-red-500\" /><p className=\"text-gray-600 mb-6\">{message}</p><div className=\"flex justify-center space-x-4\"><button onClick={onClose} className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none\">Abbrechen</button><button onClick={onConfirm} className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none\">Bestätigen</button></div></div></Modal>); }; const PatientForm = ({ patient, onSave, onCancel }) => {\n    const [formData, setFormData] = useState(\n        patient || {\n            name: '',\n            vorname: '',\n            chiffre: '',\n            geburtsdatum: '',\n            adresse: '',\n            email: '',\n            telefon: '',\n            krankenkasse: '',\n            versichertennummer: '',\n            therapeuticMethods: [],\n            approvedHours: 0,\n            diagnoses: [],\n            sessions: [],\n            hscl11Results: [],\n            bdi2Results: [],\n            fep2Results: [],\n            scl90rResults: [],\n            gad7Results: [],\n            coreOmResults: [],\n            iipcResults: [],\n            billingPeriods: [],\n            krankheitsanamnese: \"\",\n            lebensgeschichte: \"\",\n            problemanalyseMakro: \"\",\n            therapieplan: \"\"\n        }\n    );\n\n    const [newMethod, setNewMethod] = useState(\"\");\n\n    useEffect(() => {\n        if (patient) {\n            setFormData({\n                ...patient,\n                geburtsdatum: patient.geburtsdatum || '',\n                krankenkasse: patient.krankenkasse || '',\n                versichertennummer: patient.versichertennummer || '',\n                therapeuticMethods: patient.therapeuticMethods || [],\n                hscl11Results: patient.hscl11Results || [],\n                bdi2Results: patient.bdi2Results || [],\n                fep2Results: patient.fep2Results || [],\n                scl90rResults: patient.scl90rResults || [],\n                gad7Results: patient.gad7Results || [],\n                coreOmResults: patient.coreOmResults || [],\n                iipcResults: patient.iipcResults || [],\n                billingPeriods: patient.billingPeriods || [],\n                krankheitsanamnese: patient.krankheitsanamnese || \"\",\n                lebensgeschichte: patient.lebensgeschichte || \"\",\n                problemanalyseMakro: patient.problemanalyseMakro || \"\",\n                therapieplan: patient.therapieplan || \"\"\n            });\n        } else {\n            setFormData({ name: '', vorname: '', chiffre: '', geburtsdatum: '', adresse: '', email: '', telefon: '', krankenkasse: '', versichertennummer: '', therapeuticMethods: [], approvedHours: 0, diagnoses: [], sessions: [], hscl11Results: [], bdi2Results: [], fep2Results: [], scl90rResults: [], gad7Results: [], coreOmResults: [], iipcResults: [], billingPeriods: [], krankheitsanamnese: \"\", lebensgeschichte: \"\", problemanalyseMakro: \"\", therapieplan: \"\" });\n        }\n    }, [patient]);\n\n    useEffect(() => {\n        const { name, geburtsdatum } = formData;\n        if (name && geburtsdatum) {\n            try {\n                const firstLetter = name.charAt(0).toUpperCase();\n                const [year, month, day] = geburtsdatum.split('-');\n                if (year && month && day) { const yy = year.slice(-2); const newChiffre = `${firstLetter}${day}${month}${yy}`; setFormData(prev => ({ ...prev, chiffre: newChiffre })); }\n            } catch (e) { console.error(\"Fehler bei der Chiffre-Generierung\", e); setFormData(prev => ({ ...prev, chiffre: '' })); }\n        } else { if (formData.chiffre !== '') { setFormData(prev => ({ ...prev, chiffre: '' })); } }\n    }, [formData]);\n\n    const handleChange = (e) => { const { name, value, type } = e.target; setFormData((prev) => ({ ...prev, [name]: type === 'number' ? parseInt(value, 10) || 0 : value })); };\n    const handleAddMethod = () => { if (newMethod && !formData.therapeuticMethods.includes(newMethod)) { setFormData(prev => ({ ...prev, therapeuticMethods: [...prev.therapeuticMethods, newMethod] })); setNewMethod(\"\"); } };\n    const handleRemoveMethod = (methodToRemove) => { setFormData(prev => ({ ...prev, therapeuticMethods: prev.therapeuticMethods.filter(m => m !== methodToRemove) })); };\n    const handleSubmit = (e) => { e.preventDefault(); onSave(formData); };\n\n    const inputStd = \"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm\";\n    const btnPrimary = \"px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 flex items-center\";\n\n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div><label htmlFor=\"vorname\" className=\"block text-sm font-medium text-gray-700\">Vorname</label><input type=\"text\" name=\"vorname\" id=\"vorname\" value={formData.vorname} onChange={handleChange} required className={inputStd} /></div>\n                <div><label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700\">Nachname</label><input type=\"text\" name=\"name\" id=\"name\" value={formData.name} onChange={handleChange} required className={inputStd} /></div>\n                <div><label htmlFor=\"geburtsdatum\" className=\"block text-sm font-medium text-gray-700\">Geburtsdatum</label><input type=\"date\" name=\"geburtsdatum\" id=\"geburtsdatum\" value={formData.geburtsdatum} onChange={handleChange} required className={inputStd} /></div>\n                <div><label htmlFor=\"chiffre\" className=\"block text-sm font-medium text-gray-700\">Chiffre</label><input type=\"text\" name=\"chiffre\" id=\"chiffre\" value={formData.chiffre} readOnly className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 sm:text-sm\" /></div>\n            </div>\n            <div><label htmlFor=\"adresse\" className=\"block text-sm font-medium text-gray-700\">Adresse</label><input type=\"text\" name=\"adresse\" id=\"adresse\" value={formData.adresse} onChange={handleChange} className={inputStd} /></div>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div><label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">E-Mail</label><input type=\"email\" name=\"email\" id=\"email\" value={formData.email} onChange={handleChange} className={inputStd} /></div>\n                <div><label htmlFor=\"telefon\" className=\"block text-sm font-medium text-gray-700\">Telefon</label><input type=\"tel\" name=\"telefon\" id=\"telefon\" value={formData.telefon} onChange={handleChange} className={inputStd} /></div>\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div><label htmlFor=\"krankenkasse\" className=\"block text-sm font-medium text-gray-700\">Krankenkasse</label><input type=\"text\" name=\"krankenkasse\" id=\"krankenkasse\" value={formData.krankenkasse} onChange={handleChange} className={inputStd} /></div>\n                <div><label htmlFor=\"versichertennummer\" className=\"block text-sm font-medium text-gray-700\">Versichertennummer</label><input type=\"text\" name=\"versichertennummer\" id=\"versichertennummer\" value={formData.versichertennummer} onChange={handleChange} className={inputStd} /></div>\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700\">Therapieverfahren</label>\n                <div className=\"mt-1 flex flex-wrap gap-2\">{(formData.therapeuticMethods || []).map(method => (<span key={method} className=\"flex items-center bg-teal-100 text-teal-800 text-xs font-medium px-2.5 py-0.5 rounded-full\">{method}<button type=\"button\" onClick={() => handleRemoveMethod(method)} className=\"ml-1.5 text-teal-500 hover:text-teal-700\"><XCircle className=\"h-3 w-3\" /></button></span>))}</div>\n                <div className=\"mt-2 flex items-center gap-2\">\n                    <select value={newMethod} onChange={(e) => setNewMethod(e.target.value)} className={inputStd}><option value=\"\">Verfahren auswählen...</option>{availableTherapeuticMethods.filter(m => !(formData.therapeuticMethods || []).includes(m)).map(m => <option key={m} value={m}>{m}</option>)}</select>\n                    <button type=\"button\" onClick={handleAddMethod} className=\"bg-gray-200 p-2 rounded-md hover:bg-gray-300\"><PlusCircleIcon className=\"h-5 w-5 text-gray-600\" /></button>\n                </div>\n            </div>\n            <div><label htmlFor=\"approvedHours\" className=\"block text-sm font-medium text-gray-700\">Genehmigte Stunden</label><input type=\"number\" name=\"approvedHours\" id=\"approvedHours\" value={formData.approvedHours} onChange={handleChange} min=\"0\" className={inputStd} /></div>\n            <div className=\"flex justify-end space-x-3 pt-4\"><button type=\"button\" onClick={onCancel} className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500\">Abbrechen</button><button type=\"submit\" className={btnPrimary}><Save className=\"w-4 h-4 mr-2\" /> Speichern</button></div>\n        </form>\n    );\n};\nasync function generateGeminiText(prompt) { let chatHistory = [{ role: \"user\", parts: [{ text: prompt }] }]; const payload = { contents: chatHistory }; const GEMINI_API_KEY = \"AIzaSyCWQFze_8cKDZ6W2DTqfqIcvhcsKWfuZLw\"; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`; try { const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }); if (!response.ok) { const errorData = await response.json(); console.error(\"Gemini API error details:\", errorData); const errorMessage = errorData.error?.message || `API request failed with status ${response.status}`; throw new Error(errorMessage); } const result = await response.json(); if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) { return result.candidates[0].content.parts[0].text; } else if (result.candidates && result.candidates.length > 0 && result.candidates[0].finishReason === \"SAFETY\") { console.warn(\"Gemini API response blocked due to safety reasons.\"); return \"Die Antwort wurde aufgrund von Sicherheitsrichtlinien blockiert.\"; } else { console.error(\"Unexpected Gemini API response structure:\", result); throw new Error(\"Unerwartete Antwortstruktur von der API.\"); } } catch (error) { console.error(\"Error calling Gemini API:\", error); throw error; } }\nconst calculateAge = (birthdate) => { if (!birthdate) return 0; const birthDate = new Date(birthdate); const today = new Date(); let age = today.getFullYear() - birthDate.getFullYear(); const m = today.getMonth() - birthDate.getMonth(); if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) { age--; } return age; };\n\nconst PatientOverviewTab = ({ patient, nextAppointment, onUpdateHomeworkStatus, onUpdateQuickNote }) => {\n    // *** KORREKTUR: Hook an den Anfang verschoben ***\n    const openHomeworkSession = useMemo(() => {\n        // Optional Chaining `?.` stellt sicher, dass kein Fehler auftritt, wenn `patient` null ist\n        if (!patient?.sessions) return null;\n        // Die Sitzungen sind bereits absteigend sortiert\n        return patient.sessions.find(s => s.homeworkStatus && s.homeworkStatus.some(task => !task.done));\n    }, [patient?.sessions]);\n\n    // *** KORREKTUR: Bedingter Return NACH allen Hooks ***\n    if (!patient) return null;\n    \n    const reasonCategoryColors = {\n        Motivational: \"bg-orange-100 text-orange-800\",\n        Emotional: \"bg-blue-100 text-blue-800\",\n        Kognitive: \"bg-purple-100 text-purple-800\",\n        \"Organisatorisch/Praktisch\": \"bg-gray-200 text-gray-800\",\n        \"Interaktion mit Therapeut\": \"bg-pink-100 text-pink-800\",\n        Psychopathologisch: \"bg-red-100 text-red-800\",\n    };\n\n    const getCategoryForReason = (reason) => {\n        for (const category in homeworkFailureReasons) {\n            if (homeworkFailureReasons[category].includes(reason)) {\n                return category;\n            }\n        }\n        return null;\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"col-span-1 md:col-span-2 p-3 bg-teal-50 border border-teal-200 rounded-lg\">\n                {nextAppointment.isLoading && <p className=\"text-sm text-teal-700\">Lade nächsten Termin...</p>}\n                {nextAppointment.error && <p className=\"text-sm text-red-600\">{nextAppointment.error}</p>}\n                {nextAppointment.text && <p className=\"text-sm font-semibold text-teal-800\">{nextAppointment.text}</p>}\n            </div>\n\n            <div>\n                 <label htmlFor=\"quick-note\" className=\"text-sm font-semibold text-gray-700\">Kurznotiz</label>\n                 <textarea\n                    id=\"quick-note\"\n                    rows=\"3\"\n                    className=\"mt-1 block w-full text-sm p-2 rounded-md border-red-200 bg-red-50/50 focus:ring-red-500 focus:border-red-500 placeholder-red-400/70\"\n                    placeholder=\"Wichtige Gedanken, nächste Schritte, etc...\"\n                    defaultValue={patient.quickNote || ''}\n                    onBlur={(e) => onUpdateQuickNote(e.target.value)}\n                 />\n            </div>\n\n            <div>\n                <h4 className=\"text-lg font-semibold text-gray-700 mb-3 border-b pb-2\">Stammdaten</h4>\n                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 mt-3 text-sm\">\n                    <div><p className=\"font-semibold text-gray-500\">Nachname</p><p>{patient.name}</p></div>\n                    <div><p className=\"font-semibold text-gray-500\">Vorname</p><p>{patient.vorname}</p></div>\n                    <div><p className=\"font-semibold text-gray-500\">Geburtsdatum</p><p>{new Date(patient.geburtsdatum).toLocaleDateString('de-DE')}</p></div>\n                    <div><p className=\"font-semibold text-gray-500\">Alter</p><p>{calculateAge(patient.geburtsdatum)}</p></div>\n                    <div><p className=\"font-semibold text-gray-500\">E-Mail</p><p>{patient.email || '-'}</p></div>\n                    <div><p className=\"font-semibold text-gray-500\">Telefon</p><p>{patient.telefon || '-'}</p></div>\n                    <div className=\"col-span-2 md:col-span-3\"><p className=\"font-semibold text-gray-500\">Adresse</p><p>{patient.adresse || '-'}</p></div>\n                </div>\n            </div>\n            <div>\n                <h4 className=\"text-lg font-semibold text-gray-700 mb-3 border-b pb-2\">Offene Hausaufgaben</h4>\n                <div className=\"p-3 bg-gray-50 rounded-lg text-sm space-y-3\">\n                    {openHomeworkSession ? (\n                        openHomeworkSession.homeworkStatus.map((task, index) => (\n                            <div key={index} className=\"flex items-start gap-4\">\n                                <input type=\"checkbox\" className=\"h-5 w-5 rounded border-gray-300 text-teal-600 focus:ring-teal-500 mt-0.5\" checked={task.done} onChange={(e) => onUpdateHomeworkStatus(openHomeworkSession.id, index, { done: e.target.checked })} />\n                                <div className=\"flex-grow\">\n                                    <span className={` ${task.done ? 'text-gray-500 line-through' : 'text-gray-800'}`}>{task.text}</span>\n                                    {!task.done && (\n                                        <div className=\"flex items-center gap-2 mt-1\">\n                                             <select className=\"text-xs border-gray-300 rounded-md shadow-sm focus:border-teal-300 focus:ring focus:ring-teal-200 focus:ring-opacity-50\" value={task.reason || ''} onChange={(e) => onUpdateHomeworkStatus(openHomeworkSession.id, index, { reason: e.target.value })}>\n                                                <option value=\"\">Grund wählen...</option>\n                                                {Object.entries(homeworkFailureReasons).map(([category, reasons]) => (\n                                                    <optgroup label={category} key={category}>\n                                                        {reasons.map(reason => <option key={reason} value={reason}>{reason}</option>)}\n                                                    </optgroup>\n                                                ))}\n                                            </select>\n                                            {task.reason && (\n                                                <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${reasonCategoryColors[getCategoryForReason(task.reason)] || 'bg-gray-200'}`}>\n                                                    {getCategoryForReason(task.reason)}\n                                                </span>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n                            </div>\n                        ))\n                    ) : (\n                        <p className=\"text-gray-500\">Alle Hausaufgaben sind erledigt. Sehr gut!</p>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n\nfunction App() {\n    // --- States ---\n    const [mainView, setMainView] = useState('patients');\n    const [patients, setPatients] = useState([]);\n    const [selectedPatient, setSelectedPatient] = useState(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [isInitialLoading, setIsInitialLoading] = useState(true);\n    const [authError, setAuthError] = useState(null);\n    const [appError, setAppError] = useState(null);\n    const [userId, setUserId] = useState(null);\n    const [isAuthReady, setIsAuthReady] = useState(false);\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [isLoginView, setIsLoginView] = useState(true);\n    const [isAuthLoading, setIsAuthLoading] = useState(false);\n    const [isPatientModalOpen, setIsPatientModalOpen] = useState(false);\n    const [editingPatient, setEditingPatient] = useState(null);\n    const [newDiagnosis, setNewDiagnosis] = useState('');\n    const [newDiagnosisCode, setNewDiagnosisCode] = useState('');\n    const [newDiagnosisSicherheit, setNewDiagnosisSicherheit] = useState('G');\n    const [lookedUpDiagnosisName, setLookedUpDiagnosisName] = useState('');\n    const [activeDetailTab, setActiveDetailTab] = useState('übersicht');\n    const [activeDiagnostikSubTab, setActiveDiagnostikSubTab] = useState('overview');\n    const [diagnosisInfo, setDiagnosisInfo] = useState({ code: '', name: '', beschreibung: '', inkl: [], exkl: [], hinweise: [], zusatz_info_code: '', sicherheit: '', isLoading: false, error: null, isOpen: false, source: '' });\n    const [localIcd10Data, setLocalIcd10Data] = useState({});\n    const [editableKrankheitsanamnese, setEditableKrankheitsanamnese] = useState(\"\");\n    const [editableLebensgeschichte, setEditableLebensgeschichte] = useState(\"\");\n    const [editableProblemanalyseMakro, setEditableProblemanalyseMakro] = useState(\"\");\n    const [editableTherapieplan, setEditableTherapieplan] = useState(\"\");\n    const [therapeutischeAssistenzOutput, setTherapeutischeAssistenzOutput] = useState(\"\");\n    const [isLoadingTherapeutischeAssistenz, setIsLoadingTherapeutischeAssistenz] = useState(false);\n    const [assistenzError, setAssistenzError] = useState(null);\n    const detailViewRef = useRef(null);\n    const [improvementState, setImprovementState] = useState({ isOpen: false, isLoading: false, originalText: '', improvedText: '', sessionIndex: null, error: null });\n    const [sortConfig] = useState({ key: 'name', direction: 'ascending' });\n    const [nextAppointment, setNextAppointment] = useState({ isLoading: false, text: null, error: null });\n    const [unbilledAppointments, setUnbilledAppointments] = useState([]);\n    const [isLoadingAppointments, setIsLoadingAppointments] = useState(false);\n    const [billingModalState, setBillingModalState] = useState({ isOpen: false, event: null, isEditing: false });\n    const [ebmData, setEbmData] = useState([]);\n    const [isManualBillingSetupOpen, setIsManualBillingSetupOpen] = useState(false);\n    const [confirmDeleteState, setConfirmDeleteState] = useState({ isOpen: false, onConfirm: null, message: '', title: '' });\n    const [profile, setProfile] = useState({});\n    const [isUploading, setIsUploading] = useState(false);\n    const [selectedId, setSelectedId] = useState(null);\n    const [isCalendarLoading, setIsCalendarLoading] = useState(false);\n    const [viewMode, setViewMode] = useState('stack');\n    const [isAddBillingPeriodModalOpen, setIsAddBillingPeriodModalOpen] = useState(false);\n    const [ebmTemplates, setEbmTemplates] = useState([]);\n    const [isZentraleTestModalOpen, setIsZentraleTestModalOpen] = useState(false);\n    const [currentTestToErfassen, setCurrentTestToErfassen] = useState(null);\n    const [testToUpdate, setTestToUpdate] = useState(null);\n\n    const [diagnostikTemplates, setDiagnostikTemplates] = useState([]);\n    const [isAddTemplateModalOpen, setIsAddTemplateModalOpen] = useState(false);\n    const [currentTemplate, setCurrentTemplate] = useState(null);\n    const [editingTemplate, setEditingTemplate] = useState(null);\n    const [isTemplateEditModalOpen, setTemplateEditModalOpen] = useState(false);\n\n\n    const quarterlyDiagnostikAnalysis = useQuarterlyDiagnostikAnalysis(selectedPatient, availableTests);\n    const sortedPatients = useMemo(() => { let sortablePatients = [...patients]; if (sortConfig !== null) { sortablePatients.sort((a, b) => { const valA = a[sortConfig.key] || ''; const valB = b[sortConfig.key] || ''; if (valA < valB) { return sortConfig.direction === 'ascending' ? -1 : 1; } if (valA > valB) { return sortConfig.direction === 'ascending' ? 1 : -1; } return 0; }); } return sortablePatients; }, [patients, sortConfig]);\n\n    const handlePatientSelectPreview = (patient) => {\n        if (selectedId === patient.id) {\n            setSelectedId(null);\n            setSelectedPatient(null);\n        } else {\n            setSelectedPatient(patient);\n            setSelectedId(patient.id);\n        }\n    };\n\n    const getHighestSessionNumber = (sessions) => { if (!sessions) return 0; const sessionNumbers = sessions.map(s => s.structuredNotes?.sitzungsnummer).filter(n => typeof n === 'number' && !isNaN(n)); return sessionNumbers.length > 0 ? Math.max(...sessionNumbers) : 0; };\n\n    const handleStartManualBilling = (patientId, date, sessionNumber) => {\n        const patient = patients.find(p => p.id === patientId); if (!patient) { setAppError(\"Patient für manuelle Abrechnung nicht gefunden.\"); return; }\n        let finalSessionNumber; const manualNumber = Number(sessionNumber);\n        if (sessionNumber && !isNaN(manualNumber) && manualNumber > 0) { finalSessionNumber = manualNumber; } else { finalSessionNumber = getHighestSessionNumber(patient.sessions) + 1; }\n        const syntheticEvent = { id: `manual_${Date.now()}`, summary: `Manuelle Sitzung (${patient.chiffre})`, start: { dateTime: new Date(date).toISOString() }, sitzungsnummer: finalSessionNumber, isManual: true };\n        handleStartBilling(syntheticEvent);\n    };\n    const fetchNextAppointment = useCallback(async (chiffre) => {\n        if (!chiffre) return;\n        setNextAppointment({ isLoading: true, text: null, error: null });\n        try {\n            const response = await fetch(`http://localhost:3001/api/calendar/nextevent?chiffre=${chiffre}`);\n            if (response.status === 404) { setNextAppointment({ isLoading: false, text: 'Kein zukünftiger Termin gefunden.', error: null }); return; }\n            if (!response.ok) { throw new Error('Kalender-API-Anfrage fehlgeschlagen.'); }\n            const event = await response.json();\n            const startDate = new Date(event.start); const endDate = new Date(event.end); const dateOptions = { day: '2-digit', month: '2-digit', year: 'numeric' }; const timeOptions = { hour: '2-digit', minute: '2-digit' };\n            const formattedDate = startDate.toLocaleDateString('de-DE', dateOptions); const formattedStartTime = startDate.toLocaleTimeString('de-DE', timeOptions); const formattedEndTime = endDate.toLocaleTimeString('de-DE', timeOptions);\n            setNextAppointment({ isLoading: false, text: `Nächster Termin: ${formattedDate} um ${formattedStartTime} bis ${formattedEndTime} Uhr`, error: null });\n        } catch (error) { console.error('Fehler beim Abrufen des Termins:', error); setNextAppointment({ isLoading: false, text: null, error: 'Termin konnte nicht geladen werden.' }); }\n    }, []);\n    const getPatientsCollectionPath = useCallback(() => { if (!userId) return null; return `/artifacts/${firestoreAppId}/users/${userId}/patients`; }, [userId]);\n    const getProfileDocPath = useCallback(() => { if (!userId) return null; return `/artifacts/${firestoreAppId}/users/${userId}/profile/main`; }, [userId]);\n    const getEbmTemplatesCollectionPath = useCallback(() => { if (!userId) return null; return `/artifacts/${firestoreAppId}/users/${userId}/ebm_templates`; }, [userId]);\n    const getDiagnostikTemplatesCollectionPath = useCallback(() => { if (!userId) return null; return `/artifacts/${firestoreAppId}/users/${userId}/diagnostik_templates`; }, [userId]);\n\n    const findIcd10CodeLocal = useCallback((codeToFind) => { const upperCodeToFind = codeToFind.toUpperCase(); let found = localIcd10Data[upperCodeToFind]; if (found) return found; const baseCode = upperCodeToFind.replace(/(\\.-[*]|\\.\\*|[*]|-)$/, ''); found = localIcd10Data[`${baseCode}.-*`] || localIcd10Data[`${baseCode}.*`] || localIcd10Data[baseCode]; if (found) return found; const possibleCategoryCode = Object.keys(localIcd10Data).find(key => key.startsWith(upperCodeToFind) && (localIcd10Data[key].code_kategorie || localIcd10Data[key].code)); if (possibleCategoryCode) return localIcd10Data[possibleCategoryCode]; return null; }, [localIcd10Data]);\n    const handleStartBilling = (event) => {\n        const chiffreMatch = event.summary?.match(/[A-Z][0-9]{6}/); const chiffre = chiffreMatch ? chiffreMatch[0] : null; const targetPatient = patients.find(p => p.chiffre === chiffre);\n        let nextSessionNumber;\n        if (event.sitzungsnummer) { nextSessionNumber = event.sitzungsnummer; } else { nextSessionNumber = 1; if (targetPatient) { const highestSession = getHighestSessionNumber(targetPatient.sessions); nextSessionNumber = highestSession + 1; } }\n        const eventWithSessionNumber = { ...event, sitzungsnummer: nextSessionNumber };\n        setBillingModalState({ isOpen: true, event: eventWithSessionNumber, isEditing: false });\n    };\n    const handleEditSession = (session) => { const event = { id: session.id, summary: `${session.structuredNotes?.thema || 'Sitzung'} (${selectedPatient.chiffre})`, start: { dateTime: session.date }, sitzungsnummer: session.structuredNotes?.sitzungsnummer, initialNotes: session.structuredNotes, initialEbm: session.ebmEntries, }; setBillingModalState({ isOpen: true, event, isEditing: true }); };\n    const handleDeleteSession = async (sessionId) => {\n        if (!selectedPatient) return;\n        const performDelete = async () => {\n            const updatedSessions = selectedPatient.sessions.filter(s => s.id !== sessionId);\n            const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n            try { await setDoc(patientRef, { sessions: updatedSessions }, { merge: true }); setConfirmDeleteState({ isOpen: false }); } catch (error) { console.error(\"Error deleting session: \", error); setAppError(\"Fehler beim Löschen der Sitzung.\"); }\n        };\n        setConfirmDeleteState({ isOpen: true, title: \"Sitzung löschen?\", message: \"Möchten Sie diese Sitzung und alle zugehörigen Abrechnungsdaten wirklich löschen?\", onConfirm: performDelete, });\n    };\n    const handleSaveBilling = async (billingData, isEditing) => {\n        const { chiffre, eventId, eventStart, notes, ebmEntries, sessionId } = billingData;\n        const targetPatient = patients.find(p => p.chiffre === chiffre); if (!targetPatient) { setAppError(`Patient mit Chiffre ${chiffre} nicht gefunden.`); return; }\n        const patientRef = doc(db, getPatientsCollectionPath(), targetPatient.id);\n        let updatedSessions;\n        if (isEditing) {\n            updatedSessions = targetPatient.sessions.map(session => { if (session.id === sessionId) { return { ...session, structuredNotes: notes, ebmEntries: ebmEntries }; } return session; });\n        } else { const newSession = { id: `sess_${Date.now()}`, date: new Date(eventStart).toISOString(), structuredNotes: notes, ebmEntries: ebmEntries, eventId: eventId, homeworkStatus: (notes.hausaufgaben || []).filter(task => task.trim() !== '').map(taskText => ({ text: taskText, done: false, reason: '' })) }; updatedSessions = [...(targetPatient.sessions || []), newSession]; }\n        updatedSessions.sort((a, b) => new Date(b.date) - new Date(a.date));\n        try {\n            await setDoc(patientRef, { sessions: updatedSessions }, { merge: true }); setBillingModalState({ isOpen: false, event: null, isEditing: false }); if (!isEditing) { setActiveDetailTab('abrechnung'); }\n        } catch (err) { setAppError(\"Fehler beim Speichern der Abrechnung.\"); console.error(\"Error saving billing:\", err); }\n    };\n\n    const handleSaveBillingPeriod = async (periodData) => {\n        if (!selectedPatient) return;\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n\n        const newPeriod = {\n            id: `bp_${Date.now()}`,\n            ...periodData\n        };\n\n        const updatedPatientData = {\n            billingPeriods: [...(selectedPatient.billingPeriods || []), newPeriod]\n        };\n\n        const newPeriodDateStr = new Date(newPeriod.date).toISOString().split('T')[0];\n\n        availableTests.forEach(testDef => {\n            const resultKey = `${testDef.id}Results`;\n            const testResults = selectedPatient[resultKey] || [];\n\n            if (testResults.length > 0) {\n                const updatedResults = testResults.map(res => {\n                    const testDateStr = new Date(res.date).toISOString().split('T')[0];\n                    if (testDateStr === newPeriodDateStr && !res.billingPeriodId) {\n                        return { ...res, billingPeriodId: newPeriod.id };\n                    }\n                    return res;\n                });\n                updatedPatientData[resultKey] = updatedResults;\n            }\n        });\n\n        try {\n            await setDoc(patientRef, updatedPatientData, { merge: true });\n            setIsAddBillingPeriodModalOpen(false);\n        } catch (err) {\n            setAppError(`Fehler beim Speichern des Abrechnungszeitraums: ${err.message}`);\n        }\n    };\n\n    const handleDeleteBillingPeriod = async (periodId) => {\n        if (!selectedPatient || !periodId) return;\n        if (!window.confirm(`Möchten Sie diesen Abrechnungszeitraum wirklich löschen? Alle zugeordneten Tests werden wieder als \"nicht zugeordnet\" markiert.`)) { return; }\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        const updatedTestResults = {};\n        availableTests.forEach(testDef => {\n            const resultKey = `${testDef.id}Results`;\n            if (selectedPatient[resultKey]) {\n                updatedTestResults[resultKey] = selectedPatient[resultKey].map(res => {\n                    if (res.billingPeriodId === periodId) {\n                        return { ...res, billingPeriodId: null };\n                    }\n                    return res;\n                });\n            }\n        });\n        const updatedPeriods = selectedPatient.billingPeriods.filter(p => p.id !== periodId);\n        const updatedPatient = { ...selectedPatient, billingPeriods: updatedPeriods, ...updatedTestResults };\n        setSelectedPatient(updatedPatient);\n        try { await setDoc(patientRef, { billingPeriods: updatedPeriods, ...updatedTestResults }, { merge: true });\n        } catch (err) { setAppError(\"Fehler beim Löschen des Abrechnungszeitraums.\"); console.error(err); }\n    };\n    \n    const handleAddPendingTest = async (test) => {\n        if (!selectedPatient || !test) return;\n\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        const resultKey = `${test.id}Results`;\n        \n        const newTestResult = {\n            date: new Date().toISOString(),\n            status: 'pending',\n            results: {},\n            testInstanceId: `test_${test.id}_${Date.now()}`,\n            testGrund: 'Einzeltestung',\n            billingPeriodId: null\n        };\n        \n        const updatedTestList = [...(selectedPatient[resultKey] || []), newTestResult];\n        \n        try {\n            await updateDoc(patientRef, { [resultKey]: updatedTestList });\n            alert(`Test \"${test.name}\" wurde zur Liste der ausstehenden Tests hinzugefügt.`);\n        } catch (err) {\n            setAppError(`Fehler beim Hinzufügen des Tests: ${err.message}`);\n        }\n    };\n\n    const handleSaveCompletedTest = async (patientId, testData) => {\n        const { testId, results, date } = testData;\n        if (!patientId || !testId) return;\n    \n        const patientRef = doc(db, getPatientsCollectionPath(), patientId);\n        const targetPatient = patients.find(p => p.id === patientId);\n        if (!targetPatient) return;\n\n        const resultKey = `${testId}Results`;\n        const newTestResult = {\n            date: date,\n            results: results,\n            status: 'completed',\n            testGrund: 'Einzeltestung (Global)',\n            testInstanceId: `test_${testId}_${Date.now()}`,\n            billingPeriodId: null,\n        };\n\n        const updatedTestResultsList = [...(targetPatient[resultKey] || []), newTestResult];\n        try {\n            await updateDoc(patientRef, { [resultKey]: updatedTestResultsList });\n            setIsZentraleTestModalOpen(false);\n        } catch (err) {\n            setAppError(`Fehler beim Speichern des Tests: ${err.message}`);\n        }\n    };\n\n\n    const handleCompletePendingTest = (testToComplete) => {\n        if (!testToComplete) return;\n        setTestToUpdate(testToComplete);\n        const testInfo = availableTests.find(t => t.id === testToComplete.testType);\n        setCurrentTestToErfassen(testInfo);\n        setIsZentraleTestModalOpen(true);\n    };\n\n    const handleUpdateTest = async (testInstanceId, testType, newResults, newDate) => {\n        if (!selectedPatient) return;\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        const resultKey = `${testType}Results`;\n        const updatedTestList = selectedPatient[resultKey].map(test => {\n            if (test.testInstanceId === testInstanceId) {\n                return { ...test, results: newResults, date: newDate, status: 'completed' };\n            }\n            return test;\n        });\n        try {\n            await updateDoc(patientRef, { [resultKey]: updatedTestList });\n            setIsZentraleTestModalOpen(false);\n            setTestToUpdate(null);\n        } catch (err) {\n            setAppError(`Fehler beim Aktualisieren des Tests: ${err.message}`);\n        }\n    };\n    \n    const handleSaveTestTemplate = async (patientId, template) => {\n        const { name, tests: testIds } = template;\n        if (!patientId || !testIds || testIds.length === 0) return;\n        const patientRef = doc(db, getPatientsCollectionPath(), patientId);\n        const targetPatient = patients.find(p => p.id === patientId);\n        if (!targetPatient) return;\n\n        const updates = {};\n        const timestamp = Date.now();\n        const dateISO = new Date().toISOString();\n\n        testIds.forEach((testId, index) => {\n            const resultKey = `${testId}Results`;\n            const testInstanceId = `test_${testId}_${timestamp + index}`;\n            const newTestResult = {\n                date: dateISO,\n                status: 'pending',\n                results: {},\n                testInstanceId,\n                testGrund: name,\n                billingPeriodId: null\n            };\n            if (!updates[resultKey]) updates[resultKey] = [...(targetPatient[resultKey] || [])];\n            updates[resultKey].push(newTestResult);\n        });\n\n        try {\n            await updateDoc(patientRef, updates);\n            alert(`Testvorlage \"${name}\" für Patient*in ${targetPatient.chiffre} hinzugefügt.`);\n        } catch (err) {\n            setAppError(`Fehler beim Speichern der Testvorlage: ${err.message}`);\n        }\n    };\n\n    const handleUpdateTestGrund = async (testInstanceId, testType, newGrund) => {\n        if (!selectedPatient) return;\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        const resultKey = `${testType}Results`;\n        const updatedTestList = selectedPatient[resultKey].map(test => {\n            if (test.testInstanceId === testInstanceId) {\n                return { ...test, testGrund: newGrund };\n            }\n            return test;\n        });\n        try {\n            await updateDoc(patientRef, { [resultKey]: updatedTestList });\n        } catch (err) {\n            setAppError(`Fehler beim Aktualisieren des Testgrunds: ${err.message}`);\n        }\n    };\n\n    const handleDeleteTest = async (testInstanceId, testType) => {\n        if (!selectedPatient || !testInstanceId || !testType) { return; }\n        if (!window.confirm(\"Möchten Sie diesen Testeintrag wirklich endgültig löschen?\")) return;\n        \n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        const resultKey = `${testType}Results`;\n        \n        const updatedTestResultsList = (selectedPatient[resultKey] || []).filter(r => r.testInstanceId !== testInstanceId);\n        \n        const updatedPatient = {\n            ...selectedPatient,\n            [resultKey]: updatedTestResultsList,\n        };\n        setSelectedPatient(updatedPatient);\n        \n        try { \n            await updateDoc(patientRef, { [resultKey]: updatedTestResultsList });\n        } catch (err) { \n            setAppError(\"Fehler beim Löschen des Testergebnisses.\");\n            const originalPatient = patients.find(p => p.id === selectedPatient.id);\n            if(originalPatient) setSelectedPatient(originalPatient);\n        }\n    };\n\n    const handleSaveDiagnostikTemplate = async (templateData) => {\n        const collectionPath = getDiagnostikTemplatesCollectionPath();\n        if (!collectionPath) return;\n\n        try {\n             const dataToSave = {\n                name: templateData.name,\n                tests: templateData.tests,\n            };\n            if (templateData.id) {\n                await setDoc(doc(db, collectionPath, templateData.id), dataToSave);\n            } else {\n                await addDoc(collection(db, collectionPath), dataToSave);\n            }\n        } catch (err) {\n            console.error(\"Error saving diagnostik template:\", err);\n            setAppError(`Fehler beim Speichern der Diagnostik-Vorlage: ${err.message}`);\n        }\n    };\n\n    const handleDeleteDiagnostikTemplate = async (templateId) => {\n        const collectionPath = getDiagnostikTemplatesCollectionPath();\n        if (!collectionPath) return;\n        if (window.confirm(\"Möchten Sie diese Diagnostik-Vorlage wirklich löschen?\")) {\n            try {\n                await deleteDoc(doc(db, collectionPath, templateId));\n            } catch (err) {\n                setAppError(`Fehler beim Löschen der Diagnostik-Vorlage: ${err.message}`);\n            }\n        }\n    };\n\n    const handleUpdateHomeworkStatus = async (sessionId, homeworkIndex, newStatus) => {\n        if (!selectedPatient || !userId) return;\n        const collectionPath = getPatientsCollectionPath();\n        const patientRef = doc(db, collectionPath, selectedPatient.id);\n        const updatedSessions = JSON.parse(JSON.stringify(selectedPatient.sessions));\n        const sessionToUpdate = updatedSessions.find(s => s.id === sessionId);\n        if (sessionToUpdate && sessionToUpdate.homeworkStatus && sessionToUpdate.homeworkStatus[homeworkIndex]) { Object.assign(sessionToUpdate.homeworkStatus[homeworkIndex], newStatus); }\n        try { await setDoc(patientRef, { sessions: updatedSessions }, { merge: true }); } catch (err) { console.error(\"Error updating homework status:\", err); setAppError(\"Fehler beim Aktualisieren des Hausaufgabenstatus.\"); }\n    };\n    \n    const handleUpdateQuickNote = async (note) => {\n        if (!selectedPatient || !userId) return;\n        const patientRef = doc(db, getPatientsCollectionPath(), selectedPatient.id);\n        try {\n            await updateDoc(patientRef, { quickNote: note });\n        } catch (err) {\n            console.error(\"Error saving quick note:\", err);\n            setAppError(\"Fehler beim Speichern der Notiz.\");\n        }\n    };\n\n    const handleSaveEbmTemplate = async (templateData) => {\n        if (!userId) { setAppError(\"Benutzer nicht authentifiziert.\"); return; }\n        const collectionPath = getEbmTemplatesCollectionPath();\n        if (!collectionPath) return;\n        try {\n            await addDoc(collection(db, collectionPath), templateData);\n        } catch (err) {\n            console.error(\"Error saving EBM template:\", err);\n            setAppError(\"Fehler beim Speichern der EBM-Vorlage.\");\n        }\n    };\n    const handleDeleteEbmTemplate = async (templateId) => {\n        if (!userId) { setAppError(\"Benutzer nicht authentifiziert.\"); return; }\n        const collectionPath = getEbmTemplatesCollectionPath();\n        if (!collectionPath) return;\n        if (!window.confirm(\"Möchten Sie diese Vorlage wirklich löschen?\")) return;\n        try {\n            await deleteDoc(doc(db, collectionPath, templateId));\n        } catch (err) {\n            console.error(\"Error deleting EBM template:\", err);\n            setAppError(\"Fehler beim Löschen der EBM-Vorlage.\");\n        }\n    };\n    \n    const handleOpenZentraleTestModal = (test) => {\n        setCurrentTestToErfassen(test);\n        setTestToUpdate(null);\n        setIsZentraleTestModalOpen(true);\n    };\n    \n    const handleOpenTemplateModal = (template) => {\n        setCurrentTemplate(template);\n        setIsAddTemplateModalOpen(true);\n    };\n\n    // --- useEffects ---\n    useEffect(() => { const timer = setTimeout(() => { setIsInitialLoading(false); }, 1500); return () => clearTimeout(timer); }, []);\n    useEffect(() => { if (mainView === 'kalender') { setIsCalendarLoading(true); const timer = setTimeout(() => { setIsCalendarLoading(false); }, 1500); return () => clearTimeout(timer); } }, [mainView]);\n    useEffect(() => { if (ebmData.length === 0) { fetch('/ebm_data_full.json').then(res => res.json()).then(setEbmData).catch(err => console.error(\"Failed to load EBM data\", err)); } }, [ebmData.length]);\n    useEffect(() => {\n        if (mainView === 'abrechnung') {\n            setIsLoadingAppointments(true);\n            fetch('http://localhost:3001/api/calendar/past-events')\n                .then(res => { if (!res.ok) { return res.json().then(errorData => { throw new Error(errorData.message || `Serverfehler: ${res.status}`); }); } return res.json(); })\n                .then(calendarEvents => {\n                    if (!Array.isArray(calendarEvents)) { throw new Error(\"Unerwartetes Datenformat vom Server erhalten.\"); };\n                    const billedEventIds = new Set();\n                    patients.forEach(p => { (p.sessions || []).forEach(s => { if (s.eventId) billedEventIds.add(s.eventId); }); });\n                    const unbilled = calendarEvents.filter(event => !billedEventIds.has(event.id) && event.summary?.match(/[A-Z][0-9]{6}/));\n                    setUnbilledAppointments(unbilled);\n                })\n                .catch(err => { if (err.message && err.message.includes('Nicht bei Google authentifiziert')) { setAppError(`Kalender-Fehler: Sie müssen sich erneut bei Google authentifizieren. Rufen Sie dazu im Browser auf: http://localhost:3001/auth/google`); } else { setAppError(`Offene Abrechnungen konnten nicht geladen werden: ${err.message}`); } })\n                .finally(() => setIsLoadingAppointments(false));\n        }\n    }, [mainView, patients]);\n    useEffect(() => { if (selectedPatient) { fetchNextAppointment(selectedPatient.chiffre); } else { setNextAppointment({ isLoading: false, text: null, error: null }); } }, [selectedPatient, fetchNextAppointment]);\n    useEffect(() => { fetch('/icd10f_data.json').then(response => { if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`); return response.json(); }).then(data => { const indexedData = {}; data.forEach(item => { if (item.code) { indexedData[item.code.toUpperCase()] = item; } }); setLocalIcd10Data(indexedData); }).catch(error => { console.error(\"Fehler beim Laden der lokalen ICD-10 Daten:\", error); setAppError(\"Lokale ICD-10 Daten konnten nicht geladen werden. \" + error.message); }); }, []);\n    useEffect(() => { if (selectedPatient && !selectedId) { setEditableKrankheitsanamnese(selectedPatient.krankheitsanamnese || \"\"); setEditableLebensgeschichte(selectedPatient.lebensgeschichte || \"\"); setEditableProblemanalyseMakro(selectedPatient.problemanalyseMakro || \"\"); setEditableTherapieplan(selectedPatient.therapieplan || \"\"); if (detailViewRef.current) { setTimeout(() => { detailViewRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' }); }, 100); } } else { setEditableKrankheitsanamnese(\"\"); setEditableLebensgeschichte(\"\"); setEditableProblemanalyseMakro(\"\"); setEditableTherapieplan(\"\"); } }, [selectedPatient, selectedId]);\n    useEffect(() => { if (newDiagnosisCode.trim() !== '') { const found = findIcd10CodeLocal(newDiagnosisCode.trim().toUpperCase()); if (found && found.name) { setLookedUpDiagnosisName(found.name); } else { setLookedUpDiagnosisName(''); } } else { setLookedUpDiagnosisName(''); } }, [newDiagnosisCode, findIcd10CodeLocal]);\n    useEffect(() => { const unsubscribe = onAuthStateChanged(auth, (user) => { if (user) { setUserId(user.uid); } else { setUserId(null); } setIsAuthReady(true); setIsLoading(false); }); return () => unsubscribe(); }, []);\n    \n    const seedInitialData = useCallback(async (collectionPath) => {\n        if (!userId || !collectionPath) return;\n        try {\n            const patientsCollection = collection(db, collectionPath);\n            const querySnapshot = await getDocs(patientsCollection);\n            if (querySnapshot.empty) { const batch = writeBatch(db); initialPatientsData.forEach(patientData => { const newPatientRef = doc(patientsCollection); batch.set(newPatientRef, { ...patientData, hscl11Results: patientData.hscl11Results || [], bdi2Results: patientData.bdi2Results || [], fep2Results: patientData.fep2Results || [], scl90rResults: patientData.scl90rResults || [], gad7Results: patientData.gad7Results || [], coreOmResults: patientData.coreOmResults || [], iipcResults: patientData.iipcResults || [], diagnoses_icd11: patientData.diagnoses_icd11 || [], billingPeriods: patientData.billingPeriods || [], krankheitsanamnese: patientData.krankheitsanamnese || \"\", lebensgeschichte: patientData.lebensgeschichte || \"\", problemanalyseMakro: patientData.problemanalyseMakro || \"\", therapieplan: patientData.therapieplan || \"\" }); }); await batch.commit(); }\n        } catch (err) { console.error(\"Error seeding initial data:\", err); setAppError(\"Fehler beim Laden der initialen Daten.\"); }\n    }, [userId]);\n\n    useEffect(() => {\n        if (!isAuthReady || !userId) { \n            setPatients([]); \n            setProfile({}); \n            setEbmTemplates([]);\n            setDiagnostikTemplates([]);\n            return; \n        }\n        \n        const unsubscribes = [];\n        setIsLoading(true);\n\n        const paths = [\n            { path: getPatientsCollectionPath(), setter: setPatients, process: (docs) => docs.map(d => ({ id: d.id, ...d.data() })).sort((a,b) => (a.name || \"\").localeCompare(b.name || \"\"))},\n            { path: getProfileDocPath(), setter: setProfile, isDoc: true },\n            { path: getEbmTemplatesCollectionPath(), setter: setEbmTemplates, process: (docs) => docs.map(d => ({id: d.id, ...d.data()})) },\n            { path: getDiagnostikTemplatesCollectionPath(), setter: setDiagnostikTemplates, process: (docs) => docs.map(d => ({id: d.id, ...d.data()})) }\n        ];\n        \n        seedInitialData(getPatientsCollectionPath());\n\n        paths.forEach(({ path, setter, process, isDoc }) => {\n            if (path) {\n                if (isDoc) {\n                    unsubscribes.push(onSnapshot(doc(db, path), (docSnap) => {\n                        setter(docSnap.exists() ? docSnap.data() : {});\n                    }));\n                } else {\n                    unsubscribes.push(onSnapshot(query(collection(db, path)), (snapshot) => {\n                        const data = process ? process(snapshot.docs) : snapshot.docs.map(d => ({ id: d.id, ...d.data() }));\n                        setter(data);\n                    }));\n                }\n            }\n        });\n        \n        setIsLoading(false);\n        return () => unsubscribes.forEach(unsub => unsub());\n    }, [isAuthReady, userId, getDiagnostikTemplatesCollectionPath, getEbmTemplatesCollectionPath, getPatientsCollectionPath, getProfileDocPath, seedInitialData]);\n\n\n    useEffect(() => {\n        if (selectedPatient) {\n            const currentPatientDataFromList = patients.find(p => p.id === selectedPatient.id);\n            if (currentPatientDataFromList) {\n                if (JSON.stringify(currentPatientDataFromList) !== JSON.stringify(selectedPatient)) {\n                    setSelectedPatient(currentPatientDataFromList);\n                }\n            } else {\n                setSelectedPatient(null);\n                setSelectedId(null);\n            }\n        }\n    }, [patients, selectedPatient]);\n\n    useEffect(() => { const loadIcd10Data = async () => { try { const response = await fetch('/icd10f_data.json'); if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); } const data = await response.json(); const indexedData = {}; data.forEach(item => { if (item.code) { indexedData[item.code.toUpperCase()] = item; const baseCode = item.code.replace(/[*†]/, '').toUpperCase(); if (baseCode !== item.code.toUpperCase()) { indexedData[baseCode] = item; } } }); setLocalIcd10Data(indexedData); } catch (error) { console.error(\"Fehler beim Laden der lokalen ICD-10 Daten:\", error); setAppError(\"Lokale ICD-10 Daten konnten nicht geladen werden. \" + error.message); } }; loadIcd10Data(); }, []);\n\n    const bdiCutoffs = [{ y1: 0, y2: 8, label: \"Keine Depression\", color: \"rgba(75, 192, 192, 0.2)\" }, { y1: 9, y2: 13, label: \"Minimale Depression\", color: \"rgba(54, 162, 235, 0.2)\" }, { y1: 14, y2: 19, label: \"Leichte Depression\", color: \"rgba(255, 206, 86, 0.2)\" }, { y1: 20, y2: 28, label: \"Mittelschwere Depression\", color: \"rgba(255, 159, 64, 0.2)\" }, { y1: 29, y2: 63, label: \"Schwere Depression\", color: \"rgba(255, 99, 132, 0.2)\" }];\n    const bdiAxisTicks = [0, 8, 13, 19, 28, 63];\n\n    const handleAuthAction = async (isRegistering) => { setIsAuthLoading(true); setAuthError(null); try { if (isRegistering) { await createUserWithEmailAndPassword(auth, email, password); } else { await signInWithEmailAndPassword(auth, email, password); } setEmail(\"\"); setPassword(\"\"); } catch (error) { console.error(\"Authentication error:\", error); setAuthError(error.message); } finally { setIsAuthLoading(false); } };\n    const handleLogout = async () => { try { await signOut(auth); setSelectedPatient(null); setPatients([]); } catch (error) { console.error(\"Error signing out: \", error); setAppError(\"Fehler beim Abmelden.\"); } };\n    const handleSavePatient = async (patientData) => {\n        if (!userId) { setAppError(\"Benutzer nicht authentifiziert.\"); return; }\n        const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return;\n        const dataToSave = { \n            name: patientData.name || '', \n            vorname: patientData.vorname || '', \n            chiffre: patientData.chiffre || '', \n            geburtsdatum: patientData.geburtsdatum || '', \n            adresse: patientData.adresse || '', \n            email: patientData.email || '', \n            telefon: patientData.telefon || '', \n            krankenkasse: patientData.krankenkasse || '', \n            versichertennummer: patientData.versichertennummer || '', \n            approvedHours: patientData.approvedHours || 0, \n            therapeuticMethods: patientData.therapeuticMethods || [], \n            diagnoses: patientData.diagnoses || [], \n            diagnoses_icd11: patientData.diagnoses_icd11 || [], \n            sessions: patientData.sessions || [], \n            hscl11Results: patientData.hscl11Results || [], \n            bdi2Results: patientData.bdi2Results || [], \n            fep2Results: patientData.fep2Results || [], \n            scl90rResults: patientData.scl90rResults || [], \n            gad7Results: patientData.gad7Results || [],\n            coreOmResults: patientData.coreOmResults || [],\n            iipcResults: patientData.iipcResults || [],\n            billingPeriods: patientData.billingPeriods || [], \n            krankheitsanamnese: patientData.krankheitsanamnese || \"\", \n            lebensgeschichte: patientData.lebensgeschichte || \"\", \n            problemanalyseMakro: patientData.problemanalyseMakro || \"\", \n            therapieplan: patientData.therapieplan || \"\" \n        };\n        try { if (editingPatient && editingPatient.id) { const patientRef = doc(db, collectionPath, editingPatient.id); await setDoc(patientRef, dataToSave, { merge: true }); } else { await addDoc(collection(db, collectionPath), dataToSave); } setIsPatientModalOpen(false); setEditingPatient(null); } catch (err) { console.error(\"Error saving patient:\", err); setAppError(`Fehler beim Speichern des Patienten: ${err.message}`); }\n    };\n    const handleAddDiagnosis = async () => {\n        const codeToAdd = newDiagnosisCode.trim().toUpperCase(); if (!selectedPatient || !codeToAdd || !userId) { setAppError(\"Bitte füllen Sie alle erforderlichen Felder aus.\"); return; }\n        const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return;\n        const sicherheitPrefix = newDiagnosisSicherheit ? `[${newDiagnosisSicherheit}] ` : \"\";\n        const beschreibung = newDiagnosis.trim() ? `: ${newDiagnosis.trim()}` : (lookedUpDiagnosisName ? `: ${lookedUpDiagnosisName}` : \"\");\n        const diagnosisString = `${sicherheitPrefix}${codeToAdd}${beschreibung}`;\n        const updatedDiagnoses = [...(selectedPatient.diagnoses || []), diagnosisString];\n        const patientRef = doc(db, collectionPath, selectedPatient.id);\n        try {\n            await setDoc(patientRef, { diagnoses: updatedDiagnoses }, { merge: true }); setNewDiagnosisCode(''); setNewDiagnosis(''); setLookedUpDiagnosisName(''); setNewDiagnosisSicherheit('G');\n        } catch (err) { console.error(\"Error adding diagnosis:\", err); setAppError(\"Fehler beim Hinzufügen der Diagnose.\"); }\n    };\n    const handleRemoveDiagnosis = async (diagnosisStringToRemove) => { if (!selectedPatient || !userId) return; const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return; const updatedDiagnoses = selectedPatient.diagnoses.filter(d => d !== diagnosisStringToRemove); const patientRef = doc(db, collectionPath, selectedPatient.id); try { await setDoc(patientRef, { diagnoses: updatedDiagnoses }, { merge: true }); } catch (err) { console.error(\"Error removing diagnosis:\", err); setAppError(\"Fehler beim Entfernen der Diagnose.\"); } };\n    const handleKrankheitsmodellChange = async (fieldName, value) => { if (!selectedPatient || !userId) return; const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return; const patientRef = doc(db, collectionPath, selectedPatient.id); try { await setDoc(patientRef, { [fieldName]: value }, { merge: true }); } catch (err) { console.error(`Error updating ${fieldName}:`, err); setAppError(`Fehler beim Speichern von ${fieldName}.`); } };\n    const handleTherapeutischeAssistenzAnfordern = async () => {\n        if (!selectedPatient) { setAssistenzError(\"Bitte wählen Sie zuerst einen Patienten aus.\"); return; }\n        setIsLoadingTherapeutischeAssistenz(true); setTherapeutischeAssistenzOutput(\"\"); setAssistenzError(null);\n        const conductedHours = getHighestSessionNumber(selectedPatient.sessions);\n        const patientenDatenText = `Hier sind die relevanten Patientendaten:\\n**Krankheitsanamnese:**\\n${selectedPatient.krankheitsanamnese || \"Keine Angaben.\"}\\n**Lebensgeschichte/Biografie:**\\n${selectedPatient.lebensgeschichte || \"Keine Angaben.\"}\\n**Problemanalyse auf Makroebene:**\\n${selectedPatient.problemanalyseMakro || \"Keine Angaben.\"}\\n**Therapieplanung (bisherig):**\\n${selectedPatient.therapieplan || \"Keine Angaben.\"}\\n**Verlaufsdokumentation (Sitzungsnotizen):**\\n${(selectedPatient.sessions || []).map((s, i) => `Sitzung ${s.structuredNotes?.sitzungsnummer || i + 1} (${new Date(s.date).toLocaleDateString('de-DE')}): ${s.structuredNotes?.patientenbericht || s.notes}`).join(\"\\n\\n\") || \"Keine Sitzungsnotizen vorhanden.\"}\\n**Diagnosen:**\\n${(selectedPatient.diagnoses || []).join(\", \") || \"Keine Diagnosen erfasst.\"}\\n**Genehmigte Stunden:** ${selectedPatient.approvedHours}\\n**Durchgeführte Stunden:** ${conductedHours}`;\n        const systemPrompt = `Du bist ein interdisziplinäres Expertenteam, bestehend aus erfahrenen Verhaltenstherapeuten wie Jürgen Margraf, Dr. Stavemann, Aaron T. Beck, Judith Beck und Jonathan S. Abramowitz sowie aus leitenden Chefärzten und Psychiatern wie Prof. Dr. Mathias Berger. Das Team verfügt über exzellente Fachkompetenz in der evidenzbasierten psychotherapeutischen Praxis und legt besonderen Wert auf präzise medizinische Dokumentation sowie therapeutische Qualität. Darüber hinaus gehören auch international anerkannte Experten wie David H. Barlow, Stefan G. Hofmann und Steven Hayes zum Team. Du verfügst über tiefgehendes Wissen in Ansätzen der sogenannten „dritten Welle“ der Verhaltenstherapie, insbesondere in ACT, Schematherapie und DBT.\\nDeine Aufgabe ist es, auf Grundlage folgender Elemente, welche du aus den bereitgestellten Patientendaten entnimmst:\\n- Krankheitsanamnese, Lebensgeschichte/Biografie, Problemanalyse auf Makroebene, Therapieplanung (bisherig), Verlaufsdokumentation (Sitzungsnotizen)\\neine strukturierte Rückmeldung zu geben mit dem Ziel:\\n1. Wesentliche Schwerpunkte in der weiteren Therapieplanung zu identifizieren.\\n2. Konkrete Interventionsideen zu formulieren, orientiert an den zugelassenen Stunden.\\n3. Hinweise zu geben, worauf in der Strukturierung der Sitzungen geachtet werden sollte (z.B. Themenfokus, Symptomschwere, Therapiezielorientierung).\\nBerücksichtige dabei:\\n• Die begrenzte Anzahl genehmigter Stunden. • Dass Themen nicht zu häufig gewechselt werden sollen. • Die Konsistenz und Nachvollziehbarkeit im Verlauf.\\nBitte plane deine Analyse gründlich und reflektiert. Handle in Etappen:\\n1. Diagnostische Schwerpunkte benennen, 2. Therapieziele definieren, 3. Interventionsvorschläge machen, 4. Hinweise zur Dokumentation geben\\nAtme einmal tief ein und aus und nehme dir Zeit für die Aufgabe. Mache bitte weiter, bis das Problem vollständig gelöst ist. Planen bitte ausführlich vor jeder Aktion.\\nHier sind die Daten des aktuellen Falls:\\n${patientenDatenText}\\nBitte gib deine strukturierte Rückmeldung.`;\n        try { const assistenz = await generateGeminiText(systemPrompt); setTherapeutischeAssistenzOutput(assistenz); } catch (e) { setAssistenzError(`Fehler bei der Anforderung der therapeutischen Assistenz: ${e.message}`); } finally { setIsLoadingTherapeutischeAssistenz(false); }\n    };\n    const showDiagnosisInfo = (diagnosisString) => { const sicherheitMatch = diagnosisString.match(/^\\[([AVGZN]+)\\]\\s*/i); const sicherheit = sicherheitMatch ? sicherheitMatch[1].toUpperCase() : ''; const codeAndName = sicherheitMatch ? diagnosisString.substring(sicherheitMatch[0].length) : diagnosisString; const codeMatch = codeAndName.match(/^([A-Z][0-9]{1,2}(\\.[0-9A-Z]{1,2})?[*†]?)/i); const code = codeMatch ? codeMatch[0].toUpperCase() : codeAndName.split(':')[0].trim().toUpperCase(); const localData = findIcd10CodeLocal(code); if (localData) { setDiagnosisInfo({ code: localData.code || code, name: localData.name || '', beschreibung: localData.beschreibung || localData.beschreibung_kategorie || '', inkl: localData.inkl || [], exkl: localData.exkl || [], hinweise: localData.hinweise || [], zusatz_info_code: localData.zusatz_info_code || '', sicherheit: sicherheit, isLoading: false, error: null, isOpen: true, source: 'local' }); } else { setDiagnosisInfo({ code: code, name: \"Unbekannter ICD-10 Code\", isLoading: false, error: `Für den ICD-10 Code \"${code}\" wurden keine Informationen in der lokalen Datenbank gefunden.`, isOpen: true, source: 'error' }); } };\n    const fetchIcd11Details = async (diagnosis) => { if (!diagnosis || !diagnosis.uri) { setAppError(\"Keine gültige URI für die ICD-11 Diagnose vorhanden.\"); return; } const { code, title, uri } = diagnosis; setDiagnosisInfo({ code: code, name: title, isLoading: true, error: null, isOpen: true, source: 'api' }); try { const response = await fetch(`http://localhost:3001/api/icd11-info?uri=${encodeURIComponent(uri)}`); if (!response.ok) { const errorData = await response.json(); throw new Error(errorData.message || 'API-Anfrage fehlgeschlagen'); } const fullData = await response.json(); setDiagnosisInfo({ code: fullData.code || code, name: fullData.title?.['@value'] || title, beschreibung: fullData.definition?.['@value'] || '', diagnosticCriteria: fullData.diagnosticCriteria, inclusions: fullData.inclusion, exclusions: fullData.exclusion, isLoading: false, error: null, isOpen: true, source: 'api_detail' }); } catch (error) { console.error('Fehler beim Abrufen der ICD-11 Details:', error); setDiagnosisInfo({ code: code, isLoading: false, error: `Konnte Informationen für ${code} nicht laden: ${error.message}`, isOpen: true, source: 'api' }); } };\n    const handleAssignIcd11Diagnosis = async (patientId, icd11Entity) => { if (!patientId || !icd11Entity || !userId) return; const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return; const patientRef = doc(db, collectionPath, patientId); const targetPatient = patients.find(p => p.id === patientId); if (!targetPatient) { setAppError(\"Ziel-Patient konnte nicht gefunden werden.\"); return; } const newDiagnosis = { code: icd11Entity.code, title: icd11Entity.selectedText, uri: icd11Entity.linearizationUri || icd11Entity.foundationUri, date: new Date().toISOString() }; const updatedDiagnoses = [...(targetPatient.diagnoses_icd11 || []), newDiagnosis]; try { await setDoc(patientRef, { diagnoses_icd11: updatedDiagnoses }, { merge: true }); } catch (err) { console.error(\"Error assigning ICD-11 diagnosis:\", err); setAppError(\"Fehler beim Zuweisen der ICD-11 Diagnose.\"); } };\n    const handleRemoveIcd11Diagnosis = async (diagnosisToRemove) => { if (!selectedPatient || !userId) return; const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return; const updatedDiagnoses = selectedPatient.diagnoses_icd11.filter(d => d.date !== diagnosisToRemove.date); const patientRef = doc(db, collectionPath, selectedPatient.id); try { await setDoc(patientRef, { diagnoses_icd11: updatedDiagnoses }, { merge: true }); } catch (err) { console.error(\"Error removing ICD-11 diagnosis:\", err); setAppError(\"Fehler beim Entfernen der ICD-11 Diagnose.\"); } };\n    const handleAcceptImprovement = async () => { if (improvementState.sessionIndex === null || !selectedPatient || !userId) return; const collectionPath = getPatientsCollectionPath(); if (!collectionPath) return; const updatedSessions = JSON.parse(JSON.stringify(selectedPatient.sessions)); updatedSessions[improvementState.sessionIndex].notes = improvementState.improvedText; const patientRef = doc(db, collectionPath, selectedPatient.id); try { await setDoc(patientRef, { sessions: updatedSessions }, { merge: true }); setImprovementState({ isOpen: false, isLoading: false, originalText: '', improvedText: '', sessionIndex: null, error: null }); } catch (err) { console.error(\"Error updating session note:\", err); setAppError(\"Fehler beim Aktualisieren der Sitzungsnotiz.\"); } };\n    const handleSaveProfile = async (profileData) => { if (!userId) { setAppError(\"Benutzer nicht authentifiziert.\"); return; } const profileDocRef = doc(db, getProfileDocPath()); try { await setDoc(profileDocRef, profileData, { merge: true }); alert(\"Profil erfolgreich gespeichert!\"); } catch (err) { console.error(\"Error saving profile:\", err); setAppError(`Fehler beim Speichern des Profils: ${err.message}`); } };\n    const handleUploadFile = async (file, path) => { if (!userId) throw new Error(\"Benutzer nicht authentifiziert.\"); setIsUploading(true); const storageRef = ref(storage, `users/${userId}/${path}/${file.name}`); try { const snapshot = await uploadBytes(storageRef, file); const downloadURL = await getDownloadURL(snapshot.ref); return downloadURL; } catch (error) { console.error(\"Upload failed\", error); throw error; } finally { setIsUploading(false); } };\n\n    const inputStd = \"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500 sm:text-sm\";\n    const btnPrimary = \"bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-md shadow-sm flex items-center justify-center transition-colors\";\n    const btnDanger = \"bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-3 rounded-md flex items-center transition-colors\";\n    const btnInfo = \"bg-sky-500 hover:bg-sky-600 text-white font-semibold py-1 px-2 text-xs rounded-md flex items-center transition-colors\";\n    const textareaStd = \"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-teal-500 focus:border-teal-500 sm:text-sm min-h-[150px]\";\n\n    const selectedIndex = useMemo(() => selectedId ? sortedPatients.findIndex(p => p.id === selectedId) : -1, [selectedId, sortedPatients]);\n    const compactHeight = 160;\n    const expandedHeight = 620;\n    const overlap = 120;\n    const visibleHeight = compactHeight - overlap;\n    const totalHeight = (sortedPatients.length * visibleHeight) + overlap + (selectedIndex !== -1 ? (expandedHeight - compactHeight) : 0);\n\n    const Sidebar = ({ currentView, setView }) => {\n        const navItems = [\n            { id: 'profile', label: 'Profil', icon: <SettingsIcon />, type: 'item' },\n            { id: 'kalender', label: 'Kalender', icon: <CalendarIcon />, type: 'item' },\n            { type: 'heading', label: 'Patienten' },\n            { id: 'patients', label: 'Patientenübersicht', icon: <Users />, type: 'item' },\n            { id: 'patientenakte', label: 'Patientenakte', icon: <FileText />, type: 'item' },\n            { type: 'heading', label: 'Verwaltung' },\n            { id: 'abrechnung', label: 'Abrechnung', icon: <DollarSignIcon />, type: 'item' },\n            { id: 'diagnostik', label: 'Diagnostik', icon: <BeakerIcon />, type: 'item' },\n            { id: 'formulare', label: 'Formulare', icon: <PaperclipIcon />, type: 'item' },\n            { type: 'heading', label: 'Nachschlagewerke' },\n            { id: 'ebm', label: 'EBM', icon: <List />, type: 'item' },\n            { id: 'ebm_templates', label: 'EBM Vorlagen', icon: <ClipboardListIcon />, type: 'item' },\n            { id: 'icd11', label: 'ICD-11', icon: <BookOpen />, type: 'item' },\n            { id: 'methoden', label: 'Behandlungsmethoden', icon: <LayersIcon />, type: 'item' },\n        ];\n\n        return (\n            <aside className=\"w-64 bg-slate-100 border-r border-slate-200 flex flex-col\">\n                <div className=\"p-4 border-b border-slate-200\"><h1 className=\"text-xl font-bold text-teal-700 tracking-tight\">Therapie-Dashboard</h1></div>\n                <nav className=\"flex-1 p-4 space-y-1\">\n                    {navItems.map((item, index) =>\n                        item.type === 'heading' ? (\n                            <h3 key={`heading-${index}`} className=\"px-3 pt-4 pb-1 text-xs font-semibold text-gray-500 uppercase tracking-wider\">{item.label}</h3>\n                        ) : (\n                            <button key={item.id} onClick={() => { setView(item.id); setSelectedPatient(null); setSelectedId(null); }} className={`w-full flex items-center space-x-3 px-3 py-2 rounded-md text-sm font-medium transition-colors ${currentView === item.id ? 'bg-teal-100 text-teal-800' : 'text-slate-700 hover:bg-slate-200'}`}>\n                                {item.icon}\n                                <span>{item.label}</span>\n                            </button>\n                        ))}\n                </nav>\n                <div className=\"p-4 border-t border-slate-200\"><p className=\"text-xs text-slate-500\">UserID: {userId}</p></div>\n            </aside>\n        );\n    };\n\n    const PatientDetailHeader = ({ patient, onDeselect, onEdit }) => {\n        const therapyStartDate = useMemo(() => { if (!patient || !patient.sessions) return \"-\"; const firstSession = patient.sessions.filter(s => s.structuredNotes?.sitzungsnummer === 1).sort((a, b) => new Date(a.date) - new Date(b.date))[0]; return firstSession ? new Date(firstSession.date).toLocaleDateString('de-DE') : '-'; }, [patient]);\n        const conductedHours = useMemo(() => getHighestSessionNumber(patient?.sessions), [patient]);\n        return (<>\n            <div className=\"flex justify-between items-center mb-1\">\n                <h3 className=\"text-2xl font-semibold text-gray-800\">{patient.vorname} {patient.name}</h3>\n                <div className=\"flex items-center space-x-2\">\n                    <button onClick={onEdit} className=\"text-gray-500 hover:text-teal-600 p-1 rounded-full hover:bg-gray-100 transition-colors\" title=\"Stammdaten bearbeiten\">\n                        <Edit3 />\n                    </button>\n                    <button onClick={onDeselect} className=\"text-gray-400 hover:text-gray-600\"><XCircle /></button>\n                </div>\n            </div>\n            <div className=\"mb-4 text-sm text-gray-500 grid grid-cols-2 md:grid-cols-4 gap-x-4 gap-y-1\"> <span><strong className=\"font-semibold\">Kasse:</strong> {patient.krankenkasse || '-'}</span> <span><strong className=\"font-semibold\">Vers.-Nr.:</strong> {patient.versichertennummer || '-'}</span> <span><strong className=\"font-semibold\">Therapiebeginn:</strong> {therapyStartDate}</span> <span><strong className=\"font-semibold\">Stunden:</strong> {conductedHours} / {patient.approvedHours}</span> </div>\n        </>);\n    };\n\n    if (isInitialLoading) {\n        return (\n            <div className=\"flex justify-center items-center h-screen bg-slate-100\">\n                <DotLottieReact\n                    src=\"https://lottie.host/db9305b2-bb1c-47b1-9c19-d2d744a378b1/yrWh6LccRW.json\"\n                    loop\n                    autoplay\n                />\n            </div>\n        );\n    }\n\n    if (!isAuthReady) return <div className=\"flex justify-center items-center h-screen text-xl font-semibold text-gray-600 bg-slate-100\">Authentifizierung wird initialisiert...</div>;\n    if (!userId) { return (<div className=\"min-h-screen bg-slate-100 flex flex-col justify-center items-center p-4\"> <div className=\"bg-white p-8 rounded-lg shadow-md w-full max-w-md border border-gray-200\"> <h1 className=\"text-2xl font-bold text-center text-gray-800 mb-8\">{isLoginView ? \"Login Patientenverwaltung\" : \"Registrierung\"}</h1> {authError && <p className=\"bg-red-100 text-red-700 p-3 rounded-md mb-4 text-sm\">{authError}</p>} <form onSubmit={(e) => { e.preventDefault(); handleAuthAction(!isLoginView); }} className=\"space-y-6\"> <div><label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">E-Mail Adresse</label><input type=\"email\" name=\"email\" id=\"email\" required value={email} onChange={(e) => setEmail(e.target.value)} className={inputStd} /></div> <div><label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">Passwort</label><input type=\"password\" name=\"password\" id=\"password\" required value={password} onChange={(e) => setPassword(e.target.value)} className={inputStd} /></div> <button type=\"submit\" disabled={isAuthLoading} className={`${btnPrimary} w-full py-2.5 text-base ${isAuthLoading ? 'opacity-50 cursor-not-allowed' : ''}`}>{isAuthLoading ? (isLoginView ? \"Anmelden...\" : \"Registrieren...\") : (isLoginView ? \"Anmelden\" : \"Registrieren\")}</button> </form> <button onClick={() => { setIsLoginView(!isLoginView); setAuthError(null); }} className=\"mt-6 text-sm text-teal-600 hover:text-teal-500 text-center w-full\">{isLoginView ? \"Noch kein Konto? Jetzt registrieren.\" : \"Bereits registriert? Zum Login.\"}</button> </div> </div>); }\n\n    return (\n        <div className=\"h-screen w-full bg-slate-50 font-sans flex overflow-hidden\">\n            <Sidebar currentView={mainView} setView={setMainView} />\n            <div className=\"flex-1 flex flex-col\">\n                <header className=\"bg-white border-b border-slate-200\"><div className=\"mx-auto px-6 py-3 flex justify-between items-center\"><h2 className=\"text-xl font-semibold text-gray-800 capitalize\">{mainView.replace(/_/g, ' ').replace('patientenakte', 'Patientenakte')}</h2><button onClick={handleLogout} className=\"text-gray-500 hover:text-red-600 hover:bg-red-50 p-2 rounded-md text-sm flex items-center transition-colors\"><LogOut className=\"mr-2 h-4 w-4\" /> Logout</button></div></header>\n                <main className=\"flex-1 overflow-y-auto p-6 relative\">\n                    <ConfirmationModal isOpen={confirmDeleteState.isOpen} onClose={() => setConfirmDeleteState({ isOpen: false })} onConfirm={confirmDeleteState.onConfirm} title={confirmDeleteState.title} message={confirmDeleteState.message} />\n                    <Modal isOpen={isPatientModalOpen} onClose={() => setIsPatientModalOpen(false)} title={editingPatient ? \"Patient bearbeiten\" : \"Neuen Patienten anlegen\"}><PatientForm patient={editingPatient} onSave={handleSavePatient} onCancel={() => setIsPatientModalOpen(false)} /></Modal>\n\n                    {mainView === 'profile' && (<Profile initialProfile={profile} onSave={handleSaveProfile} onUploadFile={handleUploadFile} isUploading={isUploading} />)}\n                    {mainView === 'abrechnung' && (<Billing unbilledAppointments={unbilledAppointments} isLoading={isLoadingAppointments} onStartBilling={handleStartBilling} onStartManualBilling={() => setIsManualBillingSetupOpen(true)} />)}\n\n\n                    {mainView === 'patients' && (\n                        <div>\n                            <div className=\"mb-4 flex justify-between items-center\">\n                                <h3 className=\"text-2xl font-semibold text-gray-800\">Patientenübersicht</h3>\n                                <div className=\"flex items-center gap-4\">\n                                    <div className=\"flex items-center gap-1 bg-gray-200 p-1 rounded-lg\">\n                                        <button onClick={() => setViewMode('grid')} className={`p-1.5 rounded-md ${viewMode === 'grid' ? 'bg-white shadow' : 'text-gray-500 hover:bg-white/50'}`} title=\"Rasteransicht\"><LayoutGridIcon /></button>\n                                        <button onClick={() => setViewMode('stack')} className={`p-1.5 rounded-md ${viewMode === 'stack' ? 'bg-white shadow' : 'text-gray-500 hover:bg-white/50'}`} title=\"Stapelansicht\"><LayersIcon /></button>\n                                    </div>\n                                    <button onClick={() => { setEditingPatient(null); setIsPatientModalOpen(true); }} className={btnPrimary}>\n                                        <UserPlus className=\"w-5 h-5 mr-2\" /> Patient hinzufügen\n                                    </button>\n                                </div>\n                            </div>\n\n                            {viewMode === 'grid' && (\n                                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\n                                    {isLoading && <p className=\"col-span-full text-center py-10 text-gray-500\">Lade Patienten...</p>}\n                                    {!isLoading && sortedPatients.map((patient) => (\n                                        <motion.div\n                                            key={patient.id}\n                                            layoutId={patient.id}\n                                            onClick={() => handlePatientSelectPreview(patient)}\n                                            className=\"bg-white rounded-lg shadow-md cursor-pointer hover:shadow-xl transition-shadow duration-300\"\n                                        >\n                                            <div className=\"p-4 border-b-4 border-teal-500\">\n                                                <h4 className=\"font-bold text-gray-800 truncate\">{patient.name}, {patient.vorname}</h4>\n                                                <p className=\"text-sm text-gray-500 font-mono\">{patient.chiffre}</p>\n                                            </div>\n                                            <div className=\"p-4 text-xs text-gray-600\">\n                                                <p><strong>Diagnose:</strong> {(patient.diagnoses && patient.diagnoses[0]?.split(':')[0]) || 'N/A'}</p>\n                                                <p><strong>Stunden:</strong> {getHighestSessionNumber(patient.sessions)} / {patient.approvedHours || 'N/A'}</p>\n                                            </div>\n                                        </motion.div>\n                                    ))}\n                                </div>\n                            )}\n\n                            {viewMode === 'stack' && (\n                                <div className=\"w-full max-w-5xl mx-auto flex flex-col items-center pt-8 pb-8\">\n                                    {isLoading && <p className=\"text-center py-10 text-gray-500\">Lade Patienten...</p>}\n                                    <div className=\"w-full relative\" style={{ height: `${totalHeight}px`, transition: 'height 0.4s ease-in-out' }}>\n                                        <AnimatePresence>\n                                            {sortedPatients.map((patient, index) => {\n                                                const isSelected = selectedId === patient.id;\n                                                const tabColors = [\"bg-blue-100 text-blue-800 border-blue-200\", \"bg-orange-100 text-orange-800 border-orange-200\", \"bg-teal-100 text-teal-800 border-teal-200\", \"bg-purple-100 text-purple-800 border-purple-200\", \"bg-yellow-100 text-yellow-800 border-yellow-200\"];\n                                                const tabColor = tabColors[index % tabColors.length];\n\n                                                let bottomPos = index * visibleHeight;\n                                                if (selectedIndex !== -1 && index > selectedIndex) {\n                                                    bottomPos += expandedHeight - compactHeight;\n                                                }\n\n                                                return (\n                                                    <motion.div\n                                                        key={patient.id}\n                                                        layoutId={patient.id}\n                                                        className=\"absolute w-full cursor-pointer\"\n                                                        style={{ height: isSelected ? expandedHeight : compactHeight }}\n                                                        animate={{ bottom: bottomPos, zIndex: isSelected ? 20 : sortedPatients.length - index }}\n                                                        transition={{ type: 'spring', stiffness: 400, damping: 35 }}\n                                                        onClick={() => handlePatientSelectPreview(patient)}\n                                                        whileHover={!isSelected ? { y: -10, scale: 1.02 } : {}}\n                                                    >\n                                                        <div className={`relative w-full h-full rounded-lg transition-shadow duration-300 ${isSelected ? 'shadow-2xl' : 'shadow-md hover:shadow-xl'}`}>\n                                                            <div\n                                                                className={`absolute h-10 px-4 flex items-center font-medium rounded-t-lg border-t border-x transition-colors ${isSelected ? 'bg-white' : tabColor}`}\n                                                                style={{ left: `${5 + (index % 6) * 12}%`, top: '-1px' }}>\n                                                                {patient.name}\n                                                            </div>\n\n                                                            <div className=\"bg-white rounded-b-lg rounded-tr-lg border w-full h-full pt-10 overflow-hidden\">\n                                                                {isSelected && selectedPatient ? (\n                                                                    <div className=\"p-6 overflow-y-auto h-full\">\n                                                                        <PatientDetailHeader\n                                                                            patient={selectedPatient}\n                                                                            onDeselect={() => handlePatientSelectPreview(patient)}\n                                                                            onEdit={() => { setEditingPatient(selectedPatient); setIsPatientModalOpen(true); }}\n                                                                        />\n                                                                        <div className=\"border-t pt-4 mt-4\">\n                                                                            <PatientOverviewTab patient={selectedPatient} nextAppointment={nextAppointment} onUpdateHomeworkStatus={handleUpdateHomeworkStatus} onUpdateQuickNote={handleUpdateQuickNote} />\n                                                                        </div>\n                                                                        <div className=\"mt-6 flex justify-end\">\n                                                                            <button\n                                                                                onClick={(e) => {\n                                                                                    e.stopPropagation();\n                                                                                    setMainView('patientenakte');\n                                                                                }}\n                                                                                className=\"bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-lg shadow-sm\"\n                                                                            >\n                                                                                Vollständige Akte bearbeiten\n                                                                            </button>\n                                                                        </div>\n                                                                    </div>\n                                                                ) : (\n                                                                    <div className=\"p-4 h-full\">\n                                                                        <h4 className=\"font-semibold text-lg text-gray-900 pt-2\">{patient.vorname} {patient.name}</h4>\n                                                                        <p className=\"text-gray-500 font-mono\">{patient.chiffre}</p>\n                                                                        <div className=\"mt-2 text-xs text-gray-600\"><p>Sitzungen: {patient.sessions?.length || 0}</p></div>\n                                                                    </div>\n                                                                )}\n                                                            </div>\n                                                        </div>\n                                                    </motion.div>\n                                                );\n                                            })}\n                                        </AnimatePresence>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    )}\n\n                    {mainView === 'patientenakte' && (\n                        <div className=\"w-full h-full\">\n                            {!selectedPatient ? (\n                                <div className=\"text-center py-20\">\n                                    <p className=\"text-gray-500\">Bitte wählen Sie einen Patienten aus der Übersicht aus.</p>\n                                </div>\n                            ) : (\n                                <div ref={detailViewRef} className=\"bg-white border border-gray-200 shadow-sm rounded-lg p-6 h-full flex flex-col\">\n                                    <PatientDetailHeader\n                                        patient={selectedPatient}\n                                        onDeselect={() => { setMainView('patients'); setSelectedPatient(null); }}\n                                        onEdit={() => { setEditingPatient(selectedPatient); setIsPatientModalOpen(true); }}\n                                    />\n                                    <div className=\"border-b border-gray-200 mb-6\"><nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto\" aria-label=\"Tabs\">{['Übersicht', 'Diagnosen', 'Abrechnung', 'Krankheitsmodell', 'Diagnostik', 'Assistenz'].map(tab => (<button key={tab} onClick={() => setActiveDetailTab(tab.toLowerCase())} className={`capitalize whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${activeDetailTab === tab.toLowerCase() ? 'border-teal-500 text-teal-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>{tab}</button>))}</nav></div>\n\n                                    <div className=\"flex-grow overflow-y-auto pr-4 -mr-4\">\n                                        {activeDetailTab === 'übersicht' && ( <PatientOverviewTab patient={selectedPatient} nextAppointment={nextAppointment} onUpdateHomeworkStatus={handleUpdateHomeworkStatus} onUpdateQuickNote={handleUpdateQuickNote} /> )}\n                                        {activeDetailTab === 'diagnosen' && (<div><div className=\"mb-6\"><h4 className=\"text-xl font-semibold text-gray-700 mb-3\">ICD-10 F-Diagnosen</h4><div className=\"mb-3 p-4 bg-gray-50 rounded-md border\"><div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end\"><div><label htmlFor=\"newDiagnosisCode\" className=\"block text-xs font-medium text-gray-700\">Code (z.B. F32.2)</label><input type=\"text\" id=\"newDiagnosisCode\" value={newDiagnosisCode} onChange={(e) => setNewDiagnosisCode(e.target.value.toUpperCase())} placeholder=\"F-Code\" className={`${inputStd} mt-1`} /></div><div><label htmlFor=\"newDiagnosisSicherheit\" className=\"block text-xs font-medium text-gray-700\">Sicherheit</label><select id=\"newDiagnosisSicherheit\" value={newDiagnosisSicherheit} onChange={(e) => setNewDiagnosisSicherheit(e.target.value)} className={`${inputStd} mt-1`}><option value=\"G\">G (Gesichert)</option><option value=\"V\">V (Verdacht auf)</option><option value=\"A\">A (Ausschluss)</option><option value=\"ZN\">ZN (Zustand nach)</option></select></div><div className=\"md:col-span-1\"><label htmlFor=\"newDiagnosisName\" className=\"block text-xs font-medium text-gray-700\">Manuelle Beschreibung (optional)</label><input type=\"text\" id=\"newDiagnosisName\" value={newDiagnosis} onChange={(e) => setNewDiagnosis(e.target.value)} placeholder=\"Eigene Beschreibung\" className={`${inputStd} mt-1`} /></div><button onClick={handleAddDiagnosis} className={`${btnPrimary} bg-green-500 hover:bg-green-600 py-2 px-3 h-10 md:self-end`}><PlusCircleIcon className=\"w-5 h-5 mr-1\" /> Hinzufügen</button></div>{lookedUpDiagnosisName && <p className=\"text-xs text-teal-600 mt-1\">Gefunden: {lookedUpDiagnosisName}</p>}</div><ul className=\"space-y-1 mb-3\">{(selectedPatient.diagnoses || []).map((diagString, index) => (<li key={index} className=\"flex justify-between items-center bg-gray-50 p-2 rounded-md\"><span className=\"text-sm text-gray-700\">{diagString}</span><div className=\"flex items-center space-x-2\"><button onClick={() => showDiagnosisInfo(diagString)} className={`${btnInfo} p-1`} title=\"Info zu dieser Diagnose abrufen\"><FileJson2 className=\"w-4 h-4 mr-1\" /> Info</button><button onClick={() => handleRemoveDiagnosis(diagString)} className={`${btnDanger} p-1 text-xs`}><Trash2 className=\"w-4 h-4\" /></button></div></li>))}{(selectedPatient.diagnoses || []).length === 0 && <p className=\"text-sm text-gray-500\">Keine Diagnosen erfasst.</p>}</ul></div><div className=\"mb-6\"><h4 className=\"text-xl font-semibold text-gray-700 mb-3\">ICD-11 Diagnosen</h4><ul className=\"space-y-1\">{(selectedPatient.diagnoses_icd11 || []).map((diag, index) => (<li key={index} className=\"flex justify-between items-center bg-purple-50 p-2 rounded-md hover:bg-purple-100 cursor-pointer\" onClick={() => fetchIcd11Details(diag)}><span className=\"text-sm text-purple-800\"><strong className=\"font-mono\">{diag.code}</strong> - {diag.title}</span><button onClick={(e) => { e.stopPropagation(); handleRemoveIcd11Diagnosis(diag); }} className=\"text-red-500 hover:text-red-700 p-1 text-xs\" title=\"ICD-11 Diagnose entfernen\"><Trash2 className=\"w-4 h-4\" /></button></li>))}{(selectedPatient.diagnoses_icd11 || []).length === 0 && <p className=\"text-sm text-gray-500\">Keine ICD-11 Diagnosen erfasst.</p>}</ul></div></div>)}\n                                        {activeDetailTab === 'abrechnung' && ( <AbrechnungsUebersicht patient={selectedPatient} availableTests={availableTests} quarterlyAnalysis={quarterlyDiagnostikAnalysis} onEditSession={handleEditSession} onDeleteSession={handleDeleteSession} onAddBillingPeriod={() => setIsAddBillingPeriodModalOpen(true)} onDeleteBillingPeriod={handleDeleteBillingPeriod} /> )}\n                                        {activeDetailTab === 'krankheitsmodell' && (<div className=\"space-y-6\"><div><label htmlFor=\"krankheitsanamnese\" className=\"block text-lg font-semibold text-gray-700 mb-1\">Krankheitsanamnese</label><textarea id=\"krankheitsanamnese\" name=\"krankheitsanamnese\" rows=\"6\" className={textareaStd} value={editableKrankheitsanamnese} onChange={(e) => setEditableKrankheitsanamnese(e.target.value)} onBlur={(e) => handleKrankheitsmodellChange('krankheitsanamnese', e.target.value)} placeholder=\"Hier die Krankheitsanamnese eintragen...\"></textarea></div><div><label htmlFor=\"lebensgeschichte\" className=\"block text-lg font-semibold text-gray-700 mb-1\">Lebensgeschichte / Biographie</label><textarea id=\"lebensgeschichte\" name=\"lebensgeschichte\" rows=\"6\" className={textareaStd} value={editableLebensgeschichte} onChange={(e) => setEditableLebensgeschichte(e.target.value)} onBlur={(e) => handleKrankheitsmodellChange('lebensgeschichte', e.target.value)} placeholder=\"Wichtige Aspekte der Lebensgeschichte...\"></textarea></div><div><label htmlFor=\"problemanalyseMakro\" className=\"block text-lg font-semibold text-gray-700 mb-1\">Problemanalyse auf Makroebene</label><textarea id=\"problemanalyseMakro\" name=\"problemanalyseMakro\" rows=\"6\" className={textareaStd} value={editableProblemanalyseMakro} onChange={(e) => setEditableProblemanalyseMakro(e.target.value)} onBlur={(e) => handleKrankheitsmodellChange('problemanalyseMakro', e.target.value)} placeholder=\"Analyse der übergeordneten Problembereiche...\"></textarea></div><div><label htmlFor=\"therapieplan\" className=\"block text-lg font-semibold text-gray-700 mb-1\">Therapieplan</label><textarea id=\"therapieplan\" name=\"therapieplan\" rows=\"6\" className={textareaStd} value={editableTherapieplan} onChange={(e) => setEditableTherapieplan(e.target.value)} onBlur={(e) => handleKrankheitsmodellChange('therapieplan', e.target.value)} placeholder=\"Therapieziele und -maßnahmen...\"></textarea></div></div>)}\n                                        {activeDetailTab === 'diagnostik' && (\n                                            <div>\n                                                <div className=\"border-b border-gray-200 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-6\" aria-label=\"Diagnostik Sub-Tabs\">\n                                                        <button onClick={() => setActiveDiagnostikSubTab('overview')} className={`whitespace-nowrap pb-2 px-1 border-b-2 font-medium text-sm ${activeDiagnostikSubTab === 'overview' ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>Übersicht</button>\n                                                        {availableTests.map(test => ((selectedPatient[`${test.id}Results`]?.filter(t => t.status !== 'pending').length > 0) &&\n                                                            <button key={test.id} onClick={() => setActiveDiagnostikSubTab(test.id)} className={`whitespace-nowrap pb-2 px-1 border-b-2 font-medium text-sm ${activeDiagnostikSubTab === test.id ? 'border-purple-500 text-purple-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}>{test.id.toUpperCase()}</button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n                                                {activeDiagnostikSubTab === 'overview' && ( <DiagnostikZuordnung patient={selectedPatient} availableTests={availableTests} testCategories={testCategories} diagnostikTemplates={diagnostikTemplates} onCompleteTest={handleCompletePendingTest} onDeleteTest={handleDeleteTest} onUpdateTestGrund={handleUpdateTestGrund} onAddNewTest={handleAddPendingTest}/> )}\n                                                {activeDiagnostikSubTab === 'scl90r' && <SCL90RComponent patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                                {activeDiagnostikSubTab === 'fep2' && <FEP2Component patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                                {activeDiagnostikSubTab === 'bdi2' && <BDI2Component patient={selectedPatient} onDeleteTest={handleDeleteTest} bdiCutoffs={bdiCutoffs} bdiAxisTicks={bdiAxisTicks} />}\n                                                {activeDiagnostikSubTab === 'hscl11' && <HSCL11Component patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                                {activeDiagnostikSubTab === 'gad7' && <GAD7Component patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                                {activeDiagnostikSubTab === 'coreOm' && <CoreOmComponent patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                                {activeDiagnostikSubTab === 'iipc' && <IIPCComponent patient={selectedPatient} onDeleteTest={handleDeleteTest} />}\n                                            </div>\n                                        )}                                        {activeDetailTab === 'assistenz' && (<div><h3 className=\"text-xl font-semibold text-gray-700 mb-4\">Therapeutische Assistenz</h3><button onClick={handleTherapeutischeAssistenzAnfordern} disabled={isLoadingTherapeutischeAssistenz} className={`${btnPrimary} bg-purple-600 hover:bg-purple-700 mb-4 flex items-center`}><WandSparkles className=\"mr-2 h-5 w-5\" />{isLoadingTherapeutischeAssistenz ? \"Analysiere Daten...\" : \"Expertenfeedback anfordern\"}</button>{isLoadingTherapeutischeAssistenz && (<div className=\"text-center py-10\"><div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-700 mx-auto\"></div><p className=\"mt-3 text-gray-600\">Bitte warten, die KI analysiert die Patientendaten...</p></div>)}{assistenzError && (<div className=\"bg-red-100 border-l-4 border-red-500 text-red-700 p-4\" role=\"alert\"><p className=\"font-bold\">Fehler bei der Assistenz</p><p>{assistenzError}</p></div>)}{therapeutischeAssistenzOutput && !isLoadingTherapeutischeAssistenz && (<div className=\"mt-4 p-4 bg-gray-50 rounded-md border\"><h4 className=\"text-lg font-semibold text-gray-800 mb-2\">Vorschläge des Expertenteams:</h4><div className=\"whitespace-pre-wrap text-sm text-gray-700 leading-relaxed\">{therapeutischeAssistenzOutput}</div></div>)}</div>)}\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    )}\n                    {mainView === 'kalender' && ( <div> <h3 className=\"text-2xl font-semibold text-gray-800 mb-4\">Terminkalender</h3> <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 relative min-h-[600px]\"> {isCalendarLoading && ( <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-slate-50 z-10\"> <DotLottieReact src=\"https://lottie.host/5a99e4b7-42e6-47ae-9706-1e931f930492/HSS5faWD7S.lottie\" loop autoplay style={{ width: 300, height: 300 }} /> <p className=\"text-gray-500 -mt-8\">Kalender wird geladen...</p> </div> )} <iframe title=\"Google Calendar\" src=\"https://calendar.google.com/calendar/embed?src=julisycomorepsy%40gmail.com&ctz=Europe%2FBerlin\" style={{ border: 0 }} width=\"100%\" height=\"600\" frameBorder=\"0\" scrolling=\"no\" className={`transition-opacity duration-500 ${isCalendarLoading ? 'opacity-0' : 'opacity-100'}`} ></iframe> </div> </div> )}\n                    {mainView === 'formulare' && ( <PtvFormGenerator patients={sortedPatients} therapistProfile={profile} /> )}\n                    {mainView === 'ebm' && (<EBMBrowser />)}\n                    {mainView === 'ebm_templates' && (<EbmTemplates templates={ebmTemplates} ebmData={ebmData} onSave={handleSaveEbmTemplate} onDelete={handleDeleteEbmTemplate} />)}\n\n                    {mainView === 'diagnostik' && (\n                        <DiagnostikHauptseite\n                            availableTests={availableTests}\n                            testCategories={testCategories}\n                            diagnostikTemplates={diagnostikTemplates}\n                            onAddTest={handleOpenZentraleTestModal}\n                            onAddTemplate={handleOpenTemplateModal}\n                            onAddTemplateDefinition={() => { setEditingTemplate(null); setTemplateEditModalOpen(true); }}\n                            onEditTemplateDefinition={(template) => { setEditingTemplate(template); setTemplateEditModalOpen(true); }}\n                            onDeleteTemplateDefinition={handleDeleteDiagnostikTemplate}\n                        />\n                    )}\n\n                    {mainView === 'icd11' && (<ICD11ECTBrowser patients={patients} selectedPatient={selectedPatient} onAssignDiagnosis={handleAssignIcd11Diagnosis} />)}\n                    {mainView === 'methoden' && (<Behandlungsmethoden />)}\n\n                </main>\n            </div>\n            {/* MODALS AND GLOBAL ELEMENTS */}\n            <Modal isOpen={diagnosisInfo.isOpen} onClose={() => setDiagnosisInfo(prev => ({ ...prev, isOpen: false }))} title={`Diagnose-Info: ${diagnosisInfo.code || ''}`} size=\"3xl\">{diagnosisInfo.isLoading && (<p className=\"text-center py-4\">Informationen werden geladen...</p>)}{diagnosisInfo.error && (<p className=\"text-red-600 bg-red-100 p-3 rounded-md\">Fehler: {diagnosisInfo.error}</p>)}{!diagnosisInfo.isLoading && diagnosisInfo.source === 'local' && (<div className=\"text-sm text-gray-700 leading-relaxed p-2 space-y-3\"><h3 className=\"text-lg font-semibold text-teal-700\">{diagnosisInfo.name}<span className=\"text-gray-500 text-base ml-2\">({diagnosisInfo.code})</span></h3>{diagnosisInfo.beschreibung && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Beschreibung:</strong><p className=\"whitespace-pre-wrap\">{diagnosisInfo.beschreibung}</p></div>)}{diagnosisInfo.inkl?.length > 0 && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Inklusive:</strong><ul className=\"list-disc list-inside\">{diagnosisInfo.inkl.map((item, idx) => (<li key={idx}>{item}</li>))}</ul></div>)}{diagnosisInfo.exkl?.length > 0 && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Exklusive:</strong><ul className=\"list-disc list-inside\">{diagnosisInfo.exkl.map((item, idx) => (<li key={idx}>{item}</li>))}</ul></div>)}</div>)}{!diagnosisInfo.isLoading && diagnosisInfo.source === 'api_detail' && (<div className=\"text-sm text-gray-700 leading-relaxed p-2 space-y-4\"><h3 className=\"text-lg font-semibold text-purple-700\">{diagnosisInfo.name}<span className=\"text-gray-500 text-base ml-2 font-mono\">({diagnosisInfo.code})</span></h3>{diagnosisInfo.beschreibung && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Beschreibung (Definition):</strong><p className=\"whitespace-pre-wrap bg-gray-50 p-2 rounded-md\">{diagnosisInfo.beschreibung}</p></div>)}{diagnosisInfo.inclusions?.length > 0 && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Inklusive:</strong><ul className=\"list-disc list-inside pl-2 space-y-1\">{diagnosisInfo.inclusions.map((item, idx) => (<li key={idx}>{item.label['@value']}</li>))}</ul></div>)}{diagnosisInfo.exclusions?.length > 0 && (<div><strong className=\"font-medium text-gray-800 block mb-1\">Exklusive:</strong><ul className=\"list-disc list-inside pl-2 space-y-1\">{diagnosisInfo.exclusions.map((item, idx) => (<li key={idx}>{item.label['@value']}{item.foundationReference && <span className=\"text-xs text-gray-400 ml-2\">({item.foundationReference.split('/').pop()})</span>}</li>))}</ul></div>)}</div>)}</Modal>\n            <Modal isOpen={improvementState.isOpen} onClose={() => setImprovementState({ ...improvementState, isOpen: false })} title=\"Sitzungsdokumentation verbessern\" size=\"5xl\">{improvementState.error && <p className=\"text-red-500 bg-red-100 p-3 rounded-md mb-4\">{improvementState.error}</p>}<div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\"><div><h4 className=\"font-semibold text-lg text-gray-700 mb-2\">Original</h4><pre className=\"text-sm bg-gray-100 p-3 rounded-md whitespace-pre-wrap font-sans h-96 overflow-y-auto border\">{improvementState.originalText}</pre></div><div><h4 className=\"font-semibold text-lg text-gray-700 mb-2\">Vorschlag</h4><pre className=\"text-sm bg-gray-800 text-green-300 font-mono p-3 rounded-md whitespace-pre-wrap h-96 overflow-y-auto\">{improvementState.improvedText}</pre></div></div><div className=\"flex justify-end space-x-4 mt-6\"><button type=\"button\" onClick={() => setImprovementState({ ...improvementState, isOpen: false })} className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300\">Abbrechen</button><button onClick={handleAcceptImprovement} className={`${btnPrimary} flex items-center`}><Save className=\"w-4 h-4 mr-2\" /> Original ersetzen</button></div></Modal>\n            {appError && (<div className=\"fixed bottom-4 right-4 p-4 max-w-sm text-sm text-red-700 bg-red-100 border border-red-400 rounded-md shadow-lg z-[100]\">{appError}<button onClick={() => setAppError(null)} className=\"ml-4 mt-2 sm:mt-0 sm:ml-2 px-2 py-1 text-red-900 underline rounded-md hover:bg-red-200 text-xs\">Ok</button></div>)}\n            \n            <ManualBillingSetupModal isOpen={isManualBillingSetupOpen} onClose={() => setIsManualBillingSetupOpen(false)} patients={sortedPatients} onStart={handleStartManualBilling} />\n            <AddBillingPeriodModal isOpen={isAddBillingPeriodModalOpen} onClose={() => setIsAddBillingPeriodModalOpen(false)} onSave={handleSaveBillingPeriod} patient={selectedPatient} />\n\n            <AddTestTemplateModal\n                isOpen={isAddTemplateModalOpen}\n                onClose={() => setIsAddTemplateModalOpen(false)}\n                onSave={handleSaveTestTemplate}\n                template={currentTemplate}\n                patients={sortedPatients}\n                availableTests={availableTests}\n            />\n\n            <AddOrEditTemplateModal\n                isOpen={isTemplateEditModalOpen}\n                onClose={() => setTemplateEditModalOpen(false)}\n                onSave={handleSaveDiagnostikTemplate}\n                availableTests={availableTests}\n                editingTemplate={editingTemplate}\n            />\n\n            {billingModalState.isOpen && (\n                <Modal isOpen={billingModalState.isOpen} onClose={() => setBillingModalState({ isOpen: false, event: null, isEditing: false })} title={billingModalState.isEditing ? \"Sitzung bearbeiten\" : `Termin abrechnen: ${billingModalState.event.summary}`} size=\"4xl\" >\n                    <BillingModal\n                        event={billingModalState.event}\n                        ebmData={ebmData}\n                        onSave={(data) => handleSaveBilling(data, billingModalState.isEditing)}\n                        onClose={() => setBillingModalState({ isOpen: false, event: null, isEditing: false })}\n                        generateGeminiText={generateGeminiText}\n                        isEditing={billingModalState.isEditing}\n                        ebmTemplates={ebmTemplates}\n                    />\n                </Modal>\n            )}\n\n            <ZentraleTestErfassungModal\n                isOpen={isZentraleTestModalOpen}\n                onClose={() => { setIsZentraleTestModalOpen(false); setTestToUpdate(null); }}\n                onSave={handleSaveCompletedTest}\n                onUpdate={handleUpdateTest}\n                testInfo={currentTestToErfassen}\n                testToUpdate={testToUpdate}\n                patients={sortedPatients}\n                activePatient={selectedPatient}\n            />\n        </div>\n    );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}